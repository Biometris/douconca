[{"path":"/articles/douconca.html","id":"the-douconca-package","dir":"Articles","previous_headings":"","what":"The douconca package","title":"douconca","text":"aim douconca package help ecologists unravel trait-environment relationships abundance data table associated multi-trait multi-environment data tables. popular method aim RLQ (Dolédec et al. 1996; Dray et al. 2014), also three-tables method. RLQ available R-package ade4 (Dray Dufour 2007; Thioulouse et al. 2018). douconca package provides alternative method, termed double-constrained correspondence analysis (dc-CA), natural extension commonly used method community-weighted means (CWMs) regression (Ter Braak, Šmilauer, Dray 2018; Kleyer et al. 2012). dc-CA based regression analysis ordination (factorial analysis), allows usual forms testing, model building, biplots resulting scores. number recent applications also contain discussion value dc-CA compared RLQ (Peng et al. 2021; Gobbi et al. 2022; Pinho et al. 2021), summarized document ResearchGate. examples comparisons methods can found figshare. douconca package formula-interface specify dc-CA model, scores, anova, plot predict functions, mostly fairly similar vegan package (Oksanen et al. 2024) douconca based.","code":""},{"path":"/articles/douconca.html","id":"double-constained-correspondence-analysis","dir":"Articles","previous_headings":"","what":"Double constained correspondence analysis","title":"douconca","text":"RLQ, dc-CA seeks ordination (.e. low-dimensional representation ) multi-trait, multi-environment relationships, dc-CA differs RLQ dc-CA based regression traits environmental variables predictors, whereas RLQ based co-variance. dc-CA method thus allows variation-partitioning type model-building familiar users regression analysis, whereas RLQ . dc-CA axis consists two regression models (linear combinations), one traits environmental predictors, fitted values can thought composite trait composite environmental gradient. response variables regressions species niche centroids CWMs composites. circularity typical eigenvalue ordination method. linear combinations maximizes fourth-corner correlation composite trait composite environmental gradient. dc-CA eigenvalues squared fourth-corner correlations, also variances, namely amounts variation abundance data consecutive axes explain (Ter Braak, Šmilauer, Dray 2018). Statistical testing max test (Ter Braak, Cormont, Dray 2012), evaluated extensive simulation (Ter Braak 2019). test combines two permutations tests, one permuting sites permuting species, maximum P-value final P-value. vegan package, permutations specified via permute package (Simpson 2022), allow analysis hierarchical nested data designs (Gobbi et al. 2022). douconca, dc-CA model specified two formulas: formula sites (rows) environmental predictors formula species (columns) trait predictors, may contain factors, quantitative variables transformations thereof, interactions, like (generalized) linear regression model. formulas specify constraints applied site species scores; without constraints dc-CA simply correspondence analysis. double constrained version principal components analysis also exists available Canoco software (Ter Braak Šmilauer 2018), less appeal ecological applications lacks ecological realism, ease interpretation link methods, CWM-regression fourth-corner correlation analysis, proven useful trait-based ecology.","code":""},{"path":"/articles/douconca.html","id":"example-data-and-questions","dir":"Articles","previous_headings":"","what":"Example data and questions","title":"douconca","text":"use dune_trait_env data package illustrate dc-CA. consists abundances 28 plant species 20 meadows (plots, called sites), trait data plant species environmental data sites. five morphological traits (LEDA trait database) four ecological traits (Ellenberg indicator values moisture (F), acidity (R), nutrients (N) light (L)). five environmental variables two sets two spatial coordinates, approximately equal. X Y coordinates plot. lot-variables center meadow sample taken. type questions dc-CA able address : many dimenstions needed represent major part trait-environment relations? trait-environment relationship statistically significant? many dimensions statistically significant? importance variable dc-CA axis? trait-structured variation trait sets larger variation? trait sets (morphological versus ecological) closely related environmental variables?","code":"library(douconca) data(\"dune_trait_env\") names(dune_trait_env) #> [1] \"comm\"   \"traits\" \"envir\" dim(dune_trait_env$comm[, -1]) ## without the variable \"Sites\" #> [1] 20 28 dim(dune_trait_env$traits) #> [1] 28 11 dim(dune_trait_env$envir) #> [1] 20 10 names(dune_trait_env$traits) #>  [1] \"Species\"      \"Species_abbr\" \"SLA\"          \"Height\"       \"LDMC\"         #>  [6] \"Seedmass\"     \"Lifespan\"     \"F\"            \"R\"            \"N\"            #> [11] \"L\" names(dune_trait_env$envir) #>  [1] \"Sites\"  \"A1\"     \"Moist\"  \"Mag\"    \"Use\"    \"Manure\" \"X\"      \"Y\"      #>  [9] \"X_lot\"  \"Y_lot\""},{"path":"/articles/douconca.html","id":"basic-analysis","dir":"Articles","previous_headings":"Example data and questions","what":"Basic analysis","title":"douconca","text":"next code gives basic dc-CA analysis. response matrix data frame must numerical, columns representing species. first variable (Sites) must therefore deleted. douconca, dc-CA calculated two steps provide useful information . Step 1 dc-CA algorithm summarizes canonical correspondence analysis (CCA) transposed response matrix trait data using formulaTraits = ~ SLA + Height + LDMC + Seedmass + Lifespan. morphological traits formula explain 28.85% total inertia (variance) abundance data Y. inertia (0.6776) called trait-structured variation. Inertia general weighted variance, case thus unweighted sites equal weight analysis, divideBySiteTotals true defaults. Formally, total (unweighted) variance community weighted means orthonormalized traits (traits orthonormalized Step 1). trait-structured variation analyzed Step 2 using redundancy analysis (RDA). Step 2 shows 65.73% variation can explained environmental variables using formulaEnv = ~ A1 + Moist + Use + Manure + Mag. constrained axes RDA also dc-CA eigenvalues: first axis explains 53% trait-environment variance axis dominated moisture SLA Seedmass, judged size regression coefficient (optimistic) t-value axis print model. default plot shows intra-set correlations variables axis, t-values can visualized ","code":"Y <- dune_trait_env$comm[, -1] # must delete \"Sites\" mod <- dc_CA(formulaEnv = ~ A1 + Moist + Use + Manure + Mag,              formulaTraits = ~ SLA + Height + LDMC + Seedmass + Lifespan,              response = Y,              dataEnv = dune_trait_env$envir,              dataTraits = dune_trait_env$traits) #> Step 1: the CCA ordination of the transposed matrix with trait constraints, #>         useful in itself and also yielding CWMs of the orthonormalized traits for step 2. #> Call: cca0(formula = formulaTraits, response = tY, data = #> out0$data$dataTraits) #>  #> -- Model Summary -- #>  #>               Inertia Proportion Rank #> Total          2.3490     1.0000      #> Constrained    0.6776     0.2885    5 #> Unconstrained  1.6714     0.7115   19 #>  #> Inertia is scaled Chi-square #>  #> -- Eigenvalues -- #>  #> Eigenvalues for constrained axes: #>    CCA1    CCA2    CCA3    CCA4    CCA5  #> 0.26839 0.19597 0.12356 0.07003 0.01967  #>  #> Eigenvalues for unconstrained axes: #> CA1 CA2 CA3 CA4 CA5 CA6 CA7 CA8  #>  NA  NA  NA  NA  NA  NA  NA  NA  #> (Showing 8 of 19 unconstrained eigenvalues) #>  #> mean, sd, VIF and canonical coefficients with their optimistic [!] t-values: #>                        Avg     SDS    VIF   Regr1   tval1 #> SLA                24.6468  6.3438 1.1888  0.4401  4.1794 #> Height             25.1272 15.6848 1.3033  0.1283  1.1640 #> LDMC              244.5084 70.9729 1.1791  0.0278  0.2647 #> Seedmass            0.6543  0.6688 1.0784  0.3708  3.6980 #> Lifespanperennial   0.9607  0.1944 1.0964 -0.0578 -0.5718 #>  #> Step 2: the RDA ordination of CWMs of the orthonormalized traits  #>         of step 1 with environmental constraints: #> Call: rda(formula = out1$CWMs_orthonormal_traits ~ A1 + Moist + Use + #> Manure + Mag, data = out1$data$dataEnv) #>  #> -- Model Summary -- #>  #>               Inertia Proportion Rank #> Total          0.6776     1.0000      #> Constrained    0.4454     0.6573    5 #> Unconstrained  0.2322     0.3427    5 #>  #> Inertia is variance #>  #> -- Eigenvalues -- #>  #> Eigenvalues for constrained axes: #>    RDA1    RDA2    RDA3    RDA4    RDA5  #> 0.23680 0.10903 0.05934 0.03792 0.00233  #>  #> Eigenvalues for unconstrained axes: #>     PC1     PC2     PC3     PC4     PC5  #> 0.12017 0.05836 0.03455 0.01337 0.00575  #>  #> mean, sd, VIF and canonical coefficients with their optimistic [!] t-values: #>         Avg    SDS    VIF   Regr1   tval1 #> A1     4.85 2.1240 1.6967 -0.0605 -0.9172 #> Moist  2.90 1.7578 1.7658  0.3250  4.8293 #> Use    1.90 0.7681 1.7825  0.0219  0.3239 #> Manure 1.75 1.4448 9.3847 -0.1444 -0.9306 #> MagBF  0.15 0.3571 4.5016 -0.0475 -0.4421 #> MagHF  0.25 0.4330 2.6715 -0.0156 -0.1890 #> MagNM  0.30 0.4583 9.5666  0.1622  1.0352 #>                        Avg     SDS    VIF   Regr1   tval1 #> SLA                24.6468  6.3438 1.1888 -0.8196 -3.6933 #> Height             25.1272 15.6848 1.3033 -0.1598 -0.6877 #> LDMC              244.5084 70.9729 1.1791 -0.0562 -0.2542 #> Seedmass            0.6543  0.6688 1.0784 -0.7586 -3.5896 #> Lifespanperennial   0.9607  0.1944 1.0964  0.1006  0.4722 #>  #>                weighted variance #> total                      2.349 #> traits_explain             0.678 #> env_explain                1.323 #> constraintsTE              0.445 #> attr(,\"meaning\") #>                meaning                                                                 #> total          \"total inertia (= weighted variation)\"                                  #> traits_explain \"trait-constrained variation\"                                           #> env_explain    \"environment-constrained variation\"                                     #> constraintsTE  \"trait-constrained variation explained by the predictors in formulaEnv\" mod$eigenvalues #>      dcCA1      dcCA2      dcCA3      dcCA4      dcCA5  #> 0.23680387 0.10903220 0.05933626 0.03791909 0.00232876 plot(mod, gradient_description = \"t\")"},{"path":"/articles/douconca.html","id":"statistical-testing","dir":"Articles","previous_headings":"Example data and questions","what":"Statistical testing","title":"douconca","text":"two-ways statistically test model: (1) omnibus test (using five dimensions) obtained anova(mod), giving P-value 0.02 (2) test per dc-CA axis, obtained test per axis, first axis P-values 0.09 0.001 species- site-level, respectively, P-value max test 0.09. little explanation may instructive. species-level test consists testing (weighted) regression species-niche-centroids respect orthonormalized environmental variables traits. site-level test consists testing (case, unweighted) regression community-weighted means orthonormalized traits environmental variables. tests carried permutation, first permuting species trait data, second permuting sites environmental data. new dc-CA carried permuted data set. full description see Details help system.","code":"set.seed(1) anova(mod, by = \"axis\") #> $species #> Species-level permutation test using dc-CA #> Model: dc_CA(formulaEnv = ~A1 + Moist + Use + Manure + Mag, formulaTraits = ~SLA + Height + LDMC + Seedmass + Lifespan, response = Y, dataEnv = dune_trait_env$envir, dataTraits = dune_trait_env$traits)  #> Residualized predictor permutation #>  #>          df ChiSquare       R2      F Pr(>F)   #> dcCA1     1   0.23680 0.179002 5.9370  0.087 . #> dcCA2     1   0.10903 0.082419 2.7336  0.476   #> dcCA3     1   0.05934 0.044853 1.4877  0.760   #> dcCA4     1   0.03792 0.028663 0.9507  0.816   #> dcCA5     1   0.00233 0.001760 0.0584  1.000   #> Residual 22   0.87749                          #> --- #> Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1 #>  #> $sites #>          Df ChiSquare      R2       F Pr(>F)     #> dcCA1     1  0.236804 0.34946 14.2776  0.001 *** #> dcCA2     1  0.109032 0.16090  6.5739  0.075 .   #> dcCA3     1  0.059336 0.08757  3.5776  0.409     #> dcCA4     1  0.037919 0.05596  2.2863  0.676     #> dcCA5     1  0.002329 0.00344  0.1404  1.000     #> Residual 14  0.232199                            #> --- #> Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1 #>  #> $maxP #> Max test combining the community- and species- level tests  #> Model: dc_CA(formulaEnv = ~A1 + Moist + Use + Manure + Mag, formulaTraits = ~SLA + Height + LDMC + Seedmass + Lifespan, response = Y, dataEnv = dune_trait_env$envir, dataTraits = dune_trait_env$traits)  #>  #> Taken from the species-level test: #> Residualized predictor permutation #> Permutation: free #> Number of permutations: 999 #>  #>          df ChiSquare       R2      F Pr(>F)   #> dcCA1     1   0.23680 0.179002 5.9370  0.087 . #> dcCA2     1   0.10903 0.082419 2.7336  0.476   #> dcCA3     1   0.05934 0.044853 1.4877  0.760   #> dcCA4     1   0.03792 0.028663 0.9507  0.816   #> dcCA5     1   0.00233 0.001760 0.0584  1.000   #> Residual 22   0.87749                          #> --- #> Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1"},{"path":"/articles/douconca.html","id":"fitted-values-and-predictions","dir":"Articles","previous_headings":"Example data and questions","what":"Fitted values and predictions","title":"douconca","text":"three kinds fitted values (predictions new data): fitted traits per site, obtained predict(mod, type = \"traits\" ) fitted environmental values per species, obtained predict(mod, type = \"env\") fitted abundances, obtained predict(mod, type = \"response\" ) fitted traits per site simply fitted community-weighted means fitted environmental values fitted species-niche centroids, clearer statements fitted(mod, type = \"CWM\") fitted(mod, type = \"SNC\"), respectively. Note 10% fitted abundance values negative example. Negative values indicate likely absences low abundance values species specified traits environmental values.","code":""},{"path":"/articles/douconca.html","id":"which-set-of-traits-is-most-closely-related-to-abundance-and-to-the-environment","dir":"Articles","previous_headings":"","what":"Which set of traits is most closely related to abundance and to the environment?","title":"douconca","text":"section, pose question whether set morphological (functional) traits less related species abundance environmental variables set ecological traits. entry traits_explain 0.87, variance abundance data explained traits. can directly compared corresponding entry previous model, 0.678. entry constraintsTE variance abundance data explained traits environmental variables jointly. value second model higher first. closer examination results, second eigenvalue last model even higher first one first model , indeed, first two dc-CA axes significant can seen anova: fourth-corner correlation best linear combination ecological traits best linear combination environmental variables compared 0.49 best linear combination morphological traits. conclusion, ecological traits explain abundance data closer related environmental variables.","code":"mod_e <-  dc_CA(formulaEnv = ~ A1 + Moist + Manure + Use + Mag,                 formulaTraits = ~ F + R + N + L,                 response = Y,                 dataEnv = dune_trait_env$envir,                 dataTraits = dune_trait_env$traits) #> Step 1: the CCA ordination of the transposed matrix with trait constraints, #>         useful in itself and also yielding CWMs of the orthonormalized traits for step 2. #> Call: cca0(formula = formulaTraits, response = tY, data = #> out0$data$dataTraits) #>  #> -- Model Summary -- #>  #>               Inertia Proportion Rank #> Total          2.3490     1.0000      #> Constrained    0.8701     0.3704    4 #> Unconstrained  1.4789     0.6296   19 #>  #> Inertia is scaled Chi-square #>  #> -- Eigenvalues -- #>  #> Eigenvalues for constrained axes: #>   CCA1   CCA2   CCA3   CCA4  #> 0.4771 0.3122 0.0580 0.0228  #>  #> Eigenvalues for unconstrained axes: #> CA1 CA2 CA3 CA4 CA5 CA6 CA7 CA8  #>  NA  NA  NA  NA  NA  NA  NA  NA  #> (Showing 8 of 19 unconstrained eigenvalues) #>  #> mean, sd, VIF and canonical coefficients with their optimistic [!] t-values: #>      Avg    SDS    VIF   Regr1   tval1 #> F 6.1126 1.6685 1.1323  0.6048  8.2493 #> R 5.8061 1.1894 1.7564  0.0170  0.1865 #> N 5.1674 1.6303 1.7822 -0.1358 -1.4764 #> L 7.3839 0.8774 1.1378  0.1424  1.9382 #>  #> Step 2: the RDA ordination of CWMs of the orthonormalized traits  #>         of step 1 with environmental constraints: #> Call: rda(formula = out1$CWMs_orthonormal_traits ~ A1 + Moist + Manure + #> Use + Mag, data = out1$data$dataEnv) #>  #> -- Model Summary -- #>  #>               Inertia Proportion Rank #> Total          0.8701     1.0000      #> Constrained    0.6331     0.7277    4 #> Unconstrained  0.2369     0.2723    4 #>  #> Inertia is variance #>  #> -- Eigenvalues -- #>  #> Eigenvalues for constrained axes: #>   RDA1   RDA2   RDA3   RDA4  #> 0.3684 0.2452 0.0141 0.0054  #>  #> Eigenvalues for unconstrained axes: #>     PC1     PC2     PC3     PC4  #> 0.14787 0.06377 0.01573 0.00954  #>  #> mean, sd, VIF and canonical coefficients with their optimistic [!] t-values: #>         Avg    SDS    VIF   Regr1   tval1 #> A1     4.85 2.1240 1.6967  0.1527  1.3122 #> Moist  2.90 1.7578 1.7658  0.4584  3.8618 #> Manure 1.75 1.4448 9.3847  0.0243  0.0888 #> Use    1.90 0.7681 1.7825  0.0886  0.7432 #> MagBF  0.15 0.3571 4.5016 -0.0086 -0.0452 #> MagHF  0.25 0.4330 2.6715  0.0136  0.0930 #> MagNM  0.30 0.4583 9.5666  0.1136  0.4110 #>      Avg    SDS    VIF   Regr1   tval1 #> F 6.1126 1.6685 1.1323  0.8158  6.0720 #> R 5.8061 1.1894 1.7564 -0.1812 -1.0830 #> N 5.1674 1.6303 1.7822 -0.1905 -1.1304 #> L 7.3839 0.8774 1.1378  0.3043  2.2594 #>  #>                weighted variance #> total                      2.349 #> traits_explain             0.870 #> env_explain                1.323 #> constraintsTE              0.633 #> attr(,\"meaning\") #>                meaning                                                                 #> total          \"total inertia (= weighted variation)\"                                  #> traits_explain \"trait-constrained variation\"                                           #> env_explain    \"environment-constrained variation\"                                     #> constraintsTE  \"trait-constrained variation explained by the predictors in formulaEnv\" anova(mod_e, by = \"axis\")$max #> Max test combining the community- and species- level tests  #> Model: dc_CA(formulaEnv = ~A1 + Moist + Manure + Use + Mag, formulaTraits = ~F + R + N + L, response = Y, dataEnv = dune_trait_env$envir, dataTraits = dune_trait_env$traits)  #>  #> Taken from the community-level test. #>  #>          Df ChiSquare      R2       F Pr(>F)    #> dcCA1     1   0.36835 0.42337 23.3220  0.002 ** #> dcCA2     1   0.24525 0.28188 15.5276  0.017 *  #> dcCA3     1   0.01413 0.01624  0.8944  0.996    #> dcCA4     1   0.00541 0.00622  0.3427  1.000    #> Residual 15   0.23691                           #> --- #> Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1 round(sqrt(mod_e$eigenvalues[1]), 2) #> dcCA1  #>  0.61"},{"path":"/articles/douconca.html","id":"do-the-morphological-traits-contribute-after-accounting-for-the-ecological-traits","dir":"Articles","previous_headings":"","what":"Do the morphological traits contribute after accounting for the ecological traits?","title":"douconca","text":"morphological traits carry important additional information species (beyond ecological traits) understanding species occur ? (.e. understanding species-environment relationships). address question, specify ecological traits Condition trait formula perform anova resulting model. jugded test significance axes, little evidence morphological traits contribute explanation (environmentally structured) abundance species.","code":"mod_mGe <-  dc_CA(formulaEnv = ~ A1 + Moist + Manure + Use + Mag,                  formulaTraits = ~ SLA + Height + LDMC + Seedmass + Lifespan +                    Condition(F + R + N + L),                  response = Y,                  dataEnv = dune_trait_env$envir,                  dataTraits = dune_trait_env$traits, verbose = FALSE) anova(mod_mGe, by= \"axis\")$max #> Max test combining the community- and species- level tests  #> Model: dc_CA(formulaEnv = ~A1 + Moist + Manure + Use + Mag, formulaTraits = ~SLA + Height + LDMC + Seedmass + Lifespan + Condition(F + R + N + L), response = Y, dataEnv = dune_trait_env$envir, dataTraits = dune_trait_env$traits, verbose = FALSE)  #>  #> Taken from the species-level test: #> Residualized predictor permutation #> Permutation: free #> Number of permutations: 999 #>  #>          df ChiSquare       R2      F Pr(>F) #> dcCA1     1   0.09333 0.135306 3.4800  0.183 #> dcCA2     1   0.07101 0.102951 2.6479  0.280 #> dcCA3     1   0.03381 0.049017 1.2607  0.837 #> dcCA4     1   0.00629 0.009115 0.2344  1.000 #> dcCA5     1   0.00259 0.003761 0.0967  1.000 #> Residual 18   0.48274"},{"path":[]},{"path":"/articles/douconca.html","id":"introduction","dir":"Articles","previous_headings":"One trait: CWM regression without inflated type I error.","what":"Introduction","title":"douconca","text":"CWM regression know suffer serious type error inflation statistical testing (Peres-Neto, Dray, Ter Braak 2017; Lepš De Bello 2023). section shows perform CWM regression single trait using dc-CA max test guard type error inflation. test suffer , sometimes extreme, conservativeness ZS (Zelený & Schaffers) modified test (Ter Braak, Peres-Neto, Dray 2018; Lepš De Bello 2023). also show equivalence site-level test CWM-regression equivalence dc-CA CWM regression coefficients. way, give examples scores fCWM_SNC functions douconca package.","code":""},{"path":"/articles/douconca.html","id":"testing-the-relationship-between-ldmc-and-the-environmental-variables","dir":"Articles","previous_headings":"One trait: CWM regression without inflated type I error.","what":"Testing the relationship between LDMC and the environmental variables","title":"douconca","text":"P-values species-level site-level permutation tests 0.396 0.028, respectively, final P-value 0.396. thus evidence trait LDMC related environmental variables model. now show performing CWM-regression lead opposite conclusion. , first calculate CWMs LDMC, using function fCWM_SNC, arguments similar dc_CA function. result, CWMSNC_LDMC, list containing CWMs LDMC, among items. combine (community-weighted) mean LDMC environmental data, apply linear regresion compare model null model using anova. resulting P-value 0.0279, agreement P-value site-level permutation test model. CWM-regression LDMC shows evidence relationship environmental variables whereas fact little evidence shown dc-CA.","code":"mod_LDMC <- dc_CA(formulaEnv = ~ A1 + Moist + Manure + Use + Mag,                    formulaTraits = ~ LDMC,                    response = Y,                     dataEnv = dune_trait_env$envir,                    dataTraits = dune_trait_env$trait, verbose = FALSE) anova(mod_LDMC) #> $species #> Species-level permutation test using dc-CA #> Model: dc_CA(formulaEnv = ~A1 + Moist + Manure + Use + Mag, formulaTraits = ~LDMC, response = Y, dataEnv = dune_trait_env$envir, dataTraits = dune_trait_env$trait, verbose = FALSE)  #> Residualized predictor permutation #>  #>          df ChiSquare       R2      F Pr(>F) #> dcCA      1   0.05605 0.042368 1.1503  0.396 #> Residual 26   1.26686                        #>  #> $sites #>          Df ChiSquare      R2      F Pr(>F)   #> dcCA1     7  0.056048 0.67074 3.4922  0.028 * #> Residual 12  0.027513                         #> --- #> Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1 #>  #> $maxP #> Max test combining the community- and species- level tests  #> Model: dc_CA(formulaEnv = ~A1 + Moist + Manure + Use + Mag, formulaTraits = ~LDMC, response = Y, dataEnv = dune_trait_env$envir, dataTraits = dune_trait_env$trait, verbose = FALSE)  #>  #> Taken from the species-level test: #> Residualized predictor permutation #> Permutation: free #> Number of permutations: 999 #>  #>          df ChiSquare       R2      F Pr(>F) #> dcCA      1   0.05605 0.042368 1.1503  0.396 #> Residual 26   1.26686 CWMSNC_LDMC <- fCWM_SNC(formulaEnv = ~ A1 + Moist + Manure + Use + Mag,                         formulaTraits = ~ LDMC,                         response = Y,                          dataEnv = dune_trait_env$envir,                         dataTraits = dune_trait_env$trait) envCWM <- cbind(dune_trait_env$envir, CWMSNC_LDMC$CWM) lmLDMC <- lm(LDMC ~ A1 + Moist + Manure + Use + Mag, data = envCWM) anova(lmLDMC, lm(LDMC ~ 1, data = envCWM)) #> Analysis of Variance Table #>  #> Model 1: LDMC ~ A1 + Moist + Manure + Use + Mag #> Model 2: LDMC ~ 1 #>   Res.Df    RSS Df Sum of Sq      F Pr(>F)   #> 1     12 2771.8                              #> 2     19 8418.3 -7   -5646.5 3.4922 0.0279 * #> --- #> Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1"},{"path":"/articles/douconca.html","id":"the-coefficients-of-a-cwm-regression-are-proportional-to-those-of-dc-ca","dir":"Articles","previous_headings":"One trait: CWM regression without inflated type I error.","what":"The coefficients of a CWM-regression are proportional to those of dc-CA","title":"douconca","text":"introduction said dc-CA extends CWM-regression multiple traits. now show regression coefficients issued dc-CA single trait , scaling constant, identical linear CWM-regression trait. first extract regression coefficients dc-CA model using scores function. second line calculates regression coefficients dividing standardize regression coefficients dc_CA standard deviation environmental variable. result shows two sets coefficients equal constant proportionality, 154.4359. t-values also equal: Alternatively, can use coef(mod_LDMC,  type = \"env2traits\",normed = FALSE) give values coef(lmLDMC)[-1]. # References","code":"(regr_table <- scores(mod_LDMC, display = \"reg\")) #>         Avg       SDS      VIF       dcCA1 #> A1     4.85 2.1240292 1.696694 -0.16636060 #> Moist  2.90 1.7578396 1.765817 -0.02346540 #> Manure 1.75 1.4448183 9.384723  0.78784718 #> Use    1.90 0.7681146 1.782458 -0.33963301 #> MagBF  0.15 0.3570714 4.501582  0.25168168 #> MagHF  0.25 0.4330127 2.671474  0.09905591 #> MagNM  0.30 0.4582576 9.566575  0.71778929 #> attr(,\"meaning\") #> [1] \"mean, sd, VIF, standardized regression coefficients.\" coefs_LDMC_dcCA <- regr_table[, \"dcCA1\"] / regr_table[, \"SDS\"] range(coef(lmLDMC)[-1] / coefs_LDMC_dcCA) #> [1] 34.53293 34.53293 cbind(summary(lmLDMC)$coefficients[-1, \"t value\", drop = FALSE], scores(mod_LDMC, display = \"tval\")) #>           t value      dcCA1 #> A1     -1.2978033 -1.2978033 #> Moist  -0.1794383 -0.1794383 #> Manure  2.6133127  2.6133127 #> Use    -2.5849991 -2.5849991 #> MagBF   1.2053943  1.2053943 #> MagHF   0.6158360  0.6158360 #> MagNM   2.3581903  2.3581903"},{"path":"/authors.html","id":null,"dir":"","previous_headings":"","what":"Authors","title":"Authors and Citation","text":"Cajo J.F ter Braak. Author. Bart-Jan van Rossum. Author, maintainer.","code":""},{"path":"/authors.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Authors and Citation","text":"ter Braak C, van Rossum B (2025). douconca: Double Constrained Correspondence Analysis Trait-Environment Analysis Ecology. R package version 1.2.3, https://zenodo.org/records/13970152.","code":"@Manual{,   title = {douconca: Double Constrained Correspondence Analysis for Trait-Environment Analysis in Ecology},   author = {Cajo J.F {ter Braak} and Bart-Jan {van Rossum}},   year = {2025},   note = {R package version 1.2.3},   url = {https://zenodo.org/records/13970152}, }"},{"path":"/index.html","id":"douconca","dir":"","previous_headings":"","what":"Double Constrained Correspondence Analysis for Trait-Environment Analysis in Ecology","title":"Double Constrained Correspondence Analysis for Trait-Environment Analysis in Ecology","text":"R library douconca analyzes multi-trait multi-environment ecological data double constrained correspondence analysis (ter Braak & van Rossum, 2025) using vegan native R code. formula interface trait- (column-) environment- (row-) models, allows assess, example, importance trait interactions shaping ecological communities. Throughout two step algorithm ter Braak et al. (2018) used. algorithm combines extends community- (sample-) species-level analyses, .e. usual community weighted means (CWM)-based regression analysis species-level analysis species-niche centroids (SNC)-based regression analysis. CWM regressions specified environmental formula SNC regressions specified trait formula. dcCA finds environmental trait gradients optimize regressions. first step uses cca (Oksanen et al. 2022) regress transposed abundance data traits (weighted) redundancy analysis regress community-weighted means (CWMs) orthonormalized traits, obtained first step, environmental predictors. sample total abundance data used weights. redundancy analysis carried using rda sites equal weights (division rows total) , general weighted case, using wrda. Division sample total advantage multivariate analysis corresponds unweighted (multi-trait) community-level analysis, instead weighted, may give puzzling difference common univariate multivariate analysis. References: ter Braak, CJF, Šmilauer P, Dray S. 2018. Algorithms biplots double constrained correspondence analysis. Environmental Ecological Statistics, 25(2), 171-197. https://doi.org/10.1007/s10651-017-0395-x ter Braak, C.J.F. van Rossum, B. (2025). Linking Multivariate Trait Variation Environment: Advantages Double Constrained Correspondence Analysis R Package Douconca. Ecological Informatics, 88. https://doi.org/10.1016/j.ecoinf.2025.103143 ## Installation can install CRAN version douconca : can install development version douconca :","code":"install.packages(\"douconca\") install.packages(\"remotes\") remotes::install_github(\"Biometris/douconca\", ref = \"develop\", dependencies = TRUE)"},{"path":"/reference/FS.dcca.html","id":null,"dir":"Reference","previous_headings":"","what":"Forward selection of traits or environmental variables using dc-CA. — FS.dcca","title":"Forward selection of traits or environmental variables using dc-CA. — FS.dcca","text":"Forward selection traits environmental variables using dc-CA.","code":""},{"path":"/reference/FS.dcca.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Forward selection of traits or environmental variables using dc-CA. — FS.dcca","text":"","code":"# S3 method for class 'dcca' FS(   mod,   ...,   select = c(\"traits\", \"env\"),   consider,   permutations = 999,   n_axes = \"all\",   initial_model = \"1\",   factor2categories = TRUE,   test = TRUE,   threshold_P = 0.1,   PvalAdjustMethod = \"holm\",   max_step = 10,   verbose = FALSE )"},{"path":"/reference/FS.dcca.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Forward selection of traits or environmental variables using dc-CA. — FS.dcca","text":"mod dc-CA model. ... unused. select Character, default \"traits\" selects trait variables based environmental model mod. Set select = \"e\" select environmental variables based trait model mod. consider character vector names considered addition, either trait names mod$data$dataTraits environmental variable names mod$data$dataEnv. names may include transformations predictor variables, log(.), consider include factors factor2categories=FALSE. consider includes factors, transformations give error default setting (factor2categories=TRUE). permutations list control values permutations returned function , number permutations required (default 999), permutation matrix row gives permuted indices. n_axes number eigenvalues select upon. sum n_axes eigenvalues taken criterion. Default \"full\" selection without dimension reduction n_axes. n_axes =1, selection first eigenvalue selection variables form optimal one-dimensional model. initial_model character specifying inside Condition(). Default: \"1\" (nothing, intercept ). Examples: selection environmental varialbles, \"region\" within-region analysis \"*B\" within analysis specified interaction factors B, region, , B data. Analogously, trait trait factor can initial model. factor2categories logical, default TRUE, convert factors categories (set(s) indicator values). FALSE, selection uses, fit factor divided number categories minus 1. test logical; default: TRUE. threshold_P significance level, adjustment testing multiplicity, addition variable model. PvalAdjustMethod method correction multiple testing  p.adjust, default \"holm\", improved version Bonferroni. max_step maximal number variables selected. verbose show progress, default: TRUE.","code":""},{"path":"/reference/FS.dcca.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Forward selection of traits or environmental variables using dc-CA. — FS.dcca","text":"list three elements: final... selected variables, model_final, process account selection process","code":""},{"path":"/reference/FS.dcca.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Forward selection of traits or environmental variables using dc-CA. — FS.dcca","text":"selection basis additional fit (inertia) variable given variables already model. function FS implement max test may thus liberal. recommended test final model (element model_ final returned object) anova.","code":""},{"path":"/reference/FS.dcca.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Forward selection of traits or environmental variables using dc-CA. — FS.dcca","text":"","code":"data(\"dune_trait_env\")  # rownames are carried forward in results rownames(dune_trait_env$comm) <- dune_trait_env$comm$Sites abun <- dune_trait_env$comm[, -1] # must delete \"Sites\"  mod <- dc_CA(formulaEnv = abun ~ Moist + Mag,              formulaTraits = ~ F + R + N + L,              dataEnv = dune_trait_env$envir,              dataTraits = dune_trait_env$traits,              verbose = FALSE)  # selection of traits with environmental model of mod (~ Moist+Mag) out1 <- FS(mod, consider = c(\"F\", \"R\", \"N\", \"L\"),             select = \"traits\", verbose = FALSE)   names(out1) #> [1] \"finalWithOneExtra\" \"model_final\"       \"formula\"           #> [4] \"process\"           out1$finalWithOneExtra #>   df   variance  pval pvaladj #> F  1 0.28633635 0.001   0.004 #> N  1 0.24243384 0.001   0.003 #> L  1 0.03114819 0.126   0.252 out1$model_final #> Step 1: the CCA ordination of the transposed matrix with trait constraints, #>         useful in itself and also yielding CWMs of the orthonormalized traits for step 2. #> Call: cca0(formula = formulaTraits, response = tY, data = #> out0$data$dataTraits) #>  #> -- Model Summary -- #>  #>               Inertia Proportion Rank #> Total          2.3490     1.0000      #> Constrained    0.7657     0.3260    2 #> Unconstrained  1.5833     0.6740   19 #>  #> Inertia is scaled Chi-square #>  #> -- Eigenvalues -- #>  #> Eigenvalues for constrained axes: #>   CCA1   CCA2  #> 0.4576 0.3081  #>  #> Eigenvalues for unconstrained axes: #> CA1 CA2 CA3 CA4 CA5 CA6 CA7 CA8  #>  NA  NA  NA  NA  NA  NA  NA  NA  #> (Showing 8 of 19 unconstrained eigenvalues) #>  #> mean, sd, VIF and canonical coefficients with their optimistic [!] t-values: #>      Avg    SDS    VIF   Regr1   tval1 #> F 6.1126 1.6685 1.0575  0.6413  8.7440 #> N 5.1674 1.6303 1.0575 -0.1125 -1.5334 #>  #> Step 2: the RDA ordination of CWMs of the orthonormalized traits  #>         of step 1 with environmental constraints: #> Call: rda(formula = out1$CWMs_orthonormal_traits ~ Moist + Mag, data = #> out1$data$dataEnv) #>  #> -- Model Summary -- #>  #>               Inertia Proportion Rank #> Total          0.7657     1.0000      #> Constrained    0.5288     0.6906    2 #> Unconstrained  0.2370     0.3094    2 #>  #> Inertia is variance #>  #> -- Eigenvalues -- #>  #> Eigenvalues for constrained axes: #>    RDA1    RDA2  #> 0.31310 0.21567  #>  #> Eigenvalues for unconstrained axes: #>     PC1     PC2  #> 0.17114 0.06581  #>  #> mean, sd, VIF and canonical coefficients with their optimistic [!] t-values: #>        Avg    SDS    VIF  Regr1  tval1 #> Moist 2.90 1.7578 1.3001 0.4769 4.6192 #> MagBF 0.15 0.3571 1.4553 0.0075 0.0684 #> MagHF 0.25 0.4330 1.4214 0.0527 0.4879 #> MagNM 0.30 0.4583 1.4393 0.1948 1.7933 #>      Avg    SDS    VIF  Regr1   tval1 #> F 6.1126 1.6685 1.0575  0.726  4.9779 #> N 5.1674 1.6303 1.0575 -0.539 -3.6956 #>  #>                weighted variance #> total                      2.349 #> traits_explain             0.766 #> env_explain                0.967 #> constraintsTE              0.529 #> attr(,\"meaning\") #>                meaning                                                                 #> total          \"total inertia (= weighted variation)\"                                  #> traits_explain \"trait-constrained variation\"                                           #> env_explain    \"environment-constrained variation\"                                     #> constraintsTE  \"trait-constrained variation explained by the predictors in formulaEnv\"  # selection of environmental variables with trait model of mod (~ F + R + N + L) out2 <- FS(mod, consider =  c(\"A1\", \"Moist\", \"Mag\", \"Use\", \"Manure\"),             select= \"env\", verbose = FALSE)   names(out2) #> [1] \"finalWithOneExtra\" \"model_final\"       \"formula\"           #> [4] \"process\"           out2$finalWithOneExtra #>        df   variance  pval pvaladj #> Moist   1 0.33061402 0.001   0.008 #> Manure  1 0.20050625 0.001   0.007 #> A1      1 0.04503044 0.072   0.432 out2$model_final #> Step 1: the CCA ordination of the transposed matrix with trait constraints, #>         useful in itself and also yielding CWMs of the orthonormalized traits for step 2. #> Call: cca0(formula = formulaTraits, response = tY, data = #> out0$data$dataTraits) #>  #> -- Model Summary -- #>  #>               Inertia Proportion Rank #> Total          2.3490     1.0000      #> Constrained    0.8701     0.3704    4 #> Unconstrained  1.4789     0.6296   19 #>  #> Inertia is scaled Chi-square #>  #> -- Eigenvalues -- #>  #> Eigenvalues for constrained axes: #>   CCA1   CCA2   CCA3   CCA4  #> 0.4771 0.3122 0.0580 0.0228  #>  #> Eigenvalues for unconstrained axes: #> CA1 CA2 CA3 CA4 CA5 CA6 CA7 CA8  #>  NA  NA  NA  NA  NA  NA  NA  NA  #> (Showing 8 of 19 unconstrained eigenvalues) #>  #> mean, sd, VIF and canonical coefficients with their optimistic [!] t-values: #>      Avg    SDS    VIF   Regr1   tval1 #> F 6.1126 1.6685 1.1323  0.6048  8.2493 #> R 5.8061 1.1894 1.7564  0.0170  0.1865 #> N 5.1674 1.6303 1.7822 -0.1358 -1.4764 #> L 7.3839 0.8774 1.1378  0.1424  1.9382 #>  #> Step 2: the RDA ordination of CWMs of the orthonormalized traits  #>         of step 1 with environmental constraints: #> Call: rda(formula = out1$CWMs_orthonormal_traits ~ Moist + Manure + #> Condition(1), data = out1$data$dataEnv) #>  #> -- Model Summary -- #>  #>               Inertia Proportion Rank #> Total          0.8701     1.0000      #> Constrained    0.5311     0.6104    2 #> Unconstrained  0.3389     0.3896    4 #>  #> Inertia is variance #>  #> -- Eigenvalues -- #>  #> Eigenvalues for constrained axes: #>   RDA1   RDA2  #> 0.3331 0.1980  #>  #> Eigenvalues for unconstrained axes: #>     PC1     PC2     PC3     PC4  #> 0.18449 0.10693 0.02887 0.01864  #>  #> mean, sd, VIF and canonical coefficients with their optimistic [!] t-values: #>         Avg    SDS    VIF   Regr1   tval1 #> Moist  2.90 1.7578 1.0645  0.5519  6.2344 #> Manure 1.75 1.4448 1.0645 -0.0809 -0.9142 #>      Avg    SDS    VIF   Regr1   tval1 #> F 6.1126 1.6685 1.1323  0.7661  5.4523 #> R 5.8061 1.1894 1.7564 -0.1975 -1.1287 #> N 5.1674 1.6303 1.7822 -0.2553 -1.4483 #> L 7.3839 0.8774 1.1378  0.3167  2.2482 #>  #>                weighted variance #> total                      2.349 #> traits_explain             0.870 #> env_explain                0.751 #> constraintsTE              0.531 #> attr(,\"meaning\") #>                meaning                                                                 #> total          \"total inertia (= weighted variation)\"                                  #> traits_explain \"trait-constrained variation\"                                           #> env_explain    \"environment-constrained variation\"                                     #> constraintsTE  \"trait-constrained variation explained by the predictors in formulaEnv\"  # selection of environmental variables without a trait model  # i.e. with a single constraint mod3 <- cca0(mod$data$Y ~ Moist, data = mod$data$dataEnv) out3 <- FS(mod3, consider = c(\"A1\", \"Moist\", \"Mag\", \"Use\", \"Manure\"),             threshold_P = 0.05)  out3$finalWithOneExtra #>       df  variance  pval pvaladj #> Moist  1 0.4672020 0.001   0.008 #> MagNM  1 0.3088722 0.001   0.007 #> A1     1 0.1841344 0.024   0.144 out3$model_final #> Call: FUN(formula = formula2, data = mydata, traceonly = FALSE, cca_object #> = mod) #>  #> -- Model Summary -- #>  #>               Inertia Proportion Rank #> Total          2.3490     1.0000      #> Constrained    0.7761     0.3304    2 #> Unconstrained  1.5729     0.6696   19 #>  #> Inertia is scaled Chi-square #>  #> -- Eigenvalues -- #>  #> Eigenvalues for constrained axes: #>   CCA1   CCA2  #> 0.4803 0.2958  #>  #> Eigenvalues for unconstrained axes: #> CA1 CA2 CA3 CA4 CA5 CA6 CA7 CA8  #>  NA  NA  NA  NA  NA  NA  NA  NA  #> (Showing 8 of 19 unconstrained eigenvalues) #>  #> mean, sd, VIF and canonical coefficients with their optimistic [!] t-values: #>       Avg    SDS    VIF   Regr1   tval1 #> Moist 2.9 0.3931 1.1374 -0.5995 -9.0496 #> MagNM 0.3 0.1025 1.1374 -0.1970 -2.9746 #>   # selection of traits without an environmental model  #                         i.e. with a single constraint tY <- t(mod$data$Y)  mod4 <- cca0(tY ~ L, data = mod$data$dataTraits)  names(mod$data$dataTraits) #>  [1] \"Species\"      \"Species_abbr\" \"SLA\"          \"Height\"       \"LDMC\"         #>  [6] \"Seedmass\"     \"Lifespan\"     \"F\"            \"R\"            \"N\"            #> [11] \"L\"            out4 <- FS(mod4,             consider =  c(\"SLA\", \"Height\", \"LDMC\", \"Seedmass\", \"Lifespan\",                           \"F\", \"R\", \"N\", \"L\"))  out4$finalWithOneExtra #>          df  variance  pval pvaladj #> F         1 0.4536777 0.001   0.010 #> N         1 0.3120442 0.001   0.009 #> Seedmass  1 0.1060672 0.060   0.480 out4$model_final #> Call: FUN(formula = formula2, data = mydata, traceonly = FALSE, cca_object #> = mod) #>  #> -- Model Summary -- #>  #>               Inertia Proportion Rank #> Total          2.3490     1.0000      #> Constrained    0.7657     0.3260    2 #> Unconstrained  1.5833     0.6740   19 #>  #> Inertia is scaled Chi-square #>  #> -- Eigenvalues -- #>  #> Eigenvalues for constrained axes: #>   CCA1   CCA2  #> 0.4576 0.3081  #>  #> Eigenvalues for unconstrained axes: #> CA1 CA2 CA3 CA4 CA5 CA6 CA7 CA8  #>  NA  NA  NA  NA  NA  NA  NA  NA  #> (Showing 8 of 19 unconstrained eigenvalues) #>  #> mean, sd, VIF and canonical coefficients with their optimistic [!] t-values: #>      Avg    SDS    VIF   Regr1   tval1 #> F 6.1126 1.6685 1.0575  0.6413  8.7440 #> N 5.1674 1.6303 1.0575 -0.1125 -1.5334 #>"},{"path":"/reference/FS.html","id":null,"dir":"Reference","previous_headings":"","what":"Default forward selection function. — FS","title":"Default forward selection function. — FS","text":"Default forward selection function.","code":""},{"path":"/reference/FS.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Default forward selection function. — FS","text":"","code":"FS(mod, ...)"},{"path":"/reference/FS.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Default forward selection function. — FS","text":"mod fitted model. ... arguments passed methods.","code":""},{"path":"/reference/FS.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Default forward selection function. — FS","text":"results applying forward selection fitted model.","code":""},{"path":"/reference/FS.wrda.html","id":null,"dir":"Reference","previous_headings":"","what":"Forward selection of predictor variables using wrda or cca0 — FS.wrda","title":"Forward selection of predictor variables using wrda or cca0 — FS.wrda","text":"Forward selection predictor variables using wrda cca0","code":""},{"path":"/reference/FS.wrda.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Forward selection of predictor variables using wrda or cca0 — FS.wrda","text":"","code":"# S3 method for class 'wrda' FS(   mod,   ...,   consider = NULL,   permutations = 999,   n_axes = \"all\",   initial_model = \"1\",   factor2categories = TRUE,   test = TRUE,   threshold_P = 0.1,   PvalAdjustMethod = \"holm\",   max_step = 10,   verbose = FALSE )"},{"path":"/reference/FS.wrda.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Forward selection of predictor variables using wrda or cca0 — FS.wrda","text":"mod initial wrda cca0 model least predictor variable, ... unused. consider character vector names mod$data consider addition. permutations list control values permutations returned function , number permutations required (default 999), permutation matrix row gives permuted indices. n_axes number eigenvalues select upon. sum n_axes eigenvalues taken criterion. Default \"full\" selection without dimension reduction n_axes. n_axes =1, selection first eigenvalue selection variables form optimal one-dimensional model. initial_model character specifying inside Condition(). Default: \"1\" (nothing, intercept ). Examples: \"region\" within-region analysis \"*B\" within analysis specified interaction factors B, region, , B data. factor2categories logical, default TRUE, convert factors categories (set(s) indicator values). FALSE, selection uses, fit factor divided number categories minus 1. test logical; default: TRUE. threshold_P significance level, adjustment testing multiplicity, addition variable model. PvalAdjustMethod method correction multiple testing  p.adjust, default \"holm\", improved version Bonferroni. max_step maximal number variables selected. verbose show progress, default: TRUE.","code":""},{"path":"/reference/FS.wrda.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Forward selection of predictor variables using wrda or cca0 — FS.wrda","text":"list three elements: final... selected variables  model_final process account selection process  .numeric(n_axes), variance returned table  sum n_axes eigenvalues current model  (variables far included).","code":""},{"path":"/reference/FS.wrda.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Forward selection of predictor variables using wrda or cca0 — FS.wrda","text":"selection basis additional fit (inertia) variable given variables already model. names consider may include transformations predictor variables, log(.), consider include factors factor2categories=FALSE. consider include factors, transformations give error default setting (factor2categories=TRUE).","code":""},{"path":"/reference/FS.wrda.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Forward selection of predictor variables using wrda or cca0 — FS.wrda","text":"","code":"data(\"dune_trait_env\")  # rownames are carried forward in results rownames(dune_trait_env$comm) <- dune_trait_env$comm$Sites abun <- dune_trait_env$comm[, -1] # must delete \"Sites\"  mod <- dc_CA(formulaEnv = abun ~ Moist + Mag,              formulaTraits = ~ F + R + N + L,              dataEnv = dune_trait_env$envir,              dataTraits = dune_trait_env$traits,              verbose = FALSE)  # selection of traits with environmental model of mod (~ Moist+Mag) out1 <- FS(mod, consider = c(\"F\", \"R\", \"N\", \"L\"),             select = \"traits\", verbose = FALSE)   names(out1) #> [1] \"finalWithOneExtra\" \"model_final\"       \"formula\"           #> [4] \"process\"           out1$finalWithOneExtra #>   df   variance  pval pvaladj #> F  1 0.28633635 0.001   0.004 #> N  1 0.24243384 0.001   0.003 #> L  1 0.03114819 0.137   0.274 out1$model_final #> Step 1: the CCA ordination of the transposed matrix with trait constraints, #>         useful in itself and also yielding CWMs of the orthonormalized traits for step 2. #> Call: cca0(formula = formulaTraits, response = tY, data = #> out0$data$dataTraits) #>  #> -- Model Summary -- #>  #>               Inertia Proportion Rank #> Total          2.3490     1.0000      #> Constrained    0.7657     0.3260    2 #> Unconstrained  1.5833     0.6740   19 #>  #> Inertia is scaled Chi-square #>  #> -- Eigenvalues -- #>  #> Eigenvalues for constrained axes: #>   CCA1   CCA2  #> 0.4576 0.3081  #>  #> Eigenvalues for unconstrained axes: #> CA1 CA2 CA3 CA4 CA5 CA6 CA7 CA8  #>  NA  NA  NA  NA  NA  NA  NA  NA  #> (Showing 8 of 19 unconstrained eigenvalues) #>  #> mean, sd, VIF and canonical coefficients with their optimistic [!] t-values: #>      Avg    SDS    VIF   Regr1   tval1 #> F 6.1126 1.6685 1.0575  0.6413  8.7440 #> N 5.1674 1.6303 1.0575 -0.1125 -1.5334 #>  #> Step 2: the RDA ordination of CWMs of the orthonormalized traits  #>         of step 1 with environmental constraints: #> Call: rda(formula = out1$CWMs_orthonormal_traits ~ Moist + Mag, data = #> out1$data$dataEnv) #>  #> -- Model Summary -- #>  #>               Inertia Proportion Rank #> Total          0.7657     1.0000      #> Constrained    0.5288     0.6906    2 #> Unconstrained  0.2370     0.3094    2 #>  #> Inertia is variance #>  #> -- Eigenvalues -- #>  #> Eigenvalues for constrained axes: #>    RDA1    RDA2  #> 0.31310 0.21567  #>  #> Eigenvalues for unconstrained axes: #>     PC1     PC2  #> 0.17114 0.06581  #>  #> mean, sd, VIF and canonical coefficients with their optimistic [!] t-values: #>        Avg    SDS    VIF  Regr1  tval1 #> Moist 2.90 1.7578 1.3001 0.4769 4.6192 #> MagBF 0.15 0.3571 1.4553 0.0075 0.0684 #> MagHF 0.25 0.4330 1.4214 0.0527 0.4879 #> MagNM 0.30 0.4583 1.4393 0.1948 1.7933 #>      Avg    SDS    VIF  Regr1   tval1 #> F 6.1126 1.6685 1.0575  0.726  4.9779 #> N 5.1674 1.6303 1.0575 -0.539 -3.6956 #>  #>                weighted variance #> total                      2.349 #> traits_explain             0.766 #> env_explain                0.967 #> constraintsTE              0.529 #> attr(,\"meaning\") #>                meaning                                                                 #> total          \"total inertia (= weighted variation)\"                                  #> traits_explain \"trait-constrained variation\"                                           #> env_explain    \"environment-constrained variation\"                                     #> constraintsTE  \"trait-constrained variation explained by the predictors in formulaEnv\"  # selection of environmental variables with trait model of mod (~ F + R + N + L) out2 <- FS(mod, consider =  c(\"A1\", \"Moist\", \"Mag\", \"Use\", \"Manure\"),             select= \"env\", verbose = FALSE)   names(out2) #> [1] \"finalWithOneExtra\" \"model_final\"       \"formula\"           #> [4] \"process\"           out2$finalWithOneExtra #>        df   variance  pval pvaladj #> Moist   1 0.33061402 0.001   0.008 #> Manure  1 0.20050625 0.001   0.007 #> A1      1 0.04503044 0.096   0.576 out2$model_final #> Step 1: the CCA ordination of the transposed matrix with trait constraints, #>         useful in itself and also yielding CWMs of the orthonormalized traits for step 2. #> Call: cca0(formula = formulaTraits, response = tY, data = #> out0$data$dataTraits) #>  #> -- Model Summary -- #>  #>               Inertia Proportion Rank #> Total          2.3490     1.0000      #> Constrained    0.8701     0.3704    4 #> Unconstrained  1.4789     0.6296   19 #>  #> Inertia is scaled Chi-square #>  #> -- Eigenvalues -- #>  #> Eigenvalues for constrained axes: #>   CCA1   CCA2   CCA3   CCA4  #> 0.4771 0.3122 0.0580 0.0228  #>  #> Eigenvalues for unconstrained axes: #> CA1 CA2 CA3 CA4 CA5 CA6 CA7 CA8  #>  NA  NA  NA  NA  NA  NA  NA  NA  #> (Showing 8 of 19 unconstrained eigenvalues) #>  #> mean, sd, VIF and canonical coefficients with their optimistic [!] t-values: #>      Avg    SDS    VIF   Regr1   tval1 #> F 6.1126 1.6685 1.1323  0.6048  8.2493 #> R 5.8061 1.1894 1.7564  0.0170  0.1865 #> N 5.1674 1.6303 1.7822 -0.1358 -1.4764 #> L 7.3839 0.8774 1.1378  0.1424  1.9382 #>  #> Step 2: the RDA ordination of CWMs of the orthonormalized traits  #>         of step 1 with environmental constraints: #> Call: rda(formula = out1$CWMs_orthonormal_traits ~ Moist + Manure + #> Condition(1), data = out1$data$dataEnv) #>  #> -- Model Summary -- #>  #>               Inertia Proportion Rank #> Total          0.8701     1.0000      #> Constrained    0.5311     0.6104    2 #> Unconstrained  0.3389     0.3896    4 #>  #> Inertia is variance #>  #> -- Eigenvalues -- #>  #> Eigenvalues for constrained axes: #>   RDA1   RDA2  #> 0.3331 0.1980  #>  #> Eigenvalues for unconstrained axes: #>     PC1     PC2     PC3     PC4  #> 0.18449 0.10693 0.02887 0.01864  #>  #> mean, sd, VIF and canonical coefficients with their optimistic [!] t-values: #>         Avg    SDS    VIF   Regr1   tval1 #> Moist  2.90 1.7578 1.0645  0.5519  6.2344 #> Manure 1.75 1.4448 1.0645 -0.0809 -0.9142 #>      Avg    SDS    VIF   Regr1   tval1 #> F 6.1126 1.6685 1.1323  0.7661  5.4523 #> R 5.8061 1.1894 1.7564 -0.1975 -1.1287 #> N 5.1674 1.6303 1.7822 -0.2553 -1.4483 #> L 7.3839 0.8774 1.1378  0.3167  2.2482 #>  #>                weighted variance #> total                      2.349 #> traits_explain             0.870 #> env_explain                0.751 #> constraintsTE              0.531 #> attr(,\"meaning\") #>                meaning                                                                 #> total          \"total inertia (= weighted variation)\"                                  #> traits_explain \"trait-constrained variation\"                                           #> env_explain    \"environment-constrained variation\"                                     #> constraintsTE  \"trait-constrained variation explained by the predictors in formulaEnv\"  # selection of environmental variables without a trait model  # i.e. with a single constraint mod3 <- cca0(mod$data$Y ~ Moist, data = mod$data$dataEnv) out3 <- FS(mod3, consider = c(\"A1\", \"Moist\", \"Mag\", \"Use\", \"Manure\"),             threshold_P = 0.05)  out3$finalWithOneExtra #>       df  variance  pval pvaladj #> Moist  1 0.4672020 0.001   0.008 #> MagNM  1 0.3088722 0.003   0.018 #> A1     1 0.1841344 0.024   0.144 out3$model_final #> Call: FUN(formula = formula2, data = mydata, traceonly = FALSE, cca_object #> = mod) #>  #> -- Model Summary -- #>  #>               Inertia Proportion Rank #> Total          2.3490     1.0000      #> Constrained    0.7761     0.3304    2 #> Unconstrained  1.5729     0.6696   19 #>  #> Inertia is scaled Chi-square #>  #> -- Eigenvalues -- #>  #> Eigenvalues for constrained axes: #>   CCA1   CCA2  #> 0.4803 0.2958  #>  #> Eigenvalues for unconstrained axes: #> CA1 CA2 CA3 CA4 CA5 CA6 CA7 CA8  #>  NA  NA  NA  NA  NA  NA  NA  NA  #> (Showing 8 of 19 unconstrained eigenvalues) #>  #> mean, sd, VIF and canonical coefficients with their optimistic [!] t-values: #>       Avg    SDS    VIF   Regr1   tval1 #> Moist 2.9 0.3931 1.1374 -0.5995 -9.0496 #> MagNM 0.3 0.1025 1.1374 -0.1970 -2.9746 #>   # selection of traits without an environmental model  #                         i.e. with a single constraint tY <- t(mod$data$Y)  mod4 <- cca0(tY ~ L, data = mod$data$dataTraits)  names(mod$data$dataTraits) #>  [1] \"Species\"      \"Species_abbr\" \"SLA\"          \"Height\"       \"LDMC\"         #>  [6] \"Seedmass\"     \"Lifespan\"     \"F\"            \"R\"            \"N\"            #> [11] \"L\"            out4 <- FS(mod4,             consider =  c(\"SLA\", \"Height\", \"LDMC\", \"Seedmass\", \"Lifespan\",                           \"F\", \"R\", \"N\", \"L\"))  out4$finalWithOneExtra #>          df  variance  pval pvaladj #> F         1 0.4536777 0.001   0.010 #> N         1 0.3120442 0.001   0.009 #> Seedmass  1 0.1060672 0.047   0.376 out4$model_final #> Call: FUN(formula = formula2, data = mydata, traceonly = FALSE, cca_object #> = mod) #>  #> -- Model Summary -- #>  #>               Inertia Proportion Rank #> Total          2.3490     1.0000      #> Constrained    0.7657     0.3260    2 #> Unconstrained  1.5833     0.6740   19 #>  #> Inertia is scaled Chi-square #>  #> -- Eigenvalues -- #>  #> Eigenvalues for constrained axes: #>   CCA1   CCA2  #> 0.4576 0.3081  #>  #> Eigenvalues for unconstrained axes: #> CA1 CA2 CA3 CA4 CA5 CA6 CA7 CA8  #>  NA  NA  NA  NA  NA  NA  NA  NA  #> (Showing 8 of 19 unconstrained eigenvalues) #>  #> mean, sd, VIF and canonical coefficients with their optimistic [!] t-values: #>      Avg    SDS    VIF   Regr1   tval1 #> F 6.1126 1.6685 1.0575  0.6413  8.7440 #> N 5.1674 1.6303 1.0575 -0.1125 -1.5334 #>"},{"path":"/reference/anova.cca0.html","id":null,"dir":"Reference","previous_headings":"","what":"Permutation Test for canonical correspondence analysis — anova.cca0","title":"Permutation Test for canonical correspondence analysis — anova.cca0","text":"anova.cca0 performs residual predictor permutation cca0, robust differences weights (ter Braak & te Beest, 2022). arguments function similar anova.cca, restricted.","code":""},{"path":"/reference/anova.cca0.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Permutation Test for canonical correspondence analysis — anova.cca0","text":"","code":"# S3 method for class 'cca0' anova(   object,   ...,   permutations = 999,   by = c(\"omnibus\", \"axis\"),   n_axes = \"all\" )"},{"path":"/reference/anova.cca0.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Permutation Test for canonical correspondence analysis — anova.cca0","text":"object object dc_CA. ... unused. permutations list control values permutations returned function , number permutations required (default 999), permutation matrix row gives permuted indices. character \"axis\" sets test statistic first eigenvalue RDA model. Default: NULL sets test statistic weighted variance fitted predictors (=sum constrained eigenvalues). default quicker computationally avoids computation svd permuted data sets. n_axes number axes used test statistic (default: \"\"). Example, test statistic sum first two eigenvalues, n_axes=2. numeric n_axes model ~X + Condition(Z), residuals X respect Z permuted test statistic equal sum first n_axes eigenvalues fitted Y model Y ~ X + Z, Y response model. default \"\", test statistic eigenvalues model Y ~ X|Z, .e. effects X adjustment effects Y Z. = \"axis\", setting n_axes ignored.","code":""},{"path":"/reference/anova.cca0.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Permutation Test for canonical correspondence analysis — anova.cca0","text":"list two elements names table eigenvalues. table anova.cca eigenvalues gives CCA eigenvalues.","code":""},{"path":"/reference/anova.cca0.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Permutation Test for canonical correspondence analysis — anova.cca0","text":"algorithm based published R-code residual predictor permutation canonical correspondence analysis (ter Braak & te Beest, 2022), using QR-decomposition instead ad-hoc least-squares functions. Note anova.cca0 much slower anova.cca. anova.cca implemented lower level language, difficult see implements. simulations (without Condition() ) anova.cca gives results similar residual predictor permutation (RPP), , = \"axis\", can conservative less powerful RPP (tested vegan 2.6-8).","code":""},{"path":"/reference/anova.cca0.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Permutation Test for canonical correspondence analysis — anova.cca0","text":"ter Braak, C.J.F. & te Beest, D.E. (2022). Testing environmental effects taxonomic composition canonical correspondence analysis: alternative permutation tests equal. Environmental Ecological Statistics. 29 (4), 849-868.  doi:10.1007/s10651-022-00545-4","code":""},{"path":"/reference/anova.cca0.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Permutation Test for canonical correspondence analysis — anova.cca0","text":"","code":"data(\"dune_trait_env\")  # rownames are carried forward in results rownames(dune_trait_env$comm) <- dune_trait_env$comm$Sites abun <- dune_trait_env$comm[, -1]  # must delete \"Sites\"  mod <- cca0(formula = abun ~ A1 + Moist + Mag + Use + Manure,             data = dune_trait_env$envir)  mod # Proportions equal to those Canoco 5.15 #> Call: cca0(formula = abun ~ A1 + Moist + Mag + Use + Manure, data = #> dune_trait_env$envir) #>  #> -- Model Summary -- #>  #>               Inertia Proportion Rank #> Total          2.1866     1.0000      #> Constrained    1.2511     0.5722    7 #> Unconstrained  0.9355     0.4278   19 #>  #> Inertia is scaled Chi-square #>  #> -- Eigenvalues -- #>  #> Eigenvalues for constrained axes: #>   CCA1   CCA2   CCA3   CCA4   CCA5   CCA6   CCA7  #> 0.4759 0.3241 0.1764 0.1313 0.0690 0.0412 0.0333  #>  #> Eigenvalues for unconstrained axes: #> CA1 CA2 CA3 CA4 CA5 CA6 CA7 CA8  #>  NA  NA  NA  NA  NA  NA  NA  NA  #> (Showing 8 of 19 unconstrained eigenvalues) #>  #> mean, sd, VIF and canonical coefficients with their optimistic [!] t-values: #>           Avg    SDS    VIF   Regr1   tval1 #> A1     4.6363 1.8096 1.5022 -0.0962 -1.2237 #> Moist  2.7604 1.7163 1.7279 -0.5275 -6.2574 #> MagBF  0.1773 0.3819 4.7947  0.0107  0.0758 #> MagHF  0.3179 0.4657 2.9965  0.1034  0.9314 #> MagNM  0.2029 0.4021 7.1714 -0.1599 -0.9308 #> Use    1.9042 0.7523 1.6739 -0.1310 -1.5794 #> Manure 1.9521 1.3534 7.8029 -0.0354 -0.1975 #>   scores(mod, which_cor = c(\"A1\", \"X_lot\"), display = \"cor\") #>            wRDA1       wRDA2 #> A1    -0.5433670  0.15530408 #> X_lot -0.1808011 -0.08064616 #> attr(,\"meaning\") #> [1] \"inter set correlation, correlation between environmental variables and the sites scores (CWMs)\"  set.seed(123) anova(mod) #> $table #> Permutation test for canonical correspondence analysis #> Model: cca0(formula = abun ~ A1 + Moist + Mag + Use + Manure, data = dune_trait_env$envir)  #> Residualized predictor permutation #> Permutation: free #> Number of permutations: 999 #>  #>          df ChiSquare      R2      F Pr(>F)     #> cca       7   1.25113 0.57218 2.2927  0.001 *** #> Residual 12   0.93548                           #> --- #> Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1 #>  #> $eigenvalues #>       cca1       cca2       cca3       cca4       cca5       cca6       cca7  #> 0.47593373 0.32414453 0.17637629 0.13125103 0.06899011 0.04116257 0.03326681  #>  anova(mod, by = \"axis\") #> $table #> Permutation test for canonical correspondence analysis #> Model: cca0(formula = abun ~ A1 + Moist + Mag + Use + Manure, data = dune_trait_env$envir)  #> Residualized predictor permutation #> Permutation: free #> Number of permutations: 999 #>  #>          df ChiSquare       R2      F Pr(>F)    #> cca1      1   0.47593 0.217659 6.1051  0.002 ** #> cca2      1   0.32414 0.148241 4.1580  0.018 *  #> cca3      1   0.17638 0.080662 2.2625  0.236    #> cca4      1   0.13125 0.060025 1.6836  0.404    #> cca5      1   0.06899 0.031551 0.8850  0.951    #> cca6      1   0.04116 0.018825 0.5280  0.996    #> cca7      1   0.03327 0.015214 0.4267  0.996    #> Residual 12   0.93548                           #> --- #> Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1 #>  #> $eigenvalues #>       cca1       cca2       cca3       cca4       cca5       cca6       cca7  #> 0.47593373 0.32414453 0.17637629 0.13125103 0.06899011 0.04116257 0.03326681  #>   mod2 <- vegan::cca(abun ~ A1 + Moist + Mag + Use + Manure,                    data = dune_trait_env$envir) anova(mod2, by = \"axis\") #> Permutation test for cca under reduced model #> Forward tests for axes #> Permutation: free #> Number of permutations: 999 #>  #> Model: cca(formula = abun ~ A1 + Moist + Mag + Use + Manure, data = dune_trait_env$envir) #>          Df ChiSquare      F Pr(>F)     #> CCA1      1   0.47593 6.1051  0.001 *** #> CCA2      1   0.32414 4.1580  0.037 *   #> CCA3      1   0.17638 2.2625  0.724     #> CCA4      1   0.13125 1.6836  0.987     #> CCA5      1   0.06899 0.8850  1.000     #> CCA6      1   0.04116 0.5280            #> CCA7      1   0.03327 0.4267            #> Residual 12   0.93548                   #> --- #> Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1  dat <- dune_trait_env$envir dat$Mag <- \"SF\" predict(mod, type = \"lc\", newdata = dat) #>              wRDA1     wRDA2       wRDA3       wRDA4       wRDA5       wRDA6 #> Site_1   0.6904890 0.2738131  0.85706483  0.21494213  0.04961136  0.72100459 #> Site_2   0.7086329 0.2734695  0.33481865 -1.07270103 -1.35928061  0.53160107 #> Site_3   0.2244798 0.5945085  0.60570803  0.44083874  0.37245365  0.46727185 #> Site_4   0.2308792 0.5789014  0.63318079  0.42798545  0.35582702  0.47363638 #> Site_5   0.7391771 0.6853586 -0.03558872 -0.62800472 -0.21511036 -0.01408255 #> Site_6   0.6574380 0.3983263  0.11503656 -0.96987465 -1.22626765  0.48068489 #> Site_7   0.5122323 0.2441261  0.29326645 -0.55866996 -1.39165267  1.01605565 #> Site_8  -1.0574335 0.8089811  0.55158630 -0.24633521 -0.86510811  0.29389272 #> Site_9  -0.1730258 0.4845439  0.99593856 -1.55170714 -1.18971277 -0.39582562 #> Site_10  0.5926090 0.2489378  0.78436035 -1.66931462 -1.40310518 -0.05383772 #> Site_11  0.5303763 0.2437824 -0.22897973 -1.84631313 -2.80054465  0.82665213 #> Site_12 -0.5486085 0.8921994  0.18514902 -0.67778374 -0.75653943 -0.08957766 #> Site_13 -0.9628957 1.0647992  0.45590655  0.06982812  0.11279594 -0.18814568 #> Site_14 -1.2893919 1.4405532 -1.34442983 -1.65724140 -2.30506793 -0.24797572 #> Site_15 -1.2204515 1.7587997 -1.55000063 -1.28966488 -1.26065740 -0.75547220 #> Site_16 -1.1534240 1.0430876  0.13949487 -0.05353574 -0.61570879  0.19842488 #> Site_17  0.5792832 0.3033908  0.42708259 -2.26814966 -2.04935800 -0.17081531 #> Site_18  0.9109057 0.3104445  0.10151139 -2.22412702 -2.02304124 -0.05073754 #> Site_19 -0.5115748 0.5163361  0.99170477 -2.20741811 -1.87890897 -0.62651646 #> Site_20 -0.4987760 0.4851219  1.04665030 -2.23312471 -1.91216221 -0.61378742 #>               wRDA7 #> Site_1  -0.21001080 #> Site_2  -0.96564817 #> Site_3  -0.19205750 #> Site_4  -0.18164028 #> Site_5  -1.37467944 #> Site_6  -1.04898590 #> Site_7  -0.43402001 #> Site_8   0.11698515 #> Site_9  -0.92255561 #> Site_10 -1.22930984 #> Site_11 -1.18965737 #> Site_12 -0.68260950 #> Site_13 -0.18787396 #> Site_14 -1.43836815 #> Site_15 -1.78489613 #> Site_16 -0.03927309 #> Site_17 -1.64358878 #> Site_18 -1.88030362 #> Site_19 -1.08970250 #> Site_20 -1.06886806"},{"path":"/reference/anova.dcca.html","id":null,"dir":"Reference","previous_headings":"","what":"Community- and Species-Level Permutation Test in Double Constrained Correspondence Analysis (dc-CA) — anova.dcca","title":"Community- and Species-Level Permutation Test in Double Constrained Correspondence Analysis (dc-CA) — anova.dcca","text":"anova.dcca performs community- species-level permutation tests dc-CA combines 'max test', takes maximum P-values. function arguments similar (restrictive ) anova.cca.","code":""},{"path":"/reference/anova.dcca.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Community- and Species-Level Permutation Test in Double Constrained Correspondence Analysis (dc-CA) — anova.dcca","text":"","code":"# S3 method for class 'dcca' anova(   object,   ...,   rpp = TRUE,   permutations = 999,   by = c(\"omnibus\", \"axis\"),   n_axes = \"all\" )"},{"path":"/reference/anova.dcca.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Community- and Species-Level Permutation Test in Double Constrained Correspondence Analysis (dc-CA) — anova.dcca","text":"object object dc_CA. ... unused. rpp Logical indicating residual predictor permutation (default TRUE). FALSE, residual response permutation used. permutations list control values permutations species sites (species first, sites second, traits environment) returned function , number permutations required (default 999, two-vector number species-level test first sites-level second), list two permutation matrices (, species first, sites second) row gives permuted indices. character \"axis\" performs series tests, one axis, eigenvalue axis test statistic. Default: NULL sets test statistic inertia (sum double constrained eigenvalues; named constraintsTE inertia element dc_CA. interpretation inertia , species-level, environmentally constrained inertia explained traits (without trait covariates) , community-level, trait-constrained inertia explained environmental predictors (without covariates). default (NULL) computationally quicker avoids computation svd permuted data sets. n_axes number axes used test statistic (default: \"\"). Example, test statistic sum first two eigenvalues, n_axes=2. numeric n_axes model ~X + Condition(Z), residuals X respect Z permuted test statistic equal sum first n_axes eigenvalues fitted Y model Y ~ X + Z, Y response model. default \"\", test statistic eigenvalues model Y ~ X|Z, .e. effects X adjustment effects Y Z. = \"axis\", setting n_axes ignored.","code":""},{"path":"/reference/anova.dcca.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Community- and Species-Level Permutation Test in Double Constrained Correspondence Analysis (dc-CA) — anova.dcca","text":"list 3 structures anova.cca. elements c(\"species\", \"sites\", \"maxP\")","code":""},{"path":"/reference/anova.dcca.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Community- and Species-Level Permutation Test in Double Constrained Correspondence Analysis (dc-CA) — anova.dcca","text":"general case varying site abundance totals (divideBySiteTotals = FALSE) community-level test species-level test use residualized predictor permutation (ter Braak 2022), ensure anova.dcca robust differences species site total abundance response (ter Braak & te Beest, 2022). community-level test uses anova_sites. species-level test, anova_species used. equal site weights, obtained divide..site.total = TRUE, community-level test obtained applying anova object$RDAonEnv using anova.cca. performs residualized response permutation performs equal residualized predictor permutation equi-weight case. function anova.cca implemented C therefore factor 20 quicker native R-code used anova_sites. n_axes argument new, can considered experimental.","code":""},{"path":"/reference/anova.dcca.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Community- and Species-Level Permutation Test in Double Constrained Correspondence Analysis (dc-CA) — anova.dcca","text":"ter Braak, C.J.F. & te Beest, D.E. 2022. Testing environmental effects taxonomic composition canonical correspondence analysis: alternative permutation tests equal. Environmental Ecological Statistics. 29 (4), 849-868. doi:10.1007/s10651-022-00545-4 ter Braak, C.J.F. (2022) Predictor versus response permutation significance testing weighted regression redundancy analysis. Journal statistical computation simulation, 92, 2041-2059. doi:10.1080/00949655.2021.2019256","code":""},{"path":"/reference/anova.dcca.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Community- and Species-Level Permutation Test in Double Constrained Correspondence Analysis (dc-CA) — anova.dcca","text":"","code":"data(\"dune_trait_env\")  # rownames are carried forward in results rownames(dune_trait_env$comm) <- dune_trait_env$comm$Sites  mod <- dc_CA(formulaEnv = ~ A1 + Moist + Mag + Use + Manure,              formulaTraits = ~ SLA + Height + LDMC + Seedmass + Lifespan,              response = dune_trait_env$comm[, -1],  # must delete \"Sites\"              dataEnv = dune_trait_env$envir,              dataTraits = dune_trait_env$traits,              verbose = FALSE) anova(mod) #> $species #> Species-level permutation test using dc-CA #> Model: dc_CA(formulaEnv = ~A1 + Moist + Mag + Use + Manure, formulaTraits = ~SLA + Height + LDMC + Seedmass + Lifespan, response = dune_trait_env$comm[, -1], dataEnv = dune_trait_env$envir, dataTraits = dune_trait_env$traits, verbose = FALSE)  #> Residualized predictor permutation #>  #>          df ChiSquare     R2      F Pr(>F)   #> dcCA      5   0.44542 0.3367 2.2335  0.019 * #> Residual 22   0.87749                        #> --- #> Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1 #>  #> $sites #>          Df ChiSquare      R2      F Pr(>F)     #> dcCA1     7   0.44542 0.65733 3.2885  0.001 *** #> Residual 12   0.23220                           #> --- #> Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1 #>  #> $maxP #> Max test combining the community- and species- level tests  #> Model: dc_CA(formulaEnv = ~A1 + Moist + Mag + Use + Manure, formulaTraits = ~SLA + Height + LDMC + Seedmass + Lifespan, response = dune_trait_env$comm[, -1], dataEnv = dune_trait_env$envir, dataTraits = dune_trait_env$traits, verbose = FALSE)  #>  #> Taken from the species-level test: #> Residualized predictor permutation #> Permutation: free #> Number of permutations: 999 #>  #>          df ChiSquare     R2      F Pr(>F)   #> dcCA      5   0.44542 0.3367 2.2335  0.019 * #> Residual 22   0.87749                        #> --- #> Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1 #>   a_species <- anova_species(mod) a_species #> $table #> Species-level permutation test using dc-CA #> Model: dc_CA(formulaEnv = ~A1 + Moist + Mag + Use + Manure, formulaTraits = ~SLA + Height + LDMC + Seedmass + Lifespan, response = dune_trait_env$comm[, -1], dataEnv = dune_trait_env$envir, dataTraits = dune_trait_env$traits, verbose = FALSE)  #> Residualized predictor permutation #> Permutation: free #> Number of permutations: 999 #>  #>          df ChiSquare     R2      F Pr(>F)   #> dcCA      5   0.44542 0.3367 2.2335  0.012 * #> Residual 22   0.87749                        #> --- #> Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1 #>  #> $eigenvalues #>      dcCA1      dcCA2      dcCA3      dcCA4      dcCA5  #> 0.23680387 0.10903220 0.05933626 0.03791909 0.00232876  #>  # anova_species can be used for manual forward selection of # trait variables, as done for environmental variables in the demo  # dune_FS_dcCA.r, based on the first eigenvalue and its significance # and adding the first axis of the constrained species scores from mod to  # the Condition of a new mod. (eig1_and_pval <- c(eig = a_species$eig[1], pval = a_species$table$`Pr(>F)`[1])) #> eig.dcCA1      pval  #> 0.2368039 0.0120000  a_species$eig #>      dcCA1      dcCA2      dcCA3      dcCA4      dcCA5  #> 0.23680387 0.10903220 0.05933626 0.03791909 0.00232876  anova_sites(mod) #> $table #> Community-level permutation test using dc-CA #> Model: dc_CA(formulaEnv = ~A1 + Moist + Mag + Use + Manure, formulaTraits = ~SLA + Height + LDMC + Seedmass + Lifespan, response = dune_trait_env$comm[, -1], dataEnv = dune_trait_env$envir, dataTraits = dune_trait_env$traits, verbose = FALSE)  #> Residualized predictor permutation #> Permutation: free #> Number of permutations: 999 #>  #>          df ChiSquare      R2      F Pr(>F)     #> dcCA      7   0.44542 0.65733 3.2885  0.001 *** #> Residual 12   0.23220                           #> --- #> Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1 #>  #> $eigenvalues #>      dcCA1      dcCA2      dcCA3      dcCA4      dcCA5  #> 0.23680387 0.10903220 0.05933626 0.03791909 0.00232876  #>"},{"path":"/reference/anova.wrda.html","id":null,"dir":"Reference","previous_headings":"","what":"Permutation Test for weighted redundancy analysis — anova.wrda","title":"Permutation Test for weighted redundancy analysis — anova.wrda","text":"anova.wrda performs residual predictor permutation weighted redundancy analysis (wRDA), robust differences weights (ter Braak, 2022). arguments function similar anova.cca, restricted.","code":""},{"path":"/reference/anova.wrda.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Permutation Test for weighted redundancy analysis — anova.wrda","text":"","code":"# S3 method for class 'wrda' anova(   object,   ...,   permutations = 999,   by = c(\"omnibus\", \"axis\"),   n_axes = \"all\" )"},{"path":"/reference/anova.wrda.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Permutation Test for weighted redundancy analysis — anova.wrda","text":"object object dc_CA. ... unused. permutations list control values permutations returned function , number permutations required (default 999), permutation matrix row gives permuted indices. character \"axis\" sets test statistic first eigenvalue RDA model. Default: NULL sets test statistic weighted variance fitted predictors (=sum constrained eigenvalues). default quicker computationally avoids computation svd permuted data sets. n_axes number axes used test statistic (default: \"\"). Example, test statistic sum first two eigenvalues, n_axes=2. numeric n_axes model ~X + Condition(Z), residuals X respect Z permuted test statistic equal sum first n_axes eigenvalues fitted Y model Y ~ X + Z, Y response model. default \"\", test statistic eigenvalues model Y ~ X|Z, .e. effects X adjustment effects Y Z. = \"axis\", setting n_axes ignored.","code":""},{"path":"/reference/anova.wrda.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Permutation Test for weighted redundancy analysis — anova.wrda","text":"list two elements names table eigenvalues. table anova.cca eigenvalues gives wrda eigenvalues.","code":""},{"path":"/reference/anova.wrda.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Permutation Test for weighted redundancy analysis — anova.wrda","text":"algorithm based published R-code residual predictor permutation weighted redundancy analysis (ter Braak, 2022), using QR-decomposition instead ad-hoc least-squares functions.","code":""},{"path":"/reference/anova.wrda.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Permutation Test for weighted redundancy analysis — anova.wrda","text":"ter Braak, C.J.F. (2022) Predictor versus response permutation significance testing weighted regression redundancy analysis. Journal statistical computation simulation, 92, 2041-2059. doi:10.1080/00949655.2021.2019256","code":""},{"path":"/reference/anova.wrda.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Permutation Test for weighted redundancy analysis — anova.wrda","text":"","code":"data(\"dune_trait_env\")  # rownames are carried forward in results rownames(dune_trait_env$comm) <- dune_trait_env$comm$Sites response <- dune_trait_env$comm[, -1]  # must delete \"Sites\"  w <- rep(1, 20)  w[1:10] <- 8  w[17:20] <- 0.5  object <- wrda(formula = response ~ A1 + Moist + Mag + Use + Condition(Manure),                data = dune_trait_env$envir,                 weights = w) object # Proportions equal to those Canoco 5.15 #> Call: wrda(formula = response ~ A1 + Moist + Mag + Use + Condition(Manure), #> data = dune_trait_env$envir, weights = w) #>  #> -- Model Summary -- #>  #>               Inertia Proportion Rank #> Total         65.7007     1.0000      #> Conditional    7.3839     0.1124    2 #> Constrained   36.4952     0.5555    6 #> Unconstrained 21.8217     0.3321   19 #>  #> Inertia is weighted variance #>  #> -- Eigenvalues -- #>  #> Eigenvalues for constrained axes: #>  wRDA1  wRDA2  wRDA3  wRDA4  wRDA5  wRDA6  #> 18.133  8.233  4.047  3.155  2.238  0.689  #>  #> Eigenvalues for unconstrained axes: #> wPCA1 wPCA2 wPCA3 wPCA4 wPCA5 wPCA6 wPCA7 wPCA8  #>    NA    NA    NA    NA    NA    NA    NA    NA  #> (Showing 8 of 19 unconstrained eigenvalues) #>  #> mean, sd, VIF and canonical coefficients with their optimistic [!] t-values: #>           Avg    SDS     VIF   Regr1   tval1 #> Manure 2.4659 1.2056 10.5656 -0.2010 -0.1344 #> A1     4.1466 1.3786  1.4841  0.1013  0.1807 #> Moist  2.1761 1.4762  1.4883 -4.1077 -7.3195 #> MagBF  0.1932 0.3948  6.8216  0.7873  0.6553 #> MagHF  0.4545 0.4979  5.8054  1.8392  1.6594 #> MagNM  0.0455 0.2083  4.8878  0.1327  0.1304 #> Use    1.9205 0.7107  2.6787  0.2101  0.2791 #>   mod_scores <- scores(object, display = \"all\") scores(object, which_cor = c(\"A1\", \"X_lot\"), display = \"cor\") #>            wRDA1      wRDA2 #> A1    -0.2365172 -0.3510007 #> X_lot -0.4987793  0.4250562 #> attr(,\"meaning\") #> [1] \"inter set correlation, correlation between environmental variables and the sites scores (CWMs)\" anova(object) #> $table #> Permutation test for weighted reduncancy analysis #> Model: wrda(formula = response ~ A1 + Moist + Mag + Use + Condition(Manure), data = dune_trait_env$envir, weights = w)  #> Residualized predictor permutation #> Permutation: free #> Number of permutations: 999 #>  #>          df Variance      R2      F Pr(>F)    #> wRDA      6   36.495 0.62581 3.3449  0.006 ** #> Residual 12   21.822                          #> --- #> Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1 #>  #> $eigenvalues #>      wRDA1      wRDA2      wRDA3      wRDA4      wRDA5      wRDA6  #> 18.1328543  8.2332883  4.0467247  3.1546579  2.2383295  0.6893052  #>"},{"path":"/reference/anova_sites.html","id":null,"dir":"Reference","previous_headings":"","what":"Utility function: community-level permutation test in Double Constrained Correspondence Analysis (dc-CA) — anova_sites","title":"Utility function: community-level permutation test in Double Constrained Correspondence Analysis (dc-CA) — anova_sites","text":"anova_sites performs community-level permutation test dc-CA site weights vary. test uses residual predictor permutation (ter Braak 2022), robust differences site total abundance response dc_CA (ter Braak & te Beest, 2022). arguments function similar anova.cca, restricted. equal site-totals dc_CA, anova(object$RDAonEnv) much faster.","code":""},{"path":"/reference/anova_sites.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Utility function: community-level permutation test in Double Constrained Correspondence Analysis (dc-CA) — anova_sites","text":"","code":"anova_sites(object, permutations = 999, rpp = TRUE, n_axes = \"all\", by = NULL)"},{"path":"/reference/anova_sites.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Utility function: community-level permutation test in Double Constrained Correspondence Analysis (dc-CA) — anova_sites","text":"object object dc_CA. permutations list control values permutations returned function , number permutations required (default 999), permutation matrix row gives permuted indices. rpp Logical indicating residual predictor permutation (default TRUE). FALSE, residual response permutation used. n_axes number axes used test statistic (default: \"\"). Example, test statistic sum first two eigenvalues, n_axes=2. numeric n_axes model ~X + Condition(Z), residuals X respect Z permuted test statistic equal sum first n_axes eigenvalues fitted Y model Y ~ X + Z, Y response model. default \"\", test statistic eigenvalues model Y ~ X|Z, .e. effects X adjustment effects Y Z. = \"axis\", setting n_axes ignored. character \"axis\" sets test statistic first eigenvalue dc-CA model. Default: NULL sets test statistic inertia (sum double constrained eigenvalues; named  constraintsTE inertia element dc_CA). trait constrained inertia explained environmental predictors (without covariates), equal environmentally-constrained inertia explained traits (without trait covariates). default quicker computationally avoids computation svd permuted data sets.","code":""},{"path":"/reference/anova_sites.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Utility function: community-level permutation test in Double Constrained Correspondence Analysis (dc-CA) — anova_sites","text":"list two elements names table eigenvalues. table anova.cca eigenvalues gives dc-CA eigenvalues.","code":""},{"path":"/reference/anova_sites.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Utility function: community-level permutation test in Double Constrained Correspondence Analysis (dc-CA) — anova_sites","text":"algorithm analogous anova.wrda. function used anova.dcca.","code":""},{"path":"/reference/anova_sites.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Utility function: community-level permutation test in Double Constrained Correspondence Analysis (dc-CA) — anova_sites","text":"ter Braak, C.J.F. & te Beest, D.E. 2022. Testing environmental effects taxonomic composition canonical correspondence analysis: alternative permutation tests equal. Environmental Ecological Statistics. 29 (4), 849-868. doi:10.1007/s10651-022-00545-4 ter Braak, C.J.F. (2022) Predictor versus response permutation significance testing weighted regression redundancy analysis. Journal statistical computation simulation, 92, 2041-2059. doi:10.1080/00949655.2021.2019256","code":""},{"path":"/reference/anova_sites.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Utility function: community-level permutation test in Double Constrained Correspondence Analysis (dc-CA) — anova_sites","text":"","code":"data(\"dune_trait_env\")  # rownames are carried forward in results rownames(dune_trait_env$comm) <- dune_trait_env$comm$Sites  mod <- dc_CA(formulaEnv = ~ A1 + Moist + Mag + Use + Manure,              formulaTraits = ~ SLA + Height + LDMC + Seedmass + Lifespan,              response = dune_trait_env$comm[, -1],  # must delete \"Sites\"              dataEnv = dune_trait_env$envir,              dataTraits = dune_trait_env$traits,              verbose = FALSE) anova(mod) #> $species #> Species-level permutation test using dc-CA #> Model: dc_CA(formulaEnv = ~A1 + Moist + Mag + Use + Manure, formulaTraits = ~SLA + Height + LDMC + Seedmass + Lifespan, response = dune_trait_env$comm[, -1], dataEnv = dune_trait_env$envir, dataTraits = dune_trait_env$traits, verbose = FALSE)  #> Residualized predictor permutation #>  #>          df ChiSquare     R2      F Pr(>F)   #> dcCA      5   0.44542 0.3367 2.2335  0.012 * #> Residual 22   0.87749                        #> --- #> Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1 #>  #> $sites #>          Df ChiSquare      R2      F Pr(>F)     #> dcCA1     7   0.44542 0.65733 3.2885  0.001 *** #> Residual 12   0.23220                           #> --- #> Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1 #>  #> $maxP #> Max test combining the community- and species- level tests  #> Model: dc_CA(formulaEnv = ~A1 + Moist + Mag + Use + Manure, formulaTraits = ~SLA + Height + LDMC + Seedmass + Lifespan, response = dune_trait_env$comm[, -1], dataEnv = dune_trait_env$envir, dataTraits = dune_trait_env$traits, verbose = FALSE)  #>  #> Taken from the species-level test: #> Residualized predictor permutation #> Permutation: free #> Number of permutations: 999 #>  #>          df ChiSquare     R2      F Pr(>F)   #> dcCA      5   0.44542 0.3367 2.2335  0.012 * #> Residual 22   0.87749                        #> --- #> Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1 #>   a_species <- anova_species(mod) a_species #> $table #> Species-level permutation test using dc-CA #> Model: dc_CA(formulaEnv = ~A1 + Moist + Mag + Use + Manure, formulaTraits = ~SLA + Height + LDMC + Seedmass + Lifespan, response = dune_trait_env$comm[, -1], dataEnv = dune_trait_env$envir, dataTraits = dune_trait_env$traits, verbose = FALSE)  #> Residualized predictor permutation #> Permutation: free #> Number of permutations: 999 #>  #>          df ChiSquare     R2      F Pr(>F)   #> dcCA      5   0.44542 0.3367 2.2335  0.011 * #> Residual 22   0.87749                        #> --- #> Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1 #>  #> $eigenvalues #>      dcCA1      dcCA2      dcCA3      dcCA4      dcCA5  #> 0.23680387 0.10903220 0.05933626 0.03791909 0.00232876  #>  # anova_species can be used for manual forward selection of # trait variables, as done for environmental variables in the demo  # dune_FS_dcCA.r, based on the first eigenvalue and its significance # and adding the first axis of the constrained species scores from mod to  # the Condition of a new mod. (eig1_and_pval <- c(eig = a_species$eig[1], pval = a_species$table$`Pr(>F)`[1])) #> eig.dcCA1      pval  #> 0.2368039 0.0110000  a_species$eig #>      dcCA1      dcCA2      dcCA3      dcCA4      dcCA5  #> 0.23680387 0.10903220 0.05933626 0.03791909 0.00232876  anova_sites(mod) #> $table #> Community-level permutation test using dc-CA #> Model: dc_CA(formulaEnv = ~A1 + Moist + Mag + Use + Manure, formulaTraits = ~SLA + Height + LDMC + Seedmass + Lifespan, response = dune_trait_env$comm[, -1], dataEnv = dune_trait_env$envir, dataTraits = dune_trait_env$traits, verbose = FALSE)  #> Residualized predictor permutation #> Permutation: free #> Number of permutations: 999 #>  #>          df ChiSquare      R2      F Pr(>F)     #> dcCA      7   0.44542 0.65733 3.2885  0.001 *** #> Residual 12   0.23220                           #> --- #> Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1 #>  #> $eigenvalues #>      dcCA1      dcCA2      dcCA3      dcCA4      dcCA5  #> 0.23680387 0.10903220 0.05933626 0.03791909 0.00232876  #>"},{"path":"/reference/anova_species.html","id":null,"dir":"Reference","previous_headings":"","what":"Utility function: Species-level Permutation Test in Double Constrained Correspondence Analysis (dc-CA) — anova_species","title":"Utility function: Species-level Permutation Test in Double Constrained Correspondence Analysis (dc-CA) — anova_species","text":"anova_species performs species-level permutation test dc-CA part anova.dcca. test uses residual predictor permutation (ter Braak 2022), robust differences species total abundance response dc_CA (ter Braak & te Beest, 2022). arguments function similar anova.cca, restrictive.","code":""},{"path":"/reference/anova_species.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Utility function: Species-level Permutation Test in Double Constrained Correspondence Analysis (dc-CA) — anova_species","text":"","code":"anova_species(   object,   permutations = 999,   rpp = TRUE,   n_axes = \"all\",   by = NULL )"},{"path":"/reference/anova_species.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Utility function: Species-level Permutation Test in Double Constrained Correspondence Analysis (dc-CA) — anova_species","text":"object object dc_CA. permutations list control values permutations returned function , number permutations required (default 999) permutation matrix row gives permuted indices. rpp Logical indicating residual predictor permutation (default TRUE). FALSE, residual response permutation used. n_axes number axes used test statistic (default: \"\"). Example, test statistic sum first two eigenvalues, n_axes=2. numeric n_axes model ~X + Condition(Z), residuals X respect Z permuted test statistic equal sum first n_axes eigenvalues fitted Y model Y ~ X + Z, Y response model. default \"\", test statistic eigenvalues model Y ~ X|Z, .e. effects X adjustment effects Y Z. = \"axis\", setting n_axes ignored. character \"axis\" sets test statistic first eigenvalue dc-CA model. Default: NULL set test statistic inertia (sum double constrained eigenvalues; named constraintsTE inertia element dc_CA). environmentally constrained inertia explained traits (without trait covariates), equal trait-constrained inertia explained environmental predictors (without covariates). default quicker computationally avoids computation svd permuted data sets.","code":""},{"path":"/reference/anova_species.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Utility function: Species-level Permutation Test in Double Constrained Correspondence Analysis (dc-CA) — anova_species","text":"list two elements names table eigenvalues. table anova.cca eigenvalues gives dc-CA eigenvalues. output can used scripting forward selection traits, similar forward selection environmental variables demo dune_select.r.","code":""},{"path":"/reference/anova_species.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Utility function: Species-level Permutation Test in Double Constrained Correspondence Analysis (dc-CA) — anova_species","text":"anova_species, first step extracts species-niche centroids (SNC) respect dc-CA ordination axes existing dc-CA analysis. second step, applies weighted redundancy analysis SNCs traits predictors. second step thus species-level analysis, final results (eigenvalues/ordination axes) identical analyses steps dc_CA.second step uses R-code analogous anova.wrda.","code":""},{"path":"/reference/anova_species.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Utility function: Species-level Permutation Test in Double Constrained Correspondence Analysis (dc-CA) — anova_species","text":"ter Braak, C.J.F. & te Beest, D.E. 2022. Testing environmental effects taxonomic composition canonical correspondence analysis: alternative permutation tests equal. Environmental Ecological Statistics. 29 (4), 849-868. doi:10.1007/s10651-022-00545-4 ter Braak, C.J.F. (2022) Predictor versus response permutation significance testing weighted regression redundancy analysis. Journal statistical computation simulation, 92, 2041-2059. doi:10.1080/00949655.2021.2019256","code":""},{"path":"/reference/anova_species.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Utility function: Species-level Permutation Test in Double Constrained Correspondence Analysis (dc-CA) — anova_species","text":"","code":"data(\"dune_trait_env\")  # rownames are carried forward in results rownames(dune_trait_env$comm) <- dune_trait_env$comm$Sites  mod <- dc_CA(formulaEnv = ~ A1 + Moist + Mag + Use + Manure,              formulaTraits = ~ SLA + Height + LDMC + Seedmass + Lifespan,              response = dune_trait_env$comm[, -1],  # must delete \"Sites\"              dataEnv = dune_trait_env$envir,              dataTraits = dune_trait_env$traits,              verbose = FALSE) anova(mod) #> $species #> Species-level permutation test using dc-CA #> Model: dc_CA(formulaEnv = ~A1 + Moist + Mag + Use + Manure, formulaTraits = ~SLA + Height + LDMC + Seedmass + Lifespan, response = dune_trait_env$comm[, -1], dataEnv = dune_trait_env$envir, dataTraits = dune_trait_env$traits, verbose = FALSE)  #> Residualized predictor permutation #>  #>          df ChiSquare     R2      F Pr(>F)   #> dcCA      5   0.44542 0.3367 2.2335  0.022 * #> Residual 22   0.87749                        #> --- #> Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1 #>  #> $sites #>          Df ChiSquare      R2      F Pr(>F)     #> dcCA1     7   0.44542 0.65733 3.2885  0.001 *** #> Residual 12   0.23220                           #> --- #> Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1 #>  #> $maxP #> Max test combining the community- and species- level tests  #> Model: dc_CA(formulaEnv = ~A1 + Moist + Mag + Use + Manure, formulaTraits = ~SLA + Height + LDMC + Seedmass + Lifespan, response = dune_trait_env$comm[, -1], dataEnv = dune_trait_env$envir, dataTraits = dune_trait_env$traits, verbose = FALSE)  #>  #> Taken from the species-level test: #> Residualized predictor permutation #> Permutation: free #> Number of permutations: 999 #>  #>          df ChiSquare     R2      F Pr(>F)   #> dcCA      5   0.44542 0.3367 2.2335  0.022 * #> Residual 22   0.87749                        #> --- #> Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1 #>   a_species <- anova_species(mod) a_species #> $table #> Species-level permutation test using dc-CA #> Model: dc_CA(formulaEnv = ~A1 + Moist + Mag + Use + Manure, formulaTraits = ~SLA + Height + LDMC + Seedmass + Lifespan, response = dune_trait_env$comm[, -1], dataEnv = dune_trait_env$envir, dataTraits = dune_trait_env$traits, verbose = FALSE)  #> Residualized predictor permutation #> Permutation: free #> Number of permutations: 999 #>  #>          df ChiSquare     R2      F Pr(>F)   #> dcCA      5   0.44542 0.3367 2.2335  0.021 * #> Residual 22   0.87749                        #> --- #> Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1 #>  #> $eigenvalues #>      dcCA1      dcCA2      dcCA3      dcCA4      dcCA5  #> 0.23680387 0.10903220 0.05933626 0.03791909 0.00232876  #>  # anova_species can be used for manual forward selection of # trait variables, as done for environmental variables in the demo  # dune_FS_dcCA.r, based on the first eigenvalue and its significance # and adding the first axis of the constrained species scores from mod to  # the Condition of a new mod. (eig1_and_pval <- c(eig = a_species$eig[1], pval = a_species$table$`Pr(>F)`[1])) #> eig.dcCA1      pval  #> 0.2368039 0.0210000  a_species$eig #>      dcCA1      dcCA2      dcCA3      dcCA4      dcCA5  #> 0.23680387 0.10903220 0.05933626 0.03791909 0.00232876  anova_sites(mod) #> $table #> Community-level permutation test using dc-CA #> Model: dc_CA(formulaEnv = ~A1 + Moist + Mag + Use + Manure, formulaTraits = ~SLA + Height + LDMC + Seedmass + Lifespan, response = dune_trait_env$comm[, -1], dataEnv = dune_trait_env$envir, dataTraits = dune_trait_env$traits, verbose = FALSE)  #> Residualized predictor permutation #> Permutation: free #> Number of permutations: 999 #>  #>          df ChiSquare      R2      F Pr(>F)     #> dcCA      7   0.44542 0.65733 3.2885  0.001 *** #> Residual 12   0.23220                           #> --- #> Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1 #>  #> $eigenvalues #>      dcCA1      dcCA2      dcCA3      dcCA4      dcCA5  #> 0.23680387 0.10903220 0.05933626 0.03791909 0.00232876  #>"},{"path":"/reference/cca0.html","id":null,"dir":"Reference","previous_headings":"","what":"Performs a canonical correspondence analysis — cca0","title":"Performs a canonical correspondence analysis — cca0","text":"cca0 formula-based implementation canonical correspondence analysis.","code":""},{"path":"/reference/cca0.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Performs a canonical correspondence analysis — cca0","text":"","code":"cca0(   formula,   response = NULL,   data,   traceonly = FALSE,   cca_object = NULL,   object4QR = NULL )"},{"path":"/reference/cca0.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Performs a canonical correspondence analysis — cca0","text":"formula one two-sided formula rows (samples) row predictors data. left hand side formula ignored specified next argument (response). Specify row covariates () adding + Condition(covariate-formula) formula rda. covariate-formula contain ~ (tilde). response matrix data frame abundance data (dimension n x m). Rownames response, , carried . BEWARE: rows columns positive sums! Can NULL cca_object supplied response formula two-sided. data matrix data frame row predictors, rows corresponding response (dimension n x p). traceonly logical, default FALSE. TRUE, explained variance predictors Condition() returned, .e without performing singular value decompostion. cca_object vegan-type cca-object transposed response, chisq_residuals row column weights can obtained. object4QR vegan-type cca-object weighted QR's formula, .e. qr(Z) qr(XZ) obtainable via get_QR(object4QR, model = \"pCCA\") get_QR(object4QR, model = \"CCA\"), respectively.","code":""},{"path":"/reference/cca0.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Performs a canonical correspondence analysis — cca0","text":"scores cca0 object scaling \"sites\" (1): scaling Focus Case distances. returned object class c(\"cca0\" \"wrda\") methods print, predict scores can use wrda variant.","code":""},{"path":"/reference/cca0.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Performs a canonical correspondence analysis — cca0","text":"algorithm wrda abundance data transformation chi-square residuals. much slower cca. reason use , anova.cca0 residualized predictor permutation. unknown authors douconca method anova.cca implements. See anova.cca0. Compared  cca, cca0 residual axes, .e. CA residuals performed.","code":""},{"path":"/reference/cca0.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Performs a canonical correspondence analysis — cca0","text":"ter Braak C.J.F.  P. Šmilauer  (2018). Canoco reference manual user's guide: software ordination (version 5.1x). Microcomputer Power, Ithaca, USA, 536 pp. Oksanen, J., et al. (2022) vegan: Community Ecology Package. R package version 2.6-8. https://CRAN.R-project.org/package=vegan.","code":""},{"path":[]},{"path":"/reference/cca0.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Performs a canonical correspondence analysis — cca0","text":"","code":"data(\"dune_trait_env\")  # rownames are carried forward in results rownames(dune_trait_env$comm) <- dune_trait_env$comm$Sites abun <- dune_trait_env$comm[, -1]  # must delete \"Sites\"  mod <- cca0(formula = abun ~ A1 + Moist + Mag + Use + Manure,             data = dune_trait_env$envir)  mod # Proportions equal to those Canoco 5.15 #> Call: cca0(formula = abun ~ A1 + Moist + Mag + Use + Manure, data = #> dune_trait_env$envir) #>  #> -- Model Summary -- #>  #>               Inertia Proportion Rank #> Total          2.1866     1.0000      #> Constrained    1.2511     0.5722    7 #> Unconstrained  0.9355     0.4278   19 #>  #> Inertia is scaled Chi-square #>  #> -- Eigenvalues -- #>  #> Eigenvalues for constrained axes: #>   CCA1   CCA2   CCA3   CCA4   CCA5   CCA6   CCA7  #> 0.4759 0.3241 0.1764 0.1313 0.0690 0.0412 0.0333  #>  #> Eigenvalues for unconstrained axes: #> CA1 CA2 CA3 CA4 CA5 CA6 CA7 CA8  #>  NA  NA  NA  NA  NA  NA  NA  NA  #> (Showing 8 of 19 unconstrained eigenvalues) #>  #> mean, sd, VIF and canonical coefficients with their optimistic [!] t-values: #>           Avg    SDS    VIF   Regr1   tval1 #> A1     4.6363 1.8096 1.5022 -0.0962 -1.2237 #> Moist  2.7604 1.7163 1.7279 -0.5275 -6.2574 #> MagBF  0.1773 0.3819 4.7947  0.0107  0.0758 #> MagHF  0.3179 0.4657 2.9965  0.1034  0.9314 #> MagNM  0.2029 0.4021 7.1714 -0.1599 -0.9308 #> Use    1.9042 0.7523 1.6739 -0.1310 -1.5794 #> Manure 1.9521 1.3534 7.8029 -0.0354 -0.1975 #>   scores(mod, which_cor = c(\"A1\", \"X_lot\"), display = \"cor\") #>            wRDA1       wRDA2 #> A1    -0.5433670  0.15530408 #> X_lot -0.1808011 -0.08064616 #> attr(,\"meaning\") #> [1] \"inter set correlation, correlation between environmental variables and the sites scores (CWMs)\"  set.seed(123) anova(mod) #> $table #> Permutation test for canonical correspondence analysis #> Model: cca0(formula = abun ~ A1 + Moist + Mag + Use + Manure, data = dune_trait_env$envir)  #> Residualized predictor permutation #> Permutation: free #> Number of permutations: 999 #>  #>          df ChiSquare      R2      F Pr(>F)     #> cca       7   1.25113 0.57218 2.2927  0.001 *** #> Residual 12   0.93548                           #> --- #> Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1 #>  #> $eigenvalues #>       cca1       cca2       cca3       cca4       cca5       cca6       cca7  #> 0.47593373 0.32414453 0.17637629 0.13125103 0.06899011 0.04116257 0.03326681  #>  anova(mod, by = \"axis\") #> $table #> Permutation test for canonical correspondence analysis #> Model: cca0(formula = abun ~ A1 + Moist + Mag + Use + Manure, data = dune_trait_env$envir)  #> Residualized predictor permutation #> Permutation: free #> Number of permutations: 999 #>  #>          df ChiSquare       R2      F Pr(>F)    #> cca1      1   0.47593 0.217659 6.1051  0.002 ** #> cca2      1   0.32414 0.148241 4.1580  0.018 *  #> cca3      1   0.17638 0.080662 2.2625  0.236    #> cca4      1   0.13125 0.060025 1.6836  0.404    #> cca5      1   0.06899 0.031551 0.8850  0.951    #> cca6      1   0.04116 0.018825 0.5280  0.996    #> cca7      1   0.03327 0.015214 0.4267  0.996    #> Residual 12   0.93548                           #> --- #> Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1 #>  #> $eigenvalues #>       cca1       cca2       cca3       cca4       cca5       cca6       cca7  #> 0.47593373 0.32414453 0.17637629 0.13125103 0.06899011 0.04116257 0.03326681  #>   mod2 <- vegan::cca(abun ~ A1 + Moist + Mag + Use + Manure,                    data = dune_trait_env$envir) anova(mod2, by = \"axis\") #> Permutation test for cca under reduced model #> Forward tests for axes #> Permutation: free #> Number of permutations: 999 #>  #> Model: cca(formula = abun ~ A1 + Moist + Mag + Use + Manure, data = dune_trait_env$envir) #>          Df ChiSquare      F Pr(>F)     #> CCA1      1   0.47593 6.1051  0.001 *** #> CCA2      1   0.32414 4.1580  0.037 *   #> CCA3      1   0.17638 2.2625  0.724     #> CCA4      1   0.13125 1.6836  0.987     #> CCA5      1   0.06899 0.8850  1.000     #> CCA6      1   0.04116 0.5280            #> CCA7      1   0.03327 0.4267            #> Residual 12   0.93548                   #> --- #> Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1  dat <- dune_trait_env$envir dat$Mag <- \"SF\" predict(mod, type = \"lc\", newdata = dat) #>              wRDA1     wRDA2       wRDA3       wRDA4       wRDA5       wRDA6 #> Site_1   0.6904890 0.2738131  0.85706483  0.21494213  0.04961136  0.72100459 #> Site_2   0.7086329 0.2734695  0.33481865 -1.07270103 -1.35928061  0.53160107 #> Site_3   0.2244798 0.5945085  0.60570803  0.44083874  0.37245365  0.46727185 #> Site_4   0.2308792 0.5789014  0.63318079  0.42798545  0.35582702  0.47363638 #> Site_5   0.7391771 0.6853586 -0.03558872 -0.62800472 -0.21511036 -0.01408255 #> Site_6   0.6574380 0.3983263  0.11503656 -0.96987465 -1.22626765  0.48068489 #> Site_7   0.5122323 0.2441261  0.29326645 -0.55866996 -1.39165267  1.01605565 #> Site_8  -1.0574335 0.8089811  0.55158630 -0.24633521 -0.86510811  0.29389272 #> Site_9  -0.1730258 0.4845439  0.99593856 -1.55170714 -1.18971277 -0.39582562 #> Site_10  0.5926090 0.2489378  0.78436035 -1.66931462 -1.40310518 -0.05383772 #> Site_11  0.5303763 0.2437824 -0.22897973 -1.84631313 -2.80054465  0.82665213 #> Site_12 -0.5486085 0.8921994  0.18514902 -0.67778374 -0.75653943 -0.08957766 #> Site_13 -0.9628957 1.0647992  0.45590655  0.06982812  0.11279594 -0.18814568 #> Site_14 -1.2893919 1.4405532 -1.34442983 -1.65724140 -2.30506793 -0.24797572 #> Site_15 -1.2204515 1.7587997 -1.55000063 -1.28966488 -1.26065740 -0.75547220 #> Site_16 -1.1534240 1.0430876  0.13949487 -0.05353574 -0.61570879  0.19842488 #> Site_17  0.5792832 0.3033908  0.42708259 -2.26814966 -2.04935800 -0.17081531 #> Site_18  0.9109057 0.3104445  0.10151139 -2.22412702 -2.02304124 -0.05073754 #> Site_19 -0.5115748 0.5163361  0.99170477 -2.20741811 -1.87890897 -0.62651646 #> Site_20 -0.4987760 0.4851219  1.04665030 -2.23312471 -1.91216221 -0.61378742 #>               wRDA7 #> Site_1  -0.21001080 #> Site_2  -0.96564817 #> Site_3  -0.19205750 #> Site_4  -0.18164028 #> Site_5  -1.37467944 #> Site_6  -1.04898590 #> Site_7  -0.43402001 #> Site_8   0.11698515 #> Site_9  -0.92255561 #> Site_10 -1.22930984 #> Site_11 -1.18965737 #> Site_12 -0.68260950 #> Site_13 -0.18787396 #> Site_14 -1.43836815 #> Site_15 -1.78489613 #> Site_16 -0.03927309 #> Site_17 -1.64358878 #> Site_18 -1.88030362 #> Site_19 -1.08970250 #> Site_20 -1.06886806"},{"path":"/reference/coef.dcca.html","id":null,"dir":"Reference","previous_headings":"","what":"Coefficients of double-constrained correspondence analysis (dc-CA) — coef.dcca","title":"Coefficients of double-constrained correspondence analysis (dc-CA) — coef.dcca","text":"Fourth-corner coefficients regression coefficients (full reduced rank) predict traits environment, environment traits response trait environment data.","code":""},{"path":"/reference/coef.dcca.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Coefficients of double-constrained correspondence analysis (dc-CA) — coef.dcca","text":"","code":"# S3 method for class 'dcca' coef(   object,   ...,   type = c(\"fourth_corner\", \"all_reg\", \"env2traits_reg\", \"traits2env_reg\"),   rank = \"full\",   normed = TRUE )"},{"path":"/reference/coef.dcca.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Coefficients of double-constrained correspondence analysis (dc-CA) — coef.dcca","text":"object return value dc_CA. ... arguments passed function (currently ignored). type type coefficients, c(\"fourth_corner\", \"all_reg\", \"env2traits_reg\", \"traits2env_reg\") fourth-corner coefficients regression coefficients trait x environmental predictors, environmental predictors trait predictors prediction (transformed) response, traits environmental values, respectively. rank rank (number axes use). Default \"full\" axes (rank-reduction). normed logical (default TRUE) giving standardized regression coefficients biplot scores. FALSE, (regular) regression coefficients (unstandardized) biplot scores.","code":""},{"path":"/reference/coef.dcca.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Coefficients of double-constrained correspondence analysis (dc-CA) — coef.dcca","text":"matrix coefficients. exact content matrix depends type coefficient asked . Regression coefficients response variable usually column-vectors. X matrix units--predictors B matrix predictors--response-variables, predictions fits form Y = XB. Analogously, type = \"trait2env\" gives trait--environment matrix type = \"env2traits\" gives environment--trait matrix.","code":""},{"path":"/reference/coef.dcca.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Coefficients of double-constrained correspondence analysis (dc-CA) — coef.dcca","text":"Regression coefficients standardized traits environmental variables. covariates, coef() gives partialfourth-corner correlations. rank = 2, coef() gives two-dimensional approximation full-rank fourth-corner correlations biplot displays traits environmental variables arrow heads points scores(mod, display = c(\"bp\", \"bp_traits\")).","code":""},{"path":"/reference/coef.dcca.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Coefficients of double-constrained correspondence analysis (dc-CA) — coef.dcca","text":"","code":"data(\"dune_trait_env\")  # rownames are carried forward in results rownames(dune_trait_env$comm) <- dune_trait_env$comm$Sites  mod <- dc_CA(formulaEnv = ~ A1 + Moist + Mag + Use + Condition(Manure),              formulaTraits = ~ SLA + Height + LDMC + Condition(Seedmass) + Lifespan,              response = dune_trait_env$comm[, -1],  # must delete \"Sites\"              dataEnv = dune_trait_env$envir,              dataTraits = dune_trait_env$traits,              verbose = FALSE)  # regression coefficients coef(mod, type = \"env2traits\") #>                SLA     Height        LDMC Lifespanannual Lifespanperennial #> Manure -0.23423414  0.2540139  0.32912396    -0.37130684        0.37130684 #> A1      0.05226663  0.1025887 -0.08560552    -0.12390838        0.12390838 #> Moist  -0.18017363  0.1836804  0.04051036    -0.02158823        0.02158823 #> MagBF  -0.01504873  0.1005833  0.10645047    -0.25809310        0.25809310 #> MagHF  -0.05899194  0.1044629  0.03221358    -0.18057689        0.18057689 #> MagNM  -0.29468992  0.1739784  0.33095579    -0.39679946        0.39679946 #> Use    -0.04563582 -0.1100948 -0.17509044     0.03719925       -0.03719925 #> attr(,\"meaning\") #> [1] \"standardized regression coefficients to predict traits from environment.\" coef(mod, type = \"traits2env\") #>                            A1       Moist       MagSF        MagBF        MagHF #> Seedmass          -0.02240045 -0.04978638 -0.01023869  0.041848273  0.009631558 #> SLA               -0.06845546 -0.16774065 -0.02649254  0.146106902  0.034893995 #> Height             0.15457078  0.15961290  0.02806485 -0.073452767  0.041610702 #> LDMC              -0.17828444 -0.10419687  0.01403797  0.005732252 -0.079309518 #> Lifespanperennial  0.08878173  0.02537622 -0.05136037 -0.005425793  0.007615053 #>                         MagNM          Use #> Seedmass          -0.03147019  0.004500904 #> SLA               -0.12032477 -0.090142614 #> Height            -0.01014934  0.018558815 #> LDMC               0.05643595 -0.180870869 #> Lifespanperennial  0.04839256  0.080107192 #> attr(,\"meaning\") #> [1] \"standardized regression coefficients to predict environment from traits.\" coef(mod, type = \"fourth\") #>                            A1       Moist       MagSF       MagBF        MagHF #> SLA               -0.07275100 -0.18945586 -0.04438289  0.15899470  0.031696233 #> Height             0.11655218  0.16432389  0.03216548 -0.10690577  0.005095068 #> LDMC              -0.10383747 -0.02955614  0.01837840 -0.03300820 -0.065595295 #> Lifespanannual    -0.06904553  0.00293052  0.05112542 -0.01535635 -0.008559657 #> Lifespanperennial  0.06904553 -0.00293052 -0.05112542  0.01535635  0.008559657 #>                         MagNM          Use #> SLA               -0.10945491 -0.059594125 #> Height             0.04632044 -0.009109448 #> LDMC               0.06932311 -0.150609601 #> Lifespanannual    -0.03107173 -0.039539841 #> Lifespanperennial  0.03107173  0.039539841 #> attr(,\"meaning\") #> [1] \"fourth-corner correlation\" coef(mod, type = \"all_reg\") #>                        Manure           A1       Moist       MagBF       MagHF #> Seedmass          -0.12493711 -0.006613744 -0.05931607 -0.04200761 -0.03770288 #> SLA               -0.28292594  0.060443140 -0.15449656 -0.05168545 -0.08321524 #> Height             0.05781765  0.163735690  0.15681800  0.04023132  0.07189288 #> LDMC               0.23683091 -0.153975995 -0.03174838  0.05461067 -0.02638899 #> Lifespanperennial  0.38895095  0.113943476  0.03774092  0.25684954  0.19263442 #>                         MagNM         Use #> Seedmass          -0.12349465  0.02839218 #> SLA               -0.38998539 -0.08819784 #> Height            -0.07279848 -0.08547934 #> LDMC               0.26477639 -0.16089710 #> Lifespanperennial  0.44747415  0.01244177 #> attr(,\"meaning\") #> [1] \"standardized regression coefficients for traits and environment to predict the response.\""},{"path":"/reference/dc_CA.html","id":null,"dir":"Reference","previous_headings":"","what":"Performs (weighted) double constrained correspondence analysis (dc-CA) — dc_CA","title":"Performs (weighted) double constrained correspondence analysis (dc-CA) — dc_CA","text":"Double constrained correspondence analysis (dc-CA) analyzing (multi-)trait (multi-)environment ecological data using library vegan native R code. formula interface allows assess, example, importance trait interactions shaping ecological communities. function dc_CA option divide abundance data site site total, giving equal site weights. division advantage multivariate analysis corresponds unweighted (multi-trait) community-level analysis, instead weighted (Kleyer et al. 2012, ter Braak van Rossum, 2025).","code":""},{"path":"/reference/dc_CA.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Performs (weighted) double constrained correspondence analysis (dc-CA) — dc_CA","text":"","code":"dc_CA(   formulaEnv = NULL,   formulaTraits = NULL,   response = NULL,   dataEnv = NULL,   dataTraits = NULL,   divideBySiteTotals = NULL,   dc_CA_object = NULL,   env_explain = TRUE,   use_vegan_cca = FALSE,   verbose = TRUE )"},{"path":"/reference/dc_CA.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Performs (weighted) double constrained correspondence analysis (dc-CA) — dc_CA","text":"formulaEnv two-sided one-sided formula rows (samples) row predictors dataEnv. left hand side formula ignored specified response argument. Specify row covariates () adding + Condition(covariate-formula) formulaEnv rda. covariate-formula contain ~ (tilde). Default: NULL ~., .e. variables dataEnv predictor variables. formulaTraits formula one-sided formula columns (species) column predictors dataTraits. two-sided, left hand side formula used. Specify column covariates () adding + Condition(covariate-formula) formulaTraits cca. covariate-formula contain ~ (tilde). Default: NULL ~., .e. variables dataTraits predictor traits. response matrix, data frame abundance data (dimension n x m) list community weighted means (CWMs) fCWM_SNC, NULL. NULL, response left-hand side formulaEnv. See Details analyses starting community weighted means. Rownames response, , carried . dataEnv matrix data frame row predictors, rows corresponding response. (dimension n x p). dataTraits matrix data frame column predictors, rows corresponding columns response. (dimension m x q). divideBySiteTotals logical; default TRUE closing data dividing rows response total. However, default FALSE, species totals proportional N2*(N-N2) N2 Hill numbers order 2 species N number sites, indicator response data pre-processed N2-based marginals using ipf2N2. dc_CA_object optional object earlier run function. Useful formula columns (formulaTraits), dataTraits response used new formula rows. set, data previous run used result first step taken new analysis env_explain set FALSE. env_explain logical (default TRUE) calculation inertia explained environmental variable (based CCA abundance (divideBySiteTotals, true) environmental formula). use_vegan_cca default TRUE. verbose logical printing simple summary (default: TRUE)","code":""},{"path":"/reference/dc_CA.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Performs (weighted) double constrained correspondence analysis (dc-CA) — dc_CA","text":"list class dcca; list elements CCAonTraits cca.object cca analysis transpose closed response using formula formulaTraits. formulaTraits argument formulaTraits. formula ~., changed explicit trait names. data list Y, dataEnv dataTraits, removing empty rows columns response closure divideBySiteTotals = TRUE corresponding rows dataEnv dataTraits removed. weights list unit-sum weights columns rows. names list c(\"columns\", \"rows\"), order. Nobs number sites (rows). CWMs_orthonormal_traits Community weighted means w.r.t. orthonormalized traits. RDAonEnv wrda object cca.object wrda , equal row weights, rda analysis, respectively column scores cca, CWMs orthonormalized traits, using formula formulaEnv. formulaEnv argument formulaEnv. formula ~., changed explicit environmental variable names. eigenvalues dc-CA eigenvalues (rda analysis). c_traits_normed0 mean, sd, VIF (regression) coefficients traits define dc-CA axes terms traits t-ratios missing indicated NAs 'tval1'. inertia one-column matrix , , six inertias (weighted variances): total: total inertia. conditionT: inertia explained condition formulaTraits present (neglecting row constraints). traits_explain: trait-structured variation, .e. inertia explained traits (without constaints rows conditional Condition formulaTraits).  maximum row predictors explain dc-CA (sum last two items thus less value). env_explain: environmentally structured variation, .e. inertia explained environment (without constraints columns conditional Condition formulaEnv). maximum column predictors explain dc-CA (item constraintsTE thus less value). value NA, collinearity environmental data. conditionTE: trait-constrained variation explained condition formulaEnv. constraintsTE: trait-constrained variation explained predictors (without row covariates). verbose TRUE (<- print() invoked) three items. c_traits_normed: mean, sd, VIF (regression) coefficients traits define dc-CA trait axes (composite traits), optimistic t-ratio. c_env_normed: mean, sd, VIF (regression) coefficients environmental variables define dc-CA axes terms environmental variables (composite gradients), optimistic t-ratio. species_axes: list four items species_scores: list names   c(\"species_scores_unconstrained\", \"lc_traits_scores\")   matrix species niche centroids along dc-CA axes (composite   gradients) matrix linear combinations traits. correlation: matrix inter-set correlations   traits SNCs. b_se: matrix (unstandardized) regression coefficients   traits optimistic standard errors. R2_traits: vector coefficient determination (R2)   SNCs traits. square-root thereof called   species-trait correlation analogy species-environment   correlation CCA. sites_axes: list four items site_scores: list names    c(\"site_scores_unconstrained\", \"lc_env_scores\") matrix    community weighted means (CWMs) along dc-CA axes (composite    gradients) matrix linear combinations environmental    variables. correlation: matrix inter-set correlations    environmental variables CWMs. b_se: matrix (unstandardized) regression coefficients    environmental variables optimistic standard errors. R2_env: vector coefficient determination (R2)    CWMs environmental variables. square-root thereof    called species-environmental correlation CCA. scores dcca object scaling \"sites\" (1): scaling Focus Case distances .","code":""},{"path":"/reference/dc_CA.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Performs (weighted) double constrained correspondence analysis (dc-CA) — dc_CA","text":"Empty (zero) rows columns response removed response corresponding rows dataEnv dataTraits. Subsequently, columns missing values removed  dataEnv dataTraits. gives error ('name_of_variable' found), variables missing entries specified formulaEnv formulaTraits. Computationally, dc-CA can carried single singular value decomposition (ter Braak et al. 2018), computed two steps. first step, transpose response regressed traits (column predictors) using cca formulaTraits. column scores analysis (scaling 1) community weighted means (CWM) orthonormalized traits. regressed environmental (row) predictors using wrda formulaEnv using rda, site weights equal. dc-CA can carried , statisticians call, sufficient statistics method. useful, abundance data available made public paper attempting reproducible research. case, response list first element community weighted means (e.g. list(CWM = CWMs)) respect traits, trait data, , optionally, list elements, functions related dc_CA. minimum list(CWM = CWMs, weight = list(columns = species_weights)) CWM matrix data.frame, formulaEnv, formulaTraits, dataEnv, dataTraits must specified call dc_CA. function fCWM_SNC example show set response helps create response abundance data non-standard applications dc-CA. Species site weights, set response$weights can set variable weight data frames dataTraits dataEnv, respectively, formulas ~.. statistics scores example dune_dcCA.r, checked results Canoco 5.15 (ter Braak & Šmilauer, 2018).","code":""},{"path":"/reference/dc_CA.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Performs (weighted) double constrained correspondence analysis (dc-CA) — dc_CA","text":"Kleyer, M., Dray, S., Bello, F., Lepš, J., Pakeman, R.J., Strauss, B., Thuiller, W. & Lavorel, S. (2012) Assessing species community functional responses environmental gradients: multivariate methods? Journal Vegetation Science, 23, 805-821. doi:10.1111/j.1654-1103.2012.01402.x ter Braak, CJF, Šmilauer P, Dray S. (2018). Algorithms biplots double constrained correspondence analysis. Environmental Ecological Statistics, 25(2), 171-197. doi:10.1007/s10651-017-0395-x ter Braak C.J.F.  P. Šmilauer  (2018). Canoco reference manual user's guide: software ordination (version 5.1x). Microcomputer Power, Ithaca, USA, 536 pp. ter  Braak, C.J.F. van Rossum, B. (2025). Linking Multivariate Trait Variation Environment: Advantages Double Constrained Correspondence Analysis R Package Douconca. Ecological Informatics, 88. doi:10.1016/j.ecoinf.2025.103143 Oksanen, J., et al. (2024). vegan: Community Ecology Package. R package version 2.6-6.1. https://CRAN.R-project.org/package=vegan.","code":""},{"path":[]},{"path":"/reference/dc_CA.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Performs (weighted) double constrained correspondence analysis (dc-CA) — dc_CA","text":"","code":"data(\"dune_trait_env\")  # rownames are carried forward in results rownames(dune_trait_env$comm) <- dune_trait_env$comm$Sites abun <- dune_trait_env$comm[, -1]  # must delete \"Sites\" mod <- dc_CA(formulaEnv = abun ~ A1 + Moist + Mag + Use + Manure,              formulaTraits = ~ SLA + Height + LDMC + Seedmass + Lifespan,              dataEnv = dune_trait_env$envir,              dataTraits = dune_trait_env$traits,        verbose = FALSE)  print(mod) # same output as with verbose = TRUE (the default of verbose).                                      #> Step 1: the CCA ordination of the transposed matrix with trait constraints, #>         useful in itself and also yielding CWMs of the orthonormalized traits for step 2. #> Call: cca0(formula = formulaTraits, response = tY, data = #> out0$data$dataTraits) #>  #> -- Model Summary -- #>  #>               Inertia Proportion Rank #> Total          2.3490     1.0000      #> Constrained    0.6776     0.2885    5 #> Unconstrained  1.6714     0.7115   19 #>  #> Inertia is scaled Chi-square #>  #> -- Eigenvalues -- #>  #> Eigenvalues for constrained axes: #>    CCA1    CCA2    CCA3    CCA4    CCA5  #> 0.26839 0.19597 0.12356 0.07003 0.01967  #>  #> Eigenvalues for unconstrained axes: #> CA1 CA2 CA3 CA4 CA5 CA6 CA7 CA8  #>  NA  NA  NA  NA  NA  NA  NA  NA  #> (Showing 8 of 19 unconstrained eigenvalues) #>  #> mean, sd, VIF and canonical coefficients with their optimistic [!] t-values: #>                        Avg     SDS    VIF   Regr1   tval1 #> SLA                24.6468  6.3438 1.1888  0.4401  4.1794 #> Height             25.1272 15.6848 1.3033  0.1283  1.1640 #> LDMC              244.5084 70.9729 1.1791  0.0278  0.2647 #> Seedmass            0.6543  0.6688 1.0784  0.3708  3.6980 #> Lifespanperennial   0.9607  0.1944 1.0964 -0.0578 -0.5718 #>  #> Step 2: the RDA ordination of CWMs of the orthonormalized traits  #>         of step 1 with environmental constraints: #> Call: rda(formula = out1$CWMs_orthonormal_traits ~ A1 + Moist + Mag + Use + #> Manure, data = out1$data$dataEnv) #>  #> -- Model Summary -- #>  #>               Inertia Proportion Rank #> Total          0.6776     1.0000      #> Constrained    0.4454     0.6573    5 #> Unconstrained  0.2322     0.3427    5 #>  #> Inertia is variance #>  #> -- Eigenvalues -- #>  #> Eigenvalues for constrained axes: #>    RDA1    RDA2    RDA3    RDA4    RDA5  #> 0.23680 0.10903 0.05934 0.03792 0.00233  #>  #> Eigenvalues for unconstrained axes: #>     PC1     PC2     PC3     PC4     PC5  #> 0.12017 0.05836 0.03455 0.01337 0.00575  #>  #> mean, sd, VIF and canonical coefficients with their optimistic [!] t-values: #>         Avg    SDS    VIF   Regr1   tval1 #> A1     4.85 2.1240 1.6967 -0.0605 -0.9172 #> Moist  2.90 1.7578 1.7658  0.3250  4.8293 #> MagBF  0.15 0.3571 4.5016 -0.0475 -0.4421 #> MagHF  0.25 0.4330 2.6715 -0.0156 -0.1890 #> MagNM  0.30 0.4583 9.5666  0.1622  1.0352 #> Use    1.90 0.7681 1.7825  0.0219  0.3239 #> Manure 1.75 1.4448 9.3847 -0.1444 -0.9306 #>                        Avg     SDS    VIF   Regr1   tval1 #> SLA                24.6468  6.3438 1.1888 -0.8196 -3.6933 #> Height             25.1272 15.6848 1.3033 -0.1598 -0.6877 #> LDMC              244.5084 70.9729 1.1791 -0.0562 -0.2542 #> Seedmass            0.6543  0.6688 1.0784 -0.7586 -3.5896 #> Lifespanperennial   0.9607  0.1944 1.0964  0.1006  0.4722 #>  #>                weighted variance #> total                      2.349 #> traits_explain             0.678 #> env_explain                1.323 #> constraintsTE              0.445 #> attr(,\"meaning\") #>                meaning                                                                 #> total          \"total inertia (= weighted variation)\"                                  #> traits_explain \"trait-constrained variation\"                                           #> env_explain    \"environment-constrained variation\"                                     #> constraintsTE  \"trait-constrained variation explained by the predictors in formulaEnv\" anova(mod, by = \"axis\") #> $species #> Species-level permutation test using dc-CA #> Model: dc_CA(formulaEnv = abun ~ A1 + Moist + Mag + Use + Manure, formulaTraits = ~SLA + Height + LDMC + Seedmass + Lifespan, dataEnv = dune_trait_env$envir, dataTraits = dune_trait_env$traits, verbose = FALSE)  #> Residualized predictor permutation #>  #>          df ChiSquare       R2      F Pr(>F) #> dcCA1     1   0.23680 0.179002 5.9370  0.118 #> dcCA2     1   0.10903 0.082419 2.7336  0.488 #> dcCA3     1   0.05934 0.044853 1.4877  0.778 #> dcCA4     1   0.03792 0.028663 0.9507  0.799 #> dcCA5     1   0.00233 0.001760 0.0584  0.999 #> Residual 22   0.87749                        #>  #> $sites #>          Df ChiSquare      R2       F Pr(>F)    #> dcCA1     1  0.236804 0.34946 14.2776  0.002 ** #> dcCA2     1  0.109032 0.16090  6.5739  0.101    #> dcCA3     1  0.059336 0.08757  3.5776  0.424    #> dcCA4     1  0.037919 0.05596  2.2863  0.680    #> dcCA5     1  0.002329 0.00344  0.1404  1.000    #> Residual 14  0.232199                           #> --- #> Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1 #>  #> $maxP #> Max test combining the community- and species- level tests  #> Model: dc_CA(formulaEnv = abun ~ A1 + Moist + Mag + Use + Manure, formulaTraits = ~SLA + Height + LDMC + Seedmass + Lifespan, dataEnv = dune_trait_env$envir, dataTraits = dune_trait_env$traits, verbose = FALSE)  #>  #> a mix the species- (traits) and community- (environment) levels: #>  #>       df ChiSquare traitP  envP Pr(>F) #> dcCA1  1  0.236804  0.118 0.002  0.118 #> dcCA2  1  0.109032  0.488 0.101  0.488 #> dcCA3  1  0.059336  0.778 0.424  0.778 #> dcCA4  1  0.037919  0.799 0.680  0.799 #> dcCA5  1  0.002329  0.999 1.000  1.000 #>  # For more demo on testing, see demo dune_test.r  mod_scores <- scores(mod) # correlation of axes with a variable that is not in the model scores(mod, display = \"cor\", scaling = \"sym\", which_cor = list(NULL, \"X_lot\")) #>           dcCA1      dcCA2 #> X_lot 0.1425494 0.06695038 #> attr(,\"meaning\") #> [1] \"inter set correlation, correlation between environmental variables and the sites scores (CWMs)\"  cat(\"head of unconstrained site scores, with meaning\\n\") #> head of unconstrained site scores, with meaning print(head(mod_scores$sites)) #>             dcCA1       dcCA2 #> Site_1 -1.2640026  0.19395232 #> Site_2 -0.7328822 -0.24929614 #> Site_3 -0.8250139 -0.44760064 #> Site_4 -0.4453407 -0.33741144 #> Site_5 -0.5783587  0.01524487 #> Site_6 -0.5722181  0.24340264  mod_scores_tidy <- scores(mod, tidy = TRUE) print(\"names of the tidy scores\") #> [1] \"names of the tidy scores\" print(names(mod_scores_tidy)) #> [1] \"dcCA1\"  \"dcCA2\"  \"score\"  \"label\"  \"weight\" cat(\"\\nThe levels of the tidy scores\\n\") #>  #> The levels of the tidy scores print(levels(mod_scores_tidy$score)) #>  [1] \"biplot\"                       \"biplot_traits\"                #>  [3] \"centroids\"                    \"centroids_traits\"             #>  [5] \"constraints_sites\"            \"constraints_species\"          #>  [7] \"correlation\"                  \"correlation_traits\"           #>  [9] \"factorbiplot\"                 \"factorbiplot_traits\"          #> [11] \"intra_set_correlation\"        \"intra_set_correlation_traits\" #> [13] \"regression\"                   \"regression_traits\"            #> [15] \"sites\"                        \"species\"                      #> [17] \"t_values\"                     \"t_values_traits\"               cat(\"\\nFor illustration: a dc-CA model with a trait covariate\\n\") #>  #> For illustration: a dc-CA model with a trait covariate mod2 <- dc_CA(formulaEnv = abun ~ A1 + Moist + Mag + Use + Manure,               formulaTraits = ~ SLA + Height + LDMC + Lifespan + Condition(Seedmass),               dataEnv = dune_trait_env$envir,               dataTraits = dune_trait_env$traits) #> Step 1: the CCA ordination of the transposed matrix with trait constraints, #>         useful in itself and also yielding CWMs of the orthonormalized traits for step 2. #> Call: cca0(formula = formulaTraits, response = tY, data = #> out0$data$dataTraits) #>  #> -- Model Summary -- #>  #>               Inertia Proportion Rank #> Total         2.34899    1.00000      #> Conditional   0.16671    0.07097    2 #> Constrained   0.51091    0.21750    4 #> Unconstrained 1.67137    0.71153   19 #>  #> Inertia is scaled Chi-square #>  #> -- Eigenvalues -- #>  #> Eigenvalues for constrained axes: #>    CCA1    CCA2    CCA3    CCA4  #> 0.21499 0.18622 0.07354 0.03616  #>  #> Eigenvalues for unconstrained axes: #> CA1 CA2 CA3 CA4 CA5 CA6 CA7 CA8  #>  NA  NA  NA  NA  NA  NA  NA  NA  #> (Showing 8 of 19 unconstrained eigenvalues) #>  #> mean, sd, VIF and canonical coefficients with their optimistic [!] t-values: #>                        Avg     SDS    VIF   Regr1   tval1 #> Seedmass            0.6543  0.6688 1.0784  0.0223  0.2225 #> SLA                24.6468  6.3438 1.1888  0.4456  4.2398 #> Height             25.1272 15.6848 1.3033  0.3532  3.2091 #> LDMC              244.5084 70.9729 1.1791 -0.1043 -0.9967 #> Lifespanperennial   0.9607  0.1944 1.0964 -0.0439 -0.4349 #>  #> Step 2: the RDA ordination of CWMs of the orthonormalized traits  #>         of step 1 with environmental constraints: #> Call: rda(formula = out1$CWMs_orthonormal_traits ~ A1 + Moist + Mag + Use + #> Manure, data = out1$data$dataEnv) #>  #> -- Model Summary -- #>  #>               Inertia Proportion Rank #> Total          0.5109     1.0000      #> Constrained    0.3171     0.6207    4 #> Unconstrained  0.1938     0.3793    4 #>  #> Inertia is variance #>  #> -- Eigenvalues -- #>  #> Eigenvalues for constrained axes: #>    RDA1    RDA2    RDA3    RDA4  #> 0.16632 0.08100 0.04766 0.02215  #>  #> Eigenvalues for unconstrained axes: #>     PC1     PC2     PC3     PC4  #> 0.11386 0.04942 0.01888 0.01162  #>  #> mean, sd, VIF and canonical coefficients with their optimistic [!] t-values: #>         Avg    SDS    VIF   Regr1   tval1 #> A1     4.85 2.1240 1.6967 -0.0920 -1.1424 #> Moist  2.90 1.7578 1.7658  0.1002  1.2204 #> MagBF  0.15 0.3571 4.5016  0.0125  0.0951 #> MagHF  0.25 0.4330 2.6715  0.0405  0.4006 #> MagNM  0.30 0.4583 9.5666  0.3052  1.5969 #> Use    1.90 0.7681 1.7825  0.0927  1.1234 #> Manure 1.75 1.4448 9.3847 -0.1567 -0.8277 #>                        Avg     SDS    VIF   Regr1   tval1 #> Seedmass            0.6543  0.6688 1.0784 -0.0929 -0.3874 #> SLA                24.6468  6.3438 1.1888 -1.0644 -4.2276 #> Height             25.1272 15.6848 1.3033 -0.5285 -2.0049 #> LDMC              244.5084 70.9729 1.1791  0.0433  0.1728 #> Lifespanperennial   0.9607  0.1944 1.0964  0.1744  0.7211 #>  #>                weighted variance #> total                      2.349 #> conditionT                 0.167 #> traits_explain             0.511 #> env_explain                1.323 #> constraintsTE              0.317 #> attr(,\"meaning\") #>                meaning                                                                 #> total          \"total inertia (= weighted variation)\"                                  #> conditionT     \"variation fitted by the trait condition\"                               #> traits_explain \"trait-constrained variation\"                                           #> env_explain    \"environment-constrained variation\"                                     #> constraintsTE  \"trait-constrained variation explained by the predictors in formulaEnv\"  cat(\"\\nFor illustration: a dc-CA model with both environmental and trait covariates\\n\") #>  #> For illustration: a dc-CA model with both environmental and trait covariates mod3 <- dc_CA(formulaEnv = abun ~ A1 + Moist + Use + Manure + Condition(Mag),               formulaTraits = ~ SLA + Height + LDMC + Lifespan + Condition(Seedmass),               dataEnv = dune_trait_env$envir,               dataTraits = dune_trait_env$traits,          verbose = FALSE)  cat(\"\\nFor illustration: same model but using dc_CA_object = mod2 for speed, \",      \"as the trait model and data did not change\\n\") #>  #> For illustration: same model but using dc_CA_object = mod2 for speed,  as the trait model and data did not change mod3B <- dc_CA(formulaEnv = abun ~ A1 + Moist + Use + Manure + Condition(Mag),                dataEnv = dune_trait_env$envir,                dc_CA_object = mod2,           verbose= FALSE) cat(\"\\ncheck on equality of mod3 (from data) and mod3B (from a dc_CA_object)\\n\",     \"the expected difference is in the component 'call'\\n \") #>  #> check on equality of mod3 (from data) and mod3B (from a dc_CA_object) #>  the expected difference is in the component 'call' #>    print(all.equal(mod3[-c(5,12)], mod3B[-c(5,12)])) #  only the component call differs #> [1] TRUE print(mod3$inertia[-c(3,5),]/mod3B$inertia) #        and mod3 has two more inertia items #>                weighted variance #> total                          1 #> conditionT                     1 #> traits_explain                 1 #> conditionTE                    1 #> constraintsTE                  1 #> attr(,\"meaning\") #>                meaning                                                                 #> total          \"total inertia (= weighted variation)\"                                  #> conditionT     \"variation fitted by the trait condition\"                               #> traits_explain \"trait-constrained variation\"                                           #> conditionTE    \"trait-constrained variation explained by the condition in formulaEnv\"  #> constraintsTE  \"trait-constrained variation explained by the predictors in formulaEnv\""},{"path":"/reference/douconca-package.html","id":null,"dir":"Reference","previous_headings":"","what":"The package douconca performs double constrained correspondence analysis for trait-environment analysis in ecology — douconca-package","title":"The package douconca performs double constrained correspondence analysis for trait-environment analysis in ecology — douconca-package","text":"Double constrained correspondence analysis (dc-CA) analyzing (multi-)trait (multi-)environment ecological data using library vegan native R code. formula interface allows assess, example, importance trait interactions shaping ecological communities. function dc_CA option divide abundance data site site total, giving equal site weights. division advantage multivariate analysis corresponds unweighted (multi-trait) community-level analysis, instead weighted. Throughout two step algorithm ter Braak et al. (2018) used. algorithm combines extends community- (sample-) species-level analyses, .e. (1) usual community weighted means (CWM) regression analysis (2) species-level analysis species-niche centroids (SNC) regression analysis. SNC center realized niche species along environmental variable , case dc-CA, environmental gradient, .e. dc-CA ordination axis. Computationally, dc-CA can carried single singular value decomposition (ter Braak et al. 2018), computed two steps. first step uses canonical correspondence analysis (cca) regress (transposed) abundance data traits second step uses weighed redundancy analysis (wrda , equal site weights, rda) regress CWMs orthonormalized traits, obtained first step, environmental predictors. second step thus community-level analysis. divideBySiteTotals = FALSE, second step uses wrda performs weighted redundancy analysis CWMs environmental variables. Division abundance data site totals advantage resulting analysis (without dimension reduction, .e. retaining dc-CA axes) corresponds series unweighted community-level analyses, instead analyses weighted. Warning: dcCA package built vegan version 2.6-4 uses internal structure vegan cca.object -exported functions f_inertia get_QR source code file functions_using_cca_object_internals.r. main user-functions dc_CA, plot.dcca, scores.dcca, print.dcca anova.dcca.","code":""},{"path":"/reference/douconca-package.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"The package douconca performs double constrained correspondence analysis for trait-environment analysis in ecology — douconca-package","text":"ter Braak, CJF, Šmilauer P, Dray S. 2018. Algorithms biplots double constrained correspondence analysis. Environmental Ecological Statistics, 25(2), 171-197. doi:10.1007/s10651-017-0395-x Oksanen, J., et al. (2022) vegan: Community Ecology Package. R package version 2.6-4. https://CRAN.R-project.org/package=vegan.","code":""},{"path":[]},{"path":"/reference/douconca-package.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"The package douconca performs double constrained correspondence analysis for trait-environment analysis in ecology — douconca-package","text":"Maintainer: Bart-Jan van Rossum bart-jan.vanrossum@wur.nl (ORCID) Authors: Cajo J.F ter Braak cajo.terbraak@wur.nl (ORCID)","code":""},{"path":"/reference/dune_trait_env.html","id":null,"dir":"Reference","previous_headings":"","what":"Dune meadow data with plant species traits and environmental variables — dune_trait_env","title":"Dune meadow data with plant species traits and environmental variables — dune_trait_env","text":"data dune_trait_env contains three data frames abundance data 28 plant species 20 samples (relevés), trait data (9 traits: 5 morphological 4 ecological (Ellenberg indicator values) environmental data (9 environmental variables, four geographic coordinates). Compared data Jongman et al. (1987, 1995), two moss species lacking, traits plant species geographic coordinates samples added. data following description edited version DataKey Jamil2013_AJ data set CESTES database (Jeliazkov et al. 2020). Dune Meadow Data originate MSc thesis report Batterink & Wijffels (1983). consisted 80 relevés 68 dune meadows (lots) island Terschelling Netherlands. subset data selected Caspar Looman example data set edited book Jongman, ter Braak van Tongeren (1987, 1995). subset consists 20 relevés, 28 species (2 mosses, excluded ) 5 environmental variables. trait data taken LEDA database  Jamil et al 2013. spatial coordinates retrieved geo-referencing GIS maps Batterink & Wijffels (1993) Ruut Wegman Cajo ter Braak. X, Y coordinates geo-referencing relevé locations Kaart 3a, 3b 3c; X_lot, Y_lot coordinates Kaart 2a, 2b 2c. Ellenberg indicator values see Ellenberg (1992). data dune_trait_env list elements data frames comm:   community data; vegetation data. traits: trait data, taken LEDA database. envir:  environmental data, taken Jongman et al. (1987,1995). community data collection done Braun-Blanquet method; data recorded according ordinal scale van der Maarel (1979, Vegetatio, 39, 97-114); see pages XVII-XVIII 18 Jongman, ter Braak & van Tongeren 1995. Nomenclature follows Heukels-Van der Meijden (1983) Flora van Nederland, 20th ed. morphological traits SLA:\t    Specific Leaf Area Height:\t  Canopy height shoot LDMC:  \t  Leaf dry matter content Seedmass:\tSeed mass Lifespan:\tLife span. Nominal; annual vs. perennial ecological traits (habitat requirements) Ellenberg values F:\t    Moisture (ranging [1 12] (low high)) R:\t    Soil acidity, ranging [1 9] (acidic alkaline) N:  \t  Nitrogen requirement, ranging [1 9] (low high) L:\t    Light requirement, ranging [1 9] (low high) data frame envir contains environmental variables A1:    horizon thickness Moist:\tMoisture content soil (five point scale) Mag:    Grassland management type Use:\ttype use (Agricultural grassland use (1) hay production (2) intermediate (3) grazing) Manure:\tQuantity manure applied based N P manuring (N/P class B&W 1983) X:\tlongitude\tgeographical coordinates (m) 2x2 m2 sample (relevé) Y:\tlatitude\tgeographical coordinates (m) 2x2 m2 sample (relevé) X_lot:\tlongitude\tgeographical coordinates (m) lot center Y_lot:  latitude\tgeographical coordinates (m) lot center management types standard farming (SF), biological farming (BF), hobby farming (HF), nature conservation management (NM). coordinates Rijksdriehoekscoordinaten meters. https://nl.wikipedia.org/wiki/Rijksdriehoekscoordinaten","code":""},{"path":"/reference/dune_trait_env.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Dune meadow data with plant species traits and environmental variables — dune_trait_env","text":"Batterink, M. & Wijffels, G. (1983) Een vergelijkend vegetatiekundig onderzoek naar de typologie en invloeden van het beheer van 1973 tot 1982 de duinweilanden op Terschelling. Landbouwhogeschool. ISN 215909.01. WUR library stacks 704B58. Ellenberg, H. (1992) Indicator values plants Central Europe. Scripta Geobotanica, 18, 258 pp. Jamil, T., Ozinga, W.., Kleyer, M. & ter Braak, C.J.F. (2013) Selecting traits explain species–environment relationships: generalized linear mixed model approach. Journal Vegetation Science, 24, 988-1000. doi:10.1111/j.1654-1103.2012.12036.x . Jeliazkov, ., Mijatovic, D., 78 others. (2020) global database metacommunity ecology, integrating species, traits, environment space. Scientific Data, 7. doi:10.1038/s41597-019-0344-7 . Jongman, R.H.G., ter Braak, C.J.F. & van Tongeren, O.F.R. (1987) Data analysis community landscape ecology. Pudoc, Wageningen. ISBN 90-220-0908-4. Jongman, R.H.G., ter Braak, C.J.F. & van Tongeren, O.F.R. (1995) Data analysis community landscape ecology. Cambridge University Press, Cambridge. ISBN 0-521-47574-0. https://edepot.wur.nl/248017. Kleyer, M., 33 others (2008) LEDA Traitbase: database life-history traits Northwest European flora. Journal Ecology, 96, 1266-1274. doi:10.1111/j.1365-2745.2008.01430.x .","code":""},{"path":"/reference/fCWM_SNC.html","id":null,"dir":"Reference","previous_headings":"","what":"Calculate community weighted means and species niche centroids for double constrained correspondence analysis — fCWM_SNC","title":"Calculate community weighted means and species niche centroids for double constrained correspondence analysis — fCWM_SNC","text":"Double constrained correspondence analysis (dc-CA) can calculated directly community weighted means (CWMs), trait data CWMs calculated, environmental data weights species sites (abundance totals species sites). Statistical testing species level requires also species niche centroids (SNCs). function fCWM_SNC calculates CWMs SNCs trait environmental data, respectively, using formula interface, allow categorical traits environmental variables. resulting object can set response argument dc_CA give output call dc_CA abundance data response, least sign changes axes.","code":""},{"path":"/reference/fCWM_SNC.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Calculate community weighted means and species niche centroids for double constrained correspondence analysis — fCWM_SNC","text":"","code":"fCWM_SNC(   response = NULL,   dataEnv = NULL,   dataTraits = NULL,   formulaEnv = NULL,   formulaTraits = NULL,   divideBySiteTotals = NULL )"},{"path":"/reference/fCWM_SNC.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Calculate community weighted means and species niche centroids for double constrained correspondence analysis — fCWM_SNC","text":"response matrix, data frame abundance data (dimension n x m) list community weighted means (CWMs) fCWM_SNC, NULL. NULL, response left-hand side formulaEnv. See Details analyses starting community weighted means. Rownames response, , carried . dataEnv matrix data frame row predictors, rows corresponding response. (dimension n x p). dataTraits matrix data frame column predictors, rows corresponding columns response. (dimension m x q). formulaEnv two-sided one-sided formula rows (samples) row predictors dataEnv. left hand side formula ignored specified response argument. Specify row covariates () adding + Condition(covariate-formula) formulaEnv rda. covariate-formula contain ~ (tilde). Default: NULL ~., .e. variables dataEnv predictor variables. formulaTraits formula one-sided formula columns (species) column predictors dataTraits. two-sided, left hand side formula used. Specify column covariates () adding + Condition(covariate-formula) formulaTraits cca. covariate-formula contain ~ (tilde). Default: NULL ~., .e. variables dataTraits predictor traits. divideBySiteTotals logical; default TRUE closing data dividing rows response total. However, default FALSE, species totals proportional N2*(N-N2) N2 Hill numbers order 2 species N number sites, indicator response data pre-processed N2-based marginals using ipf2N2.","code":""},{"path":"/reference/fCWM_SNC.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Calculate community weighted means and species niche centroids for double constrained correspondence analysis — fCWM_SNC","text":"default returns list CWM, SNC, weights, formulaTraits, inertia (weighted variance explained traits environmental variables) list data elements dataEnv dataTraits.","code":""},{"path":"/reference/fCWM_SNC.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Calculate community weighted means and species niche centroids for double constrained correspondence analysis — fCWM_SNC","text":"argument formulaTraits determines CWMs calculated. CWMs calculated trait data (non-centered, non-standardized). trait covariates, predictor traits adjusted trait covariates weighted regression, overall weighted mean trait added. advantage CWM scale original trait. SNCs calculated analogously environmental data. Empty (zero) rows columns response removed response corresponding rows dataEnv dataTraits. Subsequently, columns missing values removed  dataEnv dataTraits. gives error (object 'name_of_variable' found), variables missing entries specified formulaEnv formulaTraits. current implementation, formulaEnv formulaTraits contain variable names , .e. transformations variables formulas gives error ('undefined columns selected') scores function applied.","code":""},{"path":"/reference/fCWM_SNC.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Calculate community weighted means and species niche centroids for double constrained correspondence analysis — fCWM_SNC","text":"Kleyer, M., Dray, S., Bello, F., Lepš, J., Pakeman, R.J., Strauss, B., Thuiller, W. & Lavorel, S. (2012) Assessing species community functional responses environmental gradients: multivariate methods? Journal Vegetation Science, 23, 805-821. doi:10.1111/j.1654-1103.2012.01402.x ter Braak, CJF, Šmilauer P, Dray S. 2018. Algorithms biplots double constrained correspondence analysis. Environmental Ecological Statistics, 25(2), 171-197. doi:10.1007/s10651-017-0395-x ter Braak C.J.F.  P. Šmilauer  (2018). Canoco reference manual user's guide: software ordination (version 5.1x). Microcomputer Power, Ithaca, USA, 536 pp. Oksanen, J., et al. (2022) vegan: Community Ecology Package. R package version 2.6-4. https://CRAN.R-project.org/package=vegan.","code":""},{"path":[]},{"path":"/reference/fCWM_SNC.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Calculate community weighted means and species niche centroids for double constrained correspondence analysis — fCWM_SNC","text":"","code":"data(\"dune_trait_env\")  # rownames are carried forward in results rownames(dune_trait_env$comm) <- dune_trait_env$comm$Sites  CWMSNC <- fCWM_SNC(formulaEnv = ~ A1 + Moist + Manure + Use + Condition(Mag),                    formulaTraits = ~ SLA + Height + LDMC + Condition(Seedmass) + Lifespan,                    response = dune_trait_env$comm[, -1],  # must delete \"Sites\"                    dataEnv = dune_trait_env$envir,                    dataTraits = dune_trait_env$traits) names(CWMSNC) #> [1] \"CWM\"           \"SNC\"           \"formulaEnv\"    \"formulaTraits\" #> [5] \"inertia\"       \"weights\"       \"call\"          \"data\"          #CWMSNC$SNC <- NULL # would give correct dc-CA but no species-level t-values or test mod <- dc_CA(response = CWMSNC) # formulas and data are in CWMSNC! #> Step 1: the CCA ordination of the transposed matrix with trait constraints, #>         useful in itself and also yielding CWMs of the orthonormalized traits for step 2. #> NULL #> Step 2: the RDA ordination of CWMs of the orthonormalized traits  #>         of step 1 with environmental constraints: #> Call: rda(formula = out1$CWMs_orthonormal_traits ~ A1 + Moist + Manure + #> Use + Condition(Mag), data = out1$data$dataEnv) #>  #> -- Model Summary -- #>  #>               Inertia Proportion Rank #> Total          0.5109     1.0000      #> Conditional    0.1794     0.3512    3 #> Constrained    0.1377     0.2695    4 #> Unconstrained  0.1938     0.3793    4 #>  #> Inertia is variance #>  #> -- Eigenvalues -- #>  #> Eigenvalues for constrained axes: #>    RDA1    RDA2    RDA3    RDA4  #> 0.07351 0.03911 0.02064 0.00442  #>  #> Eigenvalues for unconstrained axes: #>     PC1     PC2     PC3     PC4  #> 0.11386 0.04942 0.01888 0.01162  #>  #> mean, sd, VIF and canonical coefficients with their optimistic [!] t-values: #>         Avg    SDS    VIF  Regr1  tval1 #> MagBF  0.15 0.3571 4.5016 0.1152 0.7224 #> MagHF  0.25 0.4330 2.6715 0.0658 0.5359 #> MagNM  0.30 0.4583 9.5666 0.0046 0.0199 #> A1     4.85 2.1240 1.6967 0.1562 1.5958 #> Moist  2.90 1.7578 1.7658 0.1492 1.4946 #> Manure 1.75 1.4448 9.3847 0.0320 0.1388 #> Use    1.90 0.7681 1.7825 0.1020 1.0172 #>                        Avg     SDS    VIF   Regr1   tval1 #> Seedmass            0.6543  0.6688 1.0784 -0.0724 -0.1662 #> SLA                24.6468  6.3438 1.1888 -0.4217 -0.9226 #> Height             25.1272 15.6848 1.3033  0.5546  1.1589 #> LDMC              244.5084 70.9729 1.1791 -0.8979 -1.9726 #> Lifespanperennial   0.9607  0.1944 1.0964  0.3589  0.8176 #>  #>                weighted variance #> traits_explain             0.511 #> env_explain                0.691 #> conditionTE                0.179 #> constraintsTE              0.138 #> attr(,\"meaning\") #>                meaning                                                                 #> traits_explain \"trait-constrained variation\"                                           #> env_explain    \"environment-constrained variation\"                                     #> conditionTE    \"trait-constrained variation explained by the condition in formulaEnv\"  #> constraintsTE  \"trait-constrained variation explained by the predictors in formulaEnv\" # note that output also gives the environment-constrained inertia, # which is a bonus compare to the usual way to carry out a dcCA. anova(mod) #> $species #> Species-level permutation test using dc-CA #> Model: dc_CA(response = CWMSNC)  #> Residualized predictor permutation #>  #>          df ChiSquare      R2      F Pr(>F) #> dcCA      4   0.13769 0.22615 1.6073  0.176 #> Residual 22   0.47115                       #>  #> $sites #>          Df ChiSquare      R2      F Pr(>F)   #> dcCA1     4   0.13769 0.41538 2.1316  0.034 * #> Residual 12   0.19379                         #> --- #> Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1 #>  #> $maxP #> Max test combining the community- and species- level tests  #> Model: dc_CA(response = CWMSNC)  #>  #> Taken from the species-level test: #> Residualized predictor permutation #> Permutation: free #> Number of permutations: 999 #>  #>          df ChiSquare      R2      F Pr(>F) #> dcCA      4   0.13769 0.22615 1.6073  0.176 #> Residual 22   0.47115                       #>"},{"path":"/reference/fN2.html","id":null,"dir":"Reference","previous_headings":"","what":"Hill number of order 2: N2 — fN2","title":"Hill number of order 2: N2 — fN2","text":"Calculate Hill number N2.","code":""},{"path":"/reference/fN2.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Hill number of order 2: N2 — fN2","text":"","code":"fN2(x)"},{"path":"/reference/fN2.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Hill number of order 2: N2 — fN2","text":"x numeric vector.","code":""},{"path":"/reference/fN2.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Hill number of order 2: N2 — fN2","text":"scalar: Hill number N2.","code":""},{"path":"/reference/fN2.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Hill number of order 2: N2 — fN2","text":"Hill,M.O. (1973). Diversity evenness: unifying notation consequences. Ecology, 54, 427-432. doi:10.2307/1934352 . ter Braak, C.J.F. (2019). New robust weighted averaging- model-based methods assessing trait-environment relationships. Methods Ecology Evolution, 10 (11), 1962-1971. doi:10.1111/2041-210X.13278 .","code":""},{"path":"/reference/fN2.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Hill number of order 2: N2 — fN2","text":"","code":"data(\"dune_trait_env\")  # rownames are carried forward in results rownames(dune_trait_env$comm) <- dune_trait_env$comm$Sites Y <- dune_trait_env$comm[, -1] # must delete \"Sites\" Y_N2 <- ipf2N2(Y, updateN2 = FALSE, N2N_N2_species = FALSE) attr(Y_N2, \"iter\") # 4 #> [1] 4  # show that column margins of the transform matrix are # equal to the Hill N2 values diff(range(colSums(Y_N2) / apply(X = Y, MARGIN = 2, FUN = fN2))) #  8.881784e-16 #> [1] 8.881784e-16 diff(range(rowSums(Y_N2) / apply(X = Y, MARGIN = 1, FUN = fN2))) #  0.07077207 #> [1] 0.07077207  Y_N2i <- ipf2N2(Y, updateN2 = TRUE, N2N_N2_species = FALSE) attr(Y_N2i, \"iter\") # 5 #> [1] 5 diff(range(colSums(Y_N2i) / apply(X = Y_N2i, MARGIN = 2, FUN = fN2))) # 2.220446e-15 #> [1] 2.220446e-15 diff(range(rowSums(Y_N2i) / apply(X = Y_N2i, MARGIN = 1, FUN = fN2))) # 0.105742 #> [1] 0.105742  # the default version: Y_N2N_N2i <- ipf2N2(Y) # ie.  # Y_N2N_N2i <- ipf2N2(Y, updateN2 = TRUE, N2N_N2_species = TRUE) attr(Y_N2N_N2i, \"iter\") # 16 #> [1] 16 N2 <- apply(X = Y_N2N_N2i, MARGIN = 2, FUN = fN2) N <- nrow(Y) diff(range(colSums(Y_N2N_N2i) / (N2 * (N - N2)))) # 2.220446e-16 #> [1] 2.220446e-16  N2_sites <- apply(X = Y_N2N_N2i, MARGIN = 1, FUN = fN2) R <- rowSums(Y_N2N_N2i) N * max(N2_sites / sum(N2_sites) - R / sum(R)) # 0.009579165 #> [1] 0.009579165  sum(Y_N2N_N2i) - sum(Y) #> [1] 0  mod0 <- dc_CA(formulaEnv = ~ A1 + Moist + Mag + Use + Manure,               formulaTraits = ~ SLA + Height + LDMC + Seedmass + Lifespan,               response = Y,                 dataEnv = dune_trait_env$envir,               dataTraits = dune_trait_env$traits,                divide = FALSE,               verbose = FALSE)  mod1 <- dc_CA(formulaEnv = ~ A1 + Moist + Mag + Use + Manure,               formulaTraits = ~ SLA + Height + LDMC + Seedmass + Lifespan,               response = Y_N2N_N2i,                 dataEnv = dune_trait_env$envir,               dataTraits = dune_trait_env$traits,                verbose = FALSE) #> Argument divideBySiteTotals set to FALSE, as species totals are proportional to N2(N-N2). #> You can overrule this by specifying divideBySiteTotals explicitly.  mod1$eigenvalues / mod0$eigenvalues #>     dcCA1     dcCA2     dcCA3     dcCA4     dcCA5  #> 1.2131999 1.3273601 1.3471699 1.5570817 0.8440445  # ratios of eigenvalues greater than 1, # indicate axes with higher (squared) fourth-corner correlation  # ipf2N2 for a presence-absence data matrix                                    Y_PA <- 1 * (Y > 0) Y_PA_N2 <- ipf2N2(Y_PA, N2N_N2_species = FALSE) attr(Y_PA_N2, \"iter\") # 1 #> [1] 1 diff(range(Y_PA - Y_PA_N2)) # 4.440892e-16, i.e no change #> [1] 4.440892e-16  Y_PA_N2i <- ipf2N2(Y_PA, N2N_N2_species = TRUE) attr(Y_PA_N2i, \"iter\") # 9 #> [1] 9 N_occ <- colSums(Y_PA) # number of occurrences of species N <- nrow(Y_PA) plot(N_occ, colSums(Y_PA_N2i))  cor(colSums(Y_PA_N2i), N_occ * (N - N_occ)) # 0.9916 #> [1] 0.9916937 mod2 <- dc_CA(formulaEnv = ~ A1 + Moist + Mag + Use + Manure,               formulaTraits = ~ SLA + Height + LDMC + Seedmass + Lifespan,               response = Y_PA,                 dataEnv = dune_trait_env$envir,               dataTraits = dune_trait_env$traits,               divideBySiteTotals = FALSE,               verbose = FALSE)          mod3 <- dc_CA(formulaEnv = ~ A1 + Moist + Mag + Use + Manure,               formulaTraits = ~ SLA + Height + LDMC + Seedmass + Lifespan,               response = Y_PA_N2i,                 dataEnv = dune_trait_env$envir,               dataTraits = dune_trait_env$traits,               verbose = FALSE) #> Argument divideBySiteTotals set to FALSE, as species totals are proportional to N2(N-N2). #> You can overrule this by specifying divideBySiteTotals explicitly.          mod3$eigenvalues / mod2$eigenvalues #>    dcCA1    dcCA2    dcCA3    dcCA4    dcCA5  #> 1.612991 1.320169 1.609431 1.680960 1.311264  # ratios of eigenvalues greater than 1, # indicate axes with higher (squared) fourth-corner correlation"},{"path":"/reference/fitted.dcca.html","id":null,"dir":"Reference","previous_headings":"","what":"Fitted values of double-constrained correspondence analysis (dc-CA) — fitted.dcca","title":"Fitted values of double-constrained correspondence analysis (dc-CA) — fitted.dcca","text":"Community weighted means (CWM) species-niche centroids (SNC), fitted (full reduced rank) environmental data trait data, respectively, fitted response trait environment data.","code":""},{"path":"/reference/fitted.dcca.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Fitted values of double-constrained correspondence analysis (dc-CA) — fitted.dcca","text":"","code":"# S3 method for class 'dcca' fitted(object, ..., type = c(\"CWM\", \"SNC\", \"response\"), rank = \"full\")"},{"path":"/reference/fitted.dcca.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Fitted values of double-constrained correspondence analysis (dc-CA) — fitted.dcca","text":"object return value dc_CA. ... arguments passed function (currently ignored). type type prediction, c( \"CWM\",\"SNC\", \"response\") environmental values, values traits, response (expected abundance). rank rank (number axes use). Default \"full\" axes (rank-reduction).","code":""},{"path":"/reference/fitted.dcca.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Fitted values of double-constrained correspondence analysis (dc-CA) — fitted.dcca","text":"matrix fitted value. exact content matrix depends type fits asked .","code":""},{"path":"/reference/fitted.dcca.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Fitted values of double-constrained correspondence analysis (dc-CA) — fitted.dcca","text":"type=\"response\" rowsums object$data$Y used scale fit sums. Many predicted response values may negative,  indicating expected absences (0) small expected response values.","code":""},{"path":"/reference/fitted.dcca.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Fitted values of double-constrained correspondence analysis (dc-CA) — fitted.dcca","text":"","code":"data(\"dune_trait_env\")  # rownames are carried forward in results rownames(dune_trait_env$comm) <- dune_trait_env$comm$Sites  mod <- dc_CA(formulaEnv = ~ A1 + Moist + Mag + Use + Condition(Manure),              formulaTraits = ~ SLA + Height + LDMC + Condition(Seedmass) + Lifespan,              response = dune_trait_env$comm[, -1],  # must delete \"Sites\"              dataEnv = dune_trait_env$envir,              dataTraits = dune_trait_env$traits,               verbose = FALSE) # fit the mean traits at each site (20x6), # that is CWM at each site CWM.traits <- fitted(mod, type = \"CWM\") head(CWM.traits) #>             SLA   Height     LDMC Lifespanannual Lifespanperennial #> Site_1 24.69054 23.04477 262.1525    0.047500047         0.9525000 #> Site_2 26.58938 22.47821 248.9740   -0.001033559         1.0010336 #> Site_3 24.27447 25.82005 259.4974    0.028101542         0.9718985 #> Site_4 24.25886 25.74429 259.7835    0.029235611         0.9707644 #> Site_5 26.80648 26.21316 241.2643    0.017241993         0.9827580 #> Site_6 26.11737 22.44992 230.8071    0.049338100         0.9506619  # fit the mean environment for each species (28x8) # that is SNC of each species SNC.env <- fitted(mod, type = \"SNC\") head(SNC.env) #>                              A1    Moist     MagSF     MagBF     MagHF #> Achillea millefolium   5.342999 3.326274 0.2987008 0.1012023 0.2658685 #> Agrostis stolonifera   4.529007 2.576826 0.2877323 0.1864249 0.2361958 #> Aira praecox           3.642275 2.771151 0.4244468 0.1056802 0.1759198 #> Alopecurus geniculatus 4.774155 2.531686 0.2733250 0.2228758 0.2796069 #> Anthoxanthum odoratum  3.917107 2.475008 0.3079576 0.1444949 0.1555197 #> Bellis perennis        4.651703 2.424855 0.2610354 0.2306304 0.2703286 #>                            MagNM      Use #> Achillea millefolium   0.3342285 2.102427 #> Agrostis stolonifera   0.2896470 1.794929 #> Aira praecox           0.2939532 1.624523 #> Alopecurus geniculatus 0.2241924 1.874519 #> Anthoxanthum odoratum  0.3920278 1.618153 #> Bellis perennis        0.2380056 1.944774  fit.resp <- fitted(mod, type = \"response\") # fitted often gives negative values and dc_CA cannot have negatives in the  # response so, modify fit.resp, # which gives about similar eigenvalues as the original data fit.resp[fit.resp < 0] <- 0 mod3 <- dc_CA(formulaEnv = mod$formulaEnv,               formulaTraits = mod$formulaTraits,               response = fit.resp,                dataEnv = dune_trait_env$envir,               dataTraits = dune_trait_env$traits,                verbose = FALSE) mod3$eigenvalues / mod$eigenvalues #>     dcCA1     dcCA2     dcCA3     dcCA4  #> 0.8803851 0.8934459 0.8390431 0.7971850"},{"path":"/reference/getPlotdata.html","id":null,"dir":"Reference","previous_headings":"","what":"Utility function: extracting data from a dc_CA object for plotting a single axis by your own code or plot.dcca. — getPlotdata","title":"Utility function: extracting data from a dc_CA object for plotting a single axis by your own code or plot.dcca. — getPlotdata","text":"getPlotdata extracts data dc_CA object plotting CWMs SNCs single axis.","code":""},{"path":"/reference/getPlotdata.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Utility function: extracting data from a dc_CA object for plotting a single axis by your own code or plot.dcca. — getPlotdata","text":"","code":"getPlotdata(   x,   axis = 1,   envfactor = NULL,   traitfactor = NULL,   newnames = NULL,   facet = TRUE,   remove_centroids = FALSE )"},{"path":"/reference/getPlotdata.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Utility function: extracting data from a dc_CA object for plotting a single axis by your own code or plot.dcca. — getPlotdata","text":"x results dc_CA class dcca. axis axis number get (default 1). envfactor name row factor display color lines CWM plot (default NULL). default extracts factor environmental model. set NA, additional coloring lines displayed plot.dcca. parameter sets groups variable CWM_SNC data frame return value/plot. traitfactor name column factor display color lines SNC plot (default NULL). default extracts factor trait model. set NA, additional coloring lines displayed plot.dcca. parameter sets groups variable CWM_SNC data frame return value/plot. newnames list  two elements: names traits environmental variables, default NULL names derived result scores.dcca tidy = TRUE. facet logical. Default TRUE CWMs SNCs plots separate panels. FALSE, parameter changes position environmental centroid names (left right). remove_centroids logical remove centroids plot data (default FALSE). Can two-vector, e.g. c(TRUE, FALSE) remove trait centroids.","code":""},{"path":"/reference/getPlotdata.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Utility function: extracting data from a dc_CA object for plotting a single axis by your own code or plot.dcca. — getPlotdata","text":"list three components CWM_SNC data.frame containing plot data trait_env_scores vector scores per trait/environment newNameList vector new names used plot","code":""},{"path":"/reference/getPlotdata.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Utility function: extracting data from a dc_CA object for plotting a single axis by your own code or plot.dcca. — getPlotdata","text":"current implementation sets traitfactor NA trait model contains single trait factor envfactor NA environmental model contains single environmental factor.","code":""},{"path":"/reference/getPlotdata.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Utility function: extracting data from a dc_CA object for plotting a single axis by your own code or plot.dcca. — getPlotdata","text":"","code":"data(\"dune_trait_env\")  # rownames are carried forward in results rownames(dune_trait_env$comm) <- dune_trait_env$comm$Sites  # must delete \"Sites\" from response matrix or data frame Y <- dune_trait_env$comm[, -1] # must delete \"Sites\"  out <- dc_CA(formulaEnv = ~ A1 + Moist + Use + Manure + Mag,                    formulaTraits = ~ SLA + Height + LDMC + Seedmass + Lifespan,                    response = Y,                    dataEnv = dune_trait_env$envir,                    dataTraits = dune_trait_env$traits,                    verbose = FALSE) dat <- getPlotdata(out) names(dat) #> [1] \"CWM_SNC\"          \"trait_env_scores\" \"oldNameList\"      \"newNameList\"      names(dat$CWM_SNC) #>  [1] \"dcCA1\"         \"score\"         \"label\"         \"CWM-SNC\"       #>  [5] \"weight\"        \"type\"          \"points\"        \"sizeweight\"    #>  [9] \"smoothweight\"  \"xforsmooth\"    \"groups\"        \"names\"         #> [13] \"centroidnames\" levels(dat$CWM_SNC$groups) #> [1] \"SF\"        \"BF\"        \"HF\"        \"NM\"        \"annual\"    \"perennial\"  plot(out)"},{"path":"/reference/ipf2N2.html","id":null,"dir":"Reference","previous_headings":"","what":"Iterative proportional fitting of an abundance table to Hill-N2 marginals — ipf2N2","title":"Iterative proportional fitting of an abundance table to Hill-N2 marginals — ipf2N2","text":"Function preprocessing/transforming abundance table iterative proportional fitting, transformed table marginals N2 N2(N-N2) N number elements margin. Hill-N2 effective number species. intrinsic interest weighted averaging (CWM SNC) variance approximately inversely proportional N2 (ter Braak 2019), therefore interest dc_CA.","code":""},{"path":"/reference/ipf2N2.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Iterative proportional fitting of an abundance table to Hill-N2 marginals — ipf2N2","text":"","code":"ipf2N2(   Y,   max_iter = 100,   updateN2 = TRUE,   N2N_N2_species = TRUE,   N2N_N2_sites = FALSE,   crit = 0.01 )"},{"path":"/reference/ipf2N2.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Iterative proportional fitting of an abundance table to Hill-N2 marginals — ipf2N2","text":"Y abundance table (matrix dataframe-like), ideally, names rows columns. BEWARE: rows columns positive sums! max_iter maximum number iterative proportional fitting (ipf) iterations. updateN2 logical, default TRUE. FALSE marginal sums proportional N2-marginals initial table, N2-marginals returned matrix may equal marginal sum. updateN2 = TRUE N2N_N2_species=TRUE (default), column marginals N2(N-N2)/2 N number sites. row sums proportional , term, effective number informative species. N2N_N2_species = FALSE, returned transformed table N2 columns marginals, .e. colSums(Y2) = const*N2species(Y2) Y2 return value ipf2N2 const constant. converged, N2 row marginals equal row sums, .e. rowSums(Y2) = approx. N2sites(Y2). N2N_N2_species Set marginals proportional N2(N-N2) Default TRUE. N2N_N2_sites Default FALSE. change. crit stopping criterion.","code":""},{"path":"/reference/ipf2N2.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Iterative proportional fitting of an abundance table to Hill-N2 marginals — ipf2N2","text":"matrix order input Y, obtained ipf N2-marginals.","code":""},{"path":"/reference/ipf2N2.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Iterative proportional fitting of an abundance table to Hill-N2 marginals — ipf2N2","text":"Applying ipf2N2 N2N_N2_species=FALSE presence-absence data table returns table. However, species occurs everywhere (sites) informative. acknowledged default option N2N_N2_species=TRUE. , N2N_N2_species=TRUE, species occur halve number sites -weighted, row sum longer equal richness site (number species), proportional number informative species.","code":""},{"path":"/reference/ipf2N2.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Iterative proportional fitting of an abundance table to Hill-N2 marginals — ipf2N2","text":"ter Braak, C.J.F. (2019). New robust weighted averaging- model-based methods assessing trait-environment relationships. Methods Ecology Evolution, 10 (11), 1962-1971. doi:10.1111/2041-210X.13278","code":""},{"path":"/reference/ipf2N2.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Iterative proportional fitting of an abundance table to Hill-N2 marginals — ipf2N2","text":"","code":"data(\"dune_trait_env\")  # rownames are carried forward in results rownames(dune_trait_env$comm) <- dune_trait_env$comm$Sites Y <- dune_trait_env$comm[, -1] # must delete \"Sites\" Y_N2 <- ipf2N2(Y, updateN2 = FALSE, N2N_N2_species = FALSE) attr(Y_N2, \"iter\") # 4 #> [1] 4  # show that column margins of the transform matrix are # equal to the Hill N2 values diff(range(colSums(Y_N2) / apply(X = Y, MARGIN = 2, FUN = fN2))) #  8.881784e-16 #> [1] 8.881784e-16 diff(range(rowSums(Y_N2) / apply(X = Y, MARGIN = 1, FUN = fN2))) #  0.07077207 #> [1] 0.07077207  Y_N2i <- ipf2N2(Y, updateN2 = TRUE, N2N_N2_species = FALSE) attr(Y_N2i, \"iter\") # 5 #> [1] 5 diff(range(colSums(Y_N2i) / apply(X = Y_N2i, MARGIN = 2, FUN = fN2))) # 2.220446e-15 #> [1] 2.220446e-15 diff(range(rowSums(Y_N2i) / apply(X = Y_N2i, MARGIN = 1, FUN = fN2))) # 0.105742 #> [1] 0.105742  # the default version: Y_N2N_N2i <- ipf2N2(Y) # ie.  # Y_N2N_N2i <- ipf2N2(Y, updateN2 = TRUE, N2N_N2_species = TRUE) attr(Y_N2N_N2i, \"iter\") # 16 #> [1] 16 N2 <- apply(X = Y_N2N_N2i, MARGIN = 2, FUN = fN2) N <- nrow(Y) diff(range(colSums(Y_N2N_N2i) / (N2 * (N - N2)))) # 2.220446e-16 #> [1] 2.220446e-16  N2_sites <- apply(X = Y_N2N_N2i, MARGIN = 1, FUN = fN2) R <- rowSums(Y_N2N_N2i) N * max(N2_sites / sum(N2_sites) - R / sum(R)) # 0.009579165 #> [1] 0.009579165  sum(Y_N2N_N2i) - sum(Y) #> [1] 0  mod0 <- dc_CA(formulaEnv = ~ A1 + Moist + Mag + Use + Manure,               formulaTraits = ~ SLA + Height + LDMC + Seedmass + Lifespan,               response = Y,                 dataEnv = dune_trait_env$envir,               dataTraits = dune_trait_env$traits,                divide = FALSE,               verbose = FALSE)  mod1 <- dc_CA(formulaEnv = ~ A1 + Moist + Mag + Use + Manure,               formulaTraits = ~ SLA + Height + LDMC + Seedmass + Lifespan,               response = Y_N2N_N2i,                 dataEnv = dune_trait_env$envir,               dataTraits = dune_trait_env$traits,                verbose = FALSE) #> Argument divideBySiteTotals set to FALSE, as species totals are proportional to N2(N-N2). #> You can overrule this by specifying divideBySiteTotals explicitly.  mod1$eigenvalues / mod0$eigenvalues #>     dcCA1     dcCA2     dcCA3     dcCA4     dcCA5  #> 1.2131999 1.3273601 1.3471699 1.5570817 0.8440445  # ratios of eigenvalues greater than 1, # indicate axes with higher (squared) fourth-corner correlation  # ipf2N2 for a presence-absence data matrix                                    Y_PA <- 1 * (Y > 0) Y_PA_N2 <- ipf2N2(Y_PA, N2N_N2_species = FALSE) attr(Y_PA_N2, \"iter\") # 1 #> [1] 1 diff(range(Y_PA - Y_PA_N2)) # 4.440892e-16, i.e no change #> [1] 4.440892e-16  Y_PA_N2i <- ipf2N2(Y_PA, N2N_N2_species = TRUE) attr(Y_PA_N2i, \"iter\") # 9 #> [1] 9 N_occ <- colSums(Y_PA) # number of occurrences of species N <- nrow(Y_PA) plot(N_occ, colSums(Y_PA_N2i))  cor(colSums(Y_PA_N2i), N_occ * (N - N_occ)) # 0.9916 #> [1] 0.9916937 mod2 <- dc_CA(formulaEnv = ~ A1 + Moist + Mag + Use + Manure,               formulaTraits = ~ SLA + Height + LDMC + Seedmass + Lifespan,               response = Y_PA,                 dataEnv = dune_trait_env$envir,               dataTraits = dune_trait_env$traits,               divideBySiteTotals = FALSE,               verbose = FALSE)          mod3 <- dc_CA(formulaEnv = ~ A1 + Moist + Mag + Use + Manure,               formulaTraits = ~ SLA + Height + LDMC + Seedmass + Lifespan,               response = Y_PA_N2i,                 dataEnv = dune_trait_env$envir,               dataTraits = dune_trait_env$traits,               verbose = FALSE) #> Argument divideBySiteTotals set to FALSE, as species totals are proportional to N2(N-N2). #> You can overrule this by specifying divideBySiteTotals explicitly.          mod3$eigenvalues / mod2$eigenvalues #>    dcCA1    dcCA2    dcCA3    dcCA4    dcCA5  #> 1.612991 1.320169 1.609431 1.680960 1.311264  # ratios of eigenvalues greater than 1, # indicate axes with higher (squared) fourth-corner correlation"},{"path":"/reference/plot.dcca.html","id":null,"dir":"Reference","previous_headings":"","what":"Plot a single dc-CA axis with CWMs, SNCs, trait and environment scores. — plot.dcca","title":"Plot a single dc-CA axis with CWMs, SNCs, trait and environment scores. — plot.dcca","text":"plot.dcca plots CWMs SNCs dc-CA axis axis, optional centroids colors groups sites /species available data.","code":""},{"path":"/reference/plot.dcca.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Plot a single dc-CA axis with CWMs, SNCs, trait and environment scores. — plot.dcca","text":"","code":"# S3 method for class 'dcca' plot(   x,   ...,   axis = 1,   gradient_description = \"correlation\",   envfactor = NULL,   traitfactor = NULL,   nspecies = 20,   species_groups = NULL,   widths = c(5, 1, 1),   newnames = NULL,   facet = TRUE,   remove_centroids = FALSE,   with_lines = 2,   flip_axis = FALSE,   expand = 0.2,   formula = y ~ x,   verbose = TRUE )"},{"path":"/reference/plot.dcca.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Plot a single dc-CA axis with CWMs, SNCs, trait and environment scores. — plot.dcca","text":"x results dc_CA class dcca. ... unused. axis axis number get (default 1). gradient_description character 2-character vector trait environmental gradient, respectively specifying plot vertical line plots describe dc-CA axis (trait environmental gradients). Default: correlation intra-set correlations sets variables dc-CA axis. values : c(\"weights\", \"tvalues\", \"inter_set_correlation\") regression weights, t-values inter-set correlation, correlation SNCs CWMs traits environmental variables, respectively. \"regression\" alias \"weights\". envfactor name row factor display color lines CWM plot (default NULL). default extracts factor environmental model. set NA, additional coloring lines displayed plot.dcca. parameter sets groups variable CWM_SNC data frame return value/plot. traitfactor name column factor display color lines SNC plot (default NULL). default extracts factor trait model. set NA, additional coloring lines displayed plot.dcca. parameter sets groups variable CWM_SNC data frame return value/plot. nspecies integer. Default 20 including vertical species plot nspecies highest contribution. species_groups name variable dataTraits dc_CA. Default NULL grouping. Species groups colored differentially. widths relative widths CWM-SNC plot, correlation/weight plot species plot. (see grid.arrange). Default c(5, 1, 1). newnames list  two elements: names traits environmental variables, default NULL names derived result scores.dcca tidy = TRUE. facet logical. Default TRUE CWMs SNCs plots separate panels. parameter changes position centroid names (left right environmental centroids). facet = FALSE with_lines = TRUE, line fits ignore groups species sites. remove_centroids logical remove centroids plot data (default FALSE). Can two-vector, e.g. c(TRUE, FALSE) remove trait centroids. with_lines integer values (0,1,2). Default 2 straight lines groups points, confidence intervals around lines. with_lines=1 drops confidence intervals with_lines=0 suppresses lines. flip_axis flip direction axis? (default FALSE). expand amount extension line plot (default 0.2). formula formula use ggplot geom_smooth (default y~x). verbose logical. Default TRUE plotting result.","code":""},{"path":"/reference/plot.dcca.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Plot a single dc-CA axis with CWMs, SNCs, trait and environment scores. — plot.dcca","text":"ggplot object","code":""},{"path":"/reference/plot.dcca.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Plot a single dc-CA axis with CWMs, SNCs, trait and environment scores. — plot.dcca","text":"current implementation distinguish groups points, two factors specified model. want label one trait factor, specify traitfactor=\"yourfactor\" similarly specify envfactor=\"yourfactor\" environmental factor. lines plotted single factor defines model. want set new names, look names arguments default, .e. myplot <- plot(x), consult myplot$nameList$newnames order names traits environmental variables. Note covariates list names. Contribution (definition species selection nspecies) defined (CA) total species abundance (possibly, closed) data multiplied square score axis. plot.dcca returns error \"Error grid.Call\", enlarge plotting area use verbose = FALSE assign result.","code":""},{"path":"/reference/plot.dcca.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Plot a single dc-CA axis with CWMs, SNCs, trait and environment scores. — plot.dcca","text":"","code":"data(\"dune_trait_env\")  # rownames are carried forward in results rownames(dune_trait_env$comm) <- dune_trait_env$comm$Sites  # must delete \"Sites\" from response matrix or data frame Y <- dune_trait_env$comm[, -1] # must delete \"Sites\"  out <- dc_CA(formulaEnv = ~ A1 + Moist + Use + Manure + Mag,                    formulaTraits = ~ SLA + Height + LDMC + Seedmass + Lifespan,                    response = Y,                    dataEnv = dune_trait_env$envir,                    dataTraits = dune_trait_env$traits,                    verbose = FALSE) dat <- getPlotdata(out) names(dat) #> [1] \"CWM_SNC\"          \"trait_env_scores\" \"oldNameList\"      \"newNameList\"      names(dat$CWM_SNC) #>  [1] \"dcCA1\"         \"score\"         \"label\"         \"CWM-SNC\"       #>  [5] \"weight\"        \"type\"          \"points\"        \"sizeweight\"    #>  [9] \"smoothweight\"  \"xforsmooth\"    \"groups\"        \"names\"         #> [13] \"centroidnames\" levels(dat$CWM_SNC$groups) #> [1] \"SF\"        \"BF\"        \"HF\"        \"NM\"        \"annual\"    \"perennial\"  plot(out)"},{"path":"/reference/plot_dcCA_CWM_SNC.html","id":null,"dir":"Reference","previous_headings":"","what":"Plot the CWMs and SNCs of a single dc-CA axis. — plot_dcCA_CWM_SNC","title":"Plot the CWMs and SNCs of a single dc-CA axis. — plot_dcCA_CWM_SNC","text":"plot_dcCA_CWM_SNC plots CWMs SNCs dc-CA axis axis, optional centroids colors groups sites /species available data.","code":""},{"path":"/reference/plot_dcCA_CWM_SNC.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Plot the CWMs and SNCs of a single dc-CA axis. — plot_dcCA_CWM_SNC","text":"","code":"plot_dcCA_CWM_SNC(   x,   axis = 1,   envfactor = NULL,   traitfactor = NULL,   facet = TRUE,   newnames = NULL,   remove_centroids = FALSE,   with_lines = 2,   formula = y ~ x,   getPlotdata2plotdCCA = NULL )"},{"path":"/reference/plot_dcCA_CWM_SNC.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Plot the CWMs and SNCs of a single dc-CA axis. — plot_dcCA_CWM_SNC","text":"x results dc_CA class dcca. axis axis number get (default 1). envfactor name row factor display color lines CWM plot (default NULL). default extracts factor environmental model. set NA, additional coloring lines displayed plot.dcca. parameter sets groups variable CWM_SNC data frame return value/plot. traitfactor name column factor display color lines SNC plot (default NULL). default extracts factor trait model. set NA, additional coloring lines displayed plot.dcca. parameter sets groups variable CWM_SNC data frame return value/plot. facet logical. Default TRUE CWMs SNCs plots separate panels. parameter changes position centroid names (left right environmental centroids). facet = TRUE with_lines = TRUE, line fits ignore groups species sites. newnames list  two elements: names traits environmental variables, default NULL names derived result scores.dcca tidy = TRUE. remove_centroids logical remove centroids plot data (default FALSE). Can two-vector, e.g. c(TRUE, FALSE) remove trait centroids. with_lines integer values (0,1,2). Default 2 straight lines groups points, confidence intervals around lines. with_lines=1 drops confidence intervals with_lines=0 suppresses lines. formula formula use ggplot geom_smooth (default y~x). getPlotdata2plotdCCA results getPlotdata. Default NULL.","code":""},{"path":"/reference/plot_dcCA_CWM_SNC.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Plot the CWMs and SNCs of a single dc-CA axis. — plot_dcCA_CWM_SNC","text":"ggplot object","code":""},{"path":"/reference/plot_dcCA_CWM_SNC.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Plot the CWMs and SNCs of a single dc-CA axis. — plot_dcCA_CWM_SNC","text":"argument getPlotdata2plotdCCA allow modifications data frame resulting getPlotdata. variable names score levels remain untouched. plot_dcCA_CWM_SNC uses variables: dcCAk axis number k \"CWM-SNC\", \"groups\", \"points\", \"sizeweight\" y-axis, coloring, shape size items, respectively. current implementation distinguish groups points, two factors specified model. lines plotted  single factor defines model. function used plot.dcca.","code":""},{"path":"/reference/plot_dcCA_CWM_SNC.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Plot the CWMs and SNCs of a single dc-CA axis. — plot_dcCA_CWM_SNC","text":"","code":"data(\"dune_trait_env\")  # rownames are carried forward in results rownames(dune_trait_env$comm) <- dune_trait_env$comm$Sites  # must delete \"Sites\" from response matrix or data frame Y <- dune_trait_env$comm[, -1] # must delete \"Sites\"  out <- dc_CA(formulaEnv = ~ A1 + Moist + Use + Manure + Condition(Mag),              formulaTraits = ~ SLA + Height + LDMC + Seedmass + Lifespan,              response = Y,              dataEnv = dune_trait_env$envir,              dataTraits = dune_trait_env$traits,              verbose = FALSE)  plot_dcCA_CWM_SNC(out, facet = FALSE)"},{"path":"/reference/plot_species_scores_bk.html","id":null,"dir":"Reference","previous_headings":"","what":"Vertical ggplot2 line plot of ordination scores — plot_species_scores_bk","title":"Vertical ggplot2 line plot of ordination scores — plot_species_scores_bk","text":"plot_species_scores_bk creates vertical line plot ordination scores selection criterion scores plot names.","code":""},{"path":"/reference/plot_species_scores_bk.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Vertical ggplot2 line plot of ordination scores — plot_species_scores_bk","text":"","code":"plot_species_scores_bk(   species_scores,   ylab = \"scores\",   threshold = 7,   y_lab_interval = 0.5,   speciesname = NULL,   scoresname = \"RDA1\",   selectname = \"Fratio1\",   speciesgroup = NULL,   expand = 0.2,   verbose = TRUE )"},{"path":"/reference/plot_species_scores_bk.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Vertical ggplot2 line plot of ordination scores — plot_species_scores_bk","text":"species_scores species--scores matrix, data frame row names (species names) tibble variable name speciesname containing species names column variable name scoresname containing scores (default: \"RDA1\"), e.g. species scores library vegan. ylab y-axis label. Default: $b_k$. threshold species criterion (specified selectname) higher threshold displayed. Default: 7 (threshold F-ratio testing single regression coefficient p = 0.01 60 df error multiple regression single species onto condition ordination axis). selectname species_scores, threshold divided 14, default 0.5. y_lab_interval interval y-axis ticks. tick effect (0) always included; default: 0.5. speciesname name variable containing species names (default NULL uses row names). scoresname name column variable containing species scores plotted (default \"RDA1\"). selectname name column variable containing criterion selection species displayed. Default: \"Fratio1\"; selectname found species_scores, set scoresname. speciesgroup name factor, levels receive different colors vertical plot. expand amount extension line plot (default 0.2). verbose logical printing number species names total number (default: TRUE).","code":""},{"path":"/reference/plot_species_scores_bk.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Vertical ggplot2 line plot of ordination scores — plot_species_scores_bk","text":"ggplot object","code":""},{"path":"/reference/plot_species_scores_bk.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Vertical ggplot2 line plot of ordination scores — plot_species_scores_bk","text":"absolute value criterion values taken selection, also species scores ordination can serve criterion (e.g. selectname = \"RDA1\"). function copied PRC package https://github.com/CajoterBraak/PRC. function used plot.dcca.","code":""},{"path":"/reference/plot_species_scores_bk.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Vertical ggplot2 line plot of ordination scores — plot_species_scores_bk","text":"","code":"data(\"dune_trait_env\")  # rownames are carried forward in results rownames(dune_trait_env$comm) <- dune_trait_env$comm$Sites  mod <- dc_CA(formulaEnv = ~A1 + Moist + Mag + Use + Manure,              formulaTraits = ~ SLA + Height + LDMC + Seedmass + Lifespan,              response = dune_trait_env$comm[, -1],  # must delete \"Sites\"              dataEnv = dune_trait_env$envir,              dataTraits = dune_trait_env$traits,              verbose = FALSE)  env_scores <- scores(mod, display = \"tval\")  env_scores <- data.frame(env_scores) env_scores$group <- c(\"quantitative\", \"category\")[c(1, 1, 2, 2, 2, 1, 1)]                   plot_species_scores_bk(   species_scores = env_scores,   ylab = \"optimistic t-values\",  threshold = 0,  y_lab_interval = 1,   scoresname = \"dcCA1\", speciesgroup = \"group\", verbose = FALSE )"},{"path":"/reference/predict.dcca.html","id":null,"dir":"Reference","previous_headings":"","what":"Prediction for double-constrained correspondence analysis (dc-CA) — predict.dcca","title":"Prediction for double-constrained correspondence analysis (dc-CA) — predict.dcca","text":"Prediction traits environment, environment traits response trait environment data.","code":""},{"path":"/reference/predict.dcca.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Prediction for double-constrained correspondence analysis (dc-CA) — predict.dcca","text":"","code":"# S3 method for class 'dcca' predict(   object,   ...,   type = c(\"envFromTraits\", \"traitsFromEnv\", \"response\", \"SNC\", \"CWM\", \"lc\", \"lc_traits\"),   rank = \"full\",   newdata = NULL,   weights = NULL,   scaling = \"symmetric\" )"},{"path":"/reference/predict.dcca.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Prediction for double-constrained correspondence analysis (dc-CA) — predict.dcca","text":"object return value dc_CA. ... arguments passed function (currently ignored). type type prediction, c(\"envFromTraits\", \"traitsFromEnv\", \"response\", \"lc\", \"lc_traits\") environmental values, values traits, response (expected abundance) constrained scores sites species. \"SNC\" equivalent \"envFromTraits\". \"CWM\" equivalent \"traitsFromEnv\". rank rank (number axes use). Default \"full\" axes (rank-reduction). newdata Data look variables predict. type = \"envFromTraits\" \"traitsFromEnv\" type = \"lc_traits\" \"lc\", newdata data frame trait environmental values, respectively, used prediction calculation scores. omitted, fitted values generated (use fitted.dcca instead). type = \"response\", newdata list two data frames trait environmental values order, e.g. list(traits = dataTraits, env = dataEnv). weights list weights species sites newdata type = \"response\", else ignored (default NULL yielding equal species site weights, summing 1). Example: weights = list(species = c(100, 1, 1), sites = c(1, 1, 1, 1)), order, traits three new species newdata[[1]] environmental values (levels factors) four new sites newdata[[2]]. Species weights scaled sum one. scaling numeric (1,2 3) character \"sites\", \"species\" \"symmetric\". Default: \"symmetric\". Either site- (1) species- (2) related scores scaled eigenvalues, set scores unit weighted mean square 3 scaled symmetrically weighted mean squares equal square root eigenvalues. Negative values treated corresponding positive ones abs(scaling).","code":""},{"path":"/reference/predict.dcca.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Prediction for double-constrained correspondence analysis (dc-CA) — predict.dcca","text":"matrix predictions. exact content matrix depends type predictions made.","code":""},{"path":"/reference/predict.dcca.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Prediction for double-constrained correspondence analysis (dc-CA) — predict.dcca","text":"Variables model newdata set weighted means training data. Predictions thus (weighted) mean quantitative variables included. Predictions -included factors reference level (first level factor). type = \"response\", many predicted values may negative, indicating expected absences (0) small expected response values. type = \"traitsFromEnv\" newdata = NULL, predict gives  fitted mean traits, .e. fitted community weighted means. type = \"envFromTraits\" newdata = NULL, predict gives  fitted mean environment, .e. fitted species niche centroids (see fitted.dcca). See fitted.dcca.","code":""},{"path":"/reference/predict.dcca.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Prediction for double-constrained correspondence analysis (dc-CA) — predict.dcca","text":"","code":"data(\"dune_trait_env\")  # rownames are carried forward in results rownames(dune_trait_env$comm) <- dune_trait_env$comm$Sites  mod <- dc_CA(formulaEnv = ~ A1 + Moist + Mag + Use + Condition(Manure),              formulaTraits = ~ SLA + Height + LDMC + Condition(Seedmass) + Lifespan,              response = dune_trait_env$comm[, -1],  # must delete \"Sites\"              dataEnv = dune_trait_env$envir,              dataTraits = dune_trait_env$traits,              verbose = FALSE)  # Ten 'new' sites with a subset of the variables in mod  # X_lot will be ignored as it is not part of the model newEnv <- dune_trait_env$envir[1:10, c(\"A1\", \"Mag\", \"Manure\", \"X_lot\")] newEnv[2,\"A1\"] <- 3.0 rownames(newEnv) <- paste0(\"NewSite\", 1:10)  pred.traits <- predict(mod, type = \"traitsFromEnv\", newdata = newEnv) #> Warning: newdata does not contain the predictor variables #>  Moist,Use #> These are set at their mean values and, #> for factors, at the reference level #> The current formula is #>  ~ Manure + A1 + Moist + Mag + Use head(pred.traits) #>               SLA   Height     LDMC Lifespanannual Lifespanperennial #> NewSite1 23.49280 26.38356 266.8780   0.0420223885         0.9579776 #> NewSite2 25.31359 25.43822 255.1297  -0.0008408709         1.0008409 #> NewSite3 23.72696 27.51990 262.5873   0.0250113500         0.9749886 #> NewSite4 23.71135 27.44414 262.8733   0.0261454193         0.9738546 #> NewSite5 25.23184 27.30383 229.8117   0.0211790573         0.9788209 #> NewSite6 24.91963 25.78871 235.5326   0.0438604419         0.9561396   # Eight 'new' species with a subset of traits that are included in the model  # Variable \"L\" will be ignored as it is not in the model  newTraits <- dune_trait_env$traits[1:8, c(\"Species\", \"SLA\", \"LDMC\", \"L\")] newTraits[3,\"SLA\"]<- 18  rownames(newTraits) <- paste(\"Species\",LETTERS[1:8] )# or another meaningful name.  pred.env <- predict(mod, type = \"envFromTraits\", newdata = newTraits) #> Warning: newdata does not contain the predictor variables #>  Height,Lifespan,Seedmass #> These are set at their mean values and, #> for factors, at the reference level #> The current formula is #>  ~ Seedmass + SLA + Height + LDMC + Lifespan head(pred.env) #>                 A1    Moist     MagSF     MagBF     MagHF     MagNM      Use #> Species A 4.418925 3.099357 0.4193545 0.1162310 0.2567447 0.2076698 1.792234 #> Species B 3.655381 2.386016 0.4099394 0.1990894 0.2308547 0.1601165 1.487752 #> Species C 3.932918 2.921976 0.4313648 0.1056551 0.2053991 0.2575811 1.618013 #> Species D 3.891226 2.356745 0.3966054 0.2306193 0.2703075 0.1024678 1.564131 #> Species E 3.133064 2.374767 0.4345196 0.1466711 0.1530670 0.2657424 1.313215 #> Species F 4.117969 2.529417 0.3968530 0.2149759 0.2829311 0.1052401 1.651777   pred.resp <- predict(mod, type = \"response\", newdata = list(newTraits, newEnv),                      weights = list(species = rep(1:2, 4), sites = rep(1, 10))) #> Warning: newdata does not contain the predictor variables #>  Height,Lifespan,Seedmass #> These are set at their mean values and, #> for factors, at the reference level #> The current formula is #>  ~ Seedmass + SLA + Height + LDMC + Lifespan #> Warning: newdata does not contain the predictor variables #>  Moist,Use #> These are set at their mean values and, #> for factors, at the reference level #> The current formula is #>  ~ Manure + A1 + Moist + Mag + Use colSums(pred.resp) # about alternating 0.8 and 1.6 (reflecting the new species weights) #> Species A Species B Species C Species D Species E Species F Species G Species H  #> 0.6754447 1.4335014 0.7063500 1.3996597 0.7529561 1.3738211 0.7113281 1.3499565  rowSums(pred.resp) # about equal rowsums #>   NewSite1   NewSite2   NewSite3   NewSite4   NewSite5   NewSite6   NewSite7  #>  0.9528552  0.1295043  0.5920024  0.6160593  0.7202928  1.2014298  0.1325513  #>   NewSite8   NewSite9  NewSite10  #> -0.2042446  2.7755022  1.4870650"},{"path":"/reference/predict.wrda.html","id":null,"dir":"Reference","previous_headings":"","what":"Prediction from cca0 and wrda models — predict.wrda","title":"Prediction from cca0 and wrda models — predict.wrda","text":"Prediction response lc scores environment data using cca0 wrda models.","code":""},{"path":"/reference/predict.wrda.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Prediction from cca0 and wrda models — predict.wrda","text":"","code":"# S3 method for class 'wrda' predict(   object,   ...,   type = c(\"response\", \"lc\"),   rank = \"full\",   newdata = NULL,   weights = NULL,   scaling = \"symmetric\" )"},{"path":"/reference/predict.wrda.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Prediction from cca0 and wrda models — predict.wrda","text":"object return value cca0 wrda. ... arguments passed function (currently ignored). type type prediction, c( \"response\", \"lc\") response (expected abundance) constrained scores sites. rank rank (number axes use). Default \"full\" axes (rank-reduction). newdata Data look variables predict. weights list weights species sites newdata type = \"response\", else ignored (default NULL yielding equal species site weights, summing 1). Example: weights = list(species = c(100, 1, 1), sites = c(1, 1, 1, 1)), order, traits three new species newdata[[1]] environmental values (levels factors) four new sites newdata[[2]]. Species weights scaled sum one. scaling numeric (1,2 3) character \"sites\", \"species\" \"symmetric\". Default: \"symmetric\". Either site- (1) species- (2) related scores scaled eigenvalues, set scores unit weighted mean square 3 scaled symmetrically weighted mean squares equal square root eigenvalues. Negative values treated corresponding positive ones abs(scaling).","code":""},{"path":"/reference/predict.wrda.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Prediction from cca0 and wrda models — predict.wrda","text":"matrix predictions. exact content matrix depends type predictions made.","code":""},{"path":"/reference/predict.wrda.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Prediction from cca0 and wrda models — predict.wrda","text":"Variables model newdata set weighted means training data. Predictions thus (weighted) mean quantitative variables included. Predictions -included factors reference level (first level factor). cca0 model type = \"response\", many predicted values may negative, indicating expected absences (0) small expected response values.","code":""},{"path":"/reference/predict.wrda.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Prediction from cca0 and wrda models — predict.wrda","text":"","code":"data(\"dune_trait_env\")  # rownames are carried forward in results rownames(dune_trait_env$comm) <- dune_trait_env$comm$Sites abun <- dune_trait_env$comm[, -1]  # must delete \"Sites\"  mod <- cca0(formula = abun ~ A1 + Moist + Mag + Use + Manure,             data = dune_trait_env$envir)  mod # Proportions equal to those Canoco 5.15 #> Call: cca0(formula = abun ~ A1 + Moist + Mag + Use + Manure, data = #> dune_trait_env$envir) #>  #> -- Model Summary -- #>  #>               Inertia Proportion Rank #> Total          2.1866     1.0000      #> Constrained    1.2511     0.5722    7 #> Unconstrained  0.9355     0.4278   19 #>  #> Inertia is scaled Chi-square #>  #> -- Eigenvalues -- #>  #> Eigenvalues for constrained axes: #>   CCA1   CCA2   CCA3   CCA4   CCA5   CCA6   CCA7  #> 0.4759 0.3241 0.1764 0.1313 0.0690 0.0412 0.0333  #>  #> Eigenvalues for unconstrained axes: #> CA1 CA2 CA3 CA4 CA5 CA6 CA7 CA8  #>  NA  NA  NA  NA  NA  NA  NA  NA  #> (Showing 8 of 19 unconstrained eigenvalues) #>  #> mean, sd, VIF and canonical coefficients with their optimistic [!] t-values: #>           Avg    SDS    VIF   Regr1   tval1 #> A1     4.6363 1.8096 1.5022 -0.0962 -1.2237 #> Moist  2.7604 1.7163 1.7279 -0.5275 -6.2574 #> MagBF  0.1773 0.3819 4.7947  0.0107  0.0758 #> MagHF  0.3179 0.4657 2.9965  0.1034  0.9314 #> MagNM  0.2029 0.4021 7.1714 -0.1599 -0.9308 #> Use    1.9042 0.7523 1.6739 -0.1310 -1.5794 #> Manure 1.9521 1.3534 7.8029 -0.0354 -0.1975 #>   scores(mod, which_cor = c(\"A1\", \"X_lot\"), display = \"cor\") #>            wRDA1       wRDA2 #> A1    -0.5433670  0.15530408 #> X_lot -0.1808011 -0.08064616 #> attr(,\"meaning\") #> [1] \"inter set correlation, correlation between environmental variables and the sites scores (CWMs)\"  set.seed(123) anova(mod) #> $table #> Permutation test for canonical correspondence analysis #> Model: cca0(formula = abun ~ A1 + Moist + Mag + Use + Manure, data = dune_trait_env$envir)  #> Residualized predictor permutation #> Permutation: free #> Number of permutations: 999 #>  #>          df ChiSquare      R2      F Pr(>F)     #> cca       7   1.25113 0.57218 2.2927  0.001 *** #> Residual 12   0.93548                           #> --- #> Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1 #>  #> $eigenvalues #>       cca1       cca2       cca3       cca4       cca5       cca6       cca7  #> 0.47593373 0.32414453 0.17637629 0.13125103 0.06899011 0.04116257 0.03326681  #>  anova(mod, by = \"axis\") #> $table #> Permutation test for canonical correspondence analysis #> Model: cca0(formula = abun ~ A1 + Moist + Mag + Use + Manure, data = dune_trait_env$envir)  #> Residualized predictor permutation #> Permutation: free #> Number of permutations: 999 #>  #>          df ChiSquare       R2      F Pr(>F)    #> cca1      1   0.47593 0.217659 6.1051  0.002 ** #> cca2      1   0.32414 0.148241 4.1580  0.018 *  #> cca3      1   0.17638 0.080662 2.2625  0.236    #> cca4      1   0.13125 0.060025 1.6836  0.404    #> cca5      1   0.06899 0.031551 0.8850  0.951    #> cca6      1   0.04116 0.018825 0.5280  0.996    #> cca7      1   0.03327 0.015214 0.4267  0.996    #> Residual 12   0.93548                           #> --- #> Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1 #>  #> $eigenvalues #>       cca1       cca2       cca3       cca4       cca5       cca6       cca7  #> 0.47593373 0.32414453 0.17637629 0.13125103 0.06899011 0.04116257 0.03326681  #>   mod2 <- vegan::cca(abun ~ A1 + Moist + Mag + Use + Manure,                    data = dune_trait_env$envir) anova(mod2, by = \"axis\") #> Permutation test for cca under reduced model #> Forward tests for axes #> Permutation: free #> Number of permutations: 999 #>  #> Model: cca(formula = abun ~ A1 + Moist + Mag + Use + Manure, data = dune_trait_env$envir) #>          Df ChiSquare      F Pr(>F)     #> CCA1      1   0.47593 6.1051  0.001 *** #> CCA2      1   0.32414 4.1580  0.037 *   #> CCA3      1   0.17638 2.2625  0.724     #> CCA4      1   0.13125 1.6836  0.987     #> CCA5      1   0.06899 0.8850  1.000     #> CCA6      1   0.04116 0.5280            #> CCA7      1   0.03327 0.4267            #> Residual 12   0.93548                   #> --- #> Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1  dat <- dune_trait_env$envir dat$Mag <- \"SF\" predict(mod, type = \"lc\", newdata = dat) #>              wRDA1     wRDA2       wRDA3       wRDA4       wRDA5       wRDA6 #> Site_1   0.6904890 0.2738131  0.85706483  0.21494213  0.04961136  0.72100459 #> Site_2   0.7086329 0.2734695  0.33481865 -1.07270103 -1.35928061  0.53160107 #> Site_3   0.2244798 0.5945085  0.60570803  0.44083874  0.37245365  0.46727185 #> Site_4   0.2308792 0.5789014  0.63318079  0.42798545  0.35582702  0.47363638 #> Site_5   0.7391771 0.6853586 -0.03558872 -0.62800472 -0.21511036 -0.01408255 #> Site_6   0.6574380 0.3983263  0.11503656 -0.96987465 -1.22626765  0.48068489 #> Site_7   0.5122323 0.2441261  0.29326645 -0.55866996 -1.39165267  1.01605565 #> Site_8  -1.0574335 0.8089811  0.55158630 -0.24633521 -0.86510811  0.29389272 #> Site_9  -0.1730258 0.4845439  0.99593856 -1.55170714 -1.18971277 -0.39582562 #> Site_10  0.5926090 0.2489378  0.78436035 -1.66931462 -1.40310518 -0.05383772 #> Site_11  0.5303763 0.2437824 -0.22897973 -1.84631313 -2.80054465  0.82665213 #> Site_12 -0.5486085 0.8921994  0.18514902 -0.67778374 -0.75653943 -0.08957766 #> Site_13 -0.9628957 1.0647992  0.45590655  0.06982812  0.11279594 -0.18814568 #> Site_14 -1.2893919 1.4405532 -1.34442983 -1.65724140 -2.30506793 -0.24797572 #> Site_15 -1.2204515 1.7587997 -1.55000063 -1.28966488 -1.26065740 -0.75547220 #> Site_16 -1.1534240 1.0430876  0.13949487 -0.05353574 -0.61570879  0.19842488 #> Site_17  0.5792832 0.3033908  0.42708259 -2.26814966 -2.04935800 -0.17081531 #> Site_18  0.9109057 0.3104445  0.10151139 -2.22412702 -2.02304124 -0.05073754 #> Site_19 -0.5115748 0.5163361  0.99170477 -2.20741811 -1.87890897 -0.62651646 #> Site_20 -0.4987760 0.4851219  1.04665030 -2.23312471 -1.91216221 -0.61378742 #>               wRDA7 #> Site_1  -0.21001080 #> Site_2  -0.96564817 #> Site_3  -0.19205750 #> Site_4  -0.18164028 #> Site_5  -1.37467944 #> Site_6  -1.04898590 #> Site_7  -0.43402001 #> Site_8   0.11698515 #> Site_9  -0.92255561 #> Site_10 -1.22930984 #> Site_11 -1.18965737 #> Site_12 -0.68260950 #> Site_13 -0.18787396 #> Site_14 -1.43836815 #> Site_15 -1.78489613 #> Site_16 -0.03927309 #> Site_17 -1.64358878 #> Site_18 -1.88030362 #> Site_19 -1.08970250 #> Site_20 -1.06886806"},{"path":"/reference/print.dcca.html","id":null,"dir":"Reference","previous_headings":"","what":"Print a summary of a dc-CA object. — print.dcca","title":"Print a summary of a dc-CA object. — print.dcca","text":"Print summary dc-CA object.","code":""},{"path":"/reference/print.dcca.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Print a summary of a dc-CA object. — print.dcca","text":"","code":"# S3 method for class 'dcca' print(x, ...)"},{"path":"/reference/print.dcca.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Print a summary of a dc-CA object. — print.dcca","text":"x dc-CA object dc_CA. ... arguments passed function (currently ignored).","code":""},{"path":"/reference/print.dcca.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Print a summary of a dc-CA object. — print.dcca","text":"return value, results printed console.","code":""},{"path":"/reference/print.dcca.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Print a summary of a dc-CA object. — print.dcca","text":"x <- print(x) efficient scores.dcca just print(x) dc_CA called verbose = FALSE).","code":""},{"path":"/reference/print.dcca.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Print a summary of a dc-CA object. — print.dcca","text":"","code":"data(\"dune_trait_env\")  # rownames are carried forward in results rownames(dune_trait_env$comm) <- dune_trait_env$comm$Sites abun <- dune_trait_env$comm[, -1]  # must delete \"Sites\" mod <- dc_CA(formulaEnv = abun ~ A1 + Moist + Mag + Use + Manure,              formulaTraits = ~ SLA + Height + LDMC + Seedmass + Lifespan,              dataEnv = dune_trait_env$envir,              dataTraits = dune_trait_env$traits,        verbose = FALSE)  print(mod) # same output as with verbose = TRUE (the default of verbose).                                      #> Step 1: the CCA ordination of the transposed matrix with trait constraints, #>         useful in itself and also yielding CWMs of the orthonormalized traits for step 2. #> Call: cca0(formula = formulaTraits, response = tY, data = #> out0$data$dataTraits) #>  #> -- Model Summary -- #>  #>               Inertia Proportion Rank #> Total          2.3490     1.0000      #> Constrained    0.6776     0.2885    5 #> Unconstrained  1.6714     0.7115   19 #>  #> Inertia is scaled Chi-square #>  #> -- Eigenvalues -- #>  #> Eigenvalues for constrained axes: #>    CCA1    CCA2    CCA3    CCA4    CCA5  #> 0.26839 0.19597 0.12356 0.07003 0.01967  #>  #> Eigenvalues for unconstrained axes: #> CA1 CA2 CA3 CA4 CA5 CA6 CA7 CA8  #>  NA  NA  NA  NA  NA  NA  NA  NA  #> (Showing 8 of 19 unconstrained eigenvalues) #>  #> mean, sd, VIF and canonical coefficients with their optimistic [!] t-values: #>                        Avg     SDS    VIF   Regr1   tval1 #> SLA                24.6468  6.3438 1.1888  0.4401  4.1794 #> Height             25.1272 15.6848 1.3033  0.1283  1.1640 #> LDMC              244.5084 70.9729 1.1791  0.0278  0.2647 #> Seedmass            0.6543  0.6688 1.0784  0.3708  3.6980 #> Lifespanperennial   0.9607  0.1944 1.0964 -0.0578 -0.5718 #>  #> Step 2: the RDA ordination of CWMs of the orthonormalized traits  #>         of step 1 with environmental constraints: #> Call: rda(formula = out1$CWMs_orthonormal_traits ~ A1 + Moist + Mag + Use + #> Manure, data = out1$data$dataEnv) #>  #> -- Model Summary -- #>  #>               Inertia Proportion Rank #> Total          0.6776     1.0000      #> Constrained    0.4454     0.6573    5 #> Unconstrained  0.2322     0.3427    5 #>  #> Inertia is variance #>  #> -- Eigenvalues -- #>  #> Eigenvalues for constrained axes: #>    RDA1    RDA2    RDA3    RDA4    RDA5  #> 0.23680 0.10903 0.05934 0.03792 0.00233  #>  #> Eigenvalues for unconstrained axes: #>     PC1     PC2     PC3     PC4     PC5  #> 0.12017 0.05836 0.03455 0.01337 0.00575  #>  #> mean, sd, VIF and canonical coefficients with their optimistic [!] t-values: #>         Avg    SDS    VIF   Regr1   tval1 #> A1     4.85 2.1240 1.6967 -0.0605 -0.9172 #> Moist  2.90 1.7578 1.7658  0.3250  4.8293 #> MagBF  0.15 0.3571 4.5016 -0.0475 -0.4421 #> MagHF  0.25 0.4330 2.6715 -0.0156 -0.1890 #> MagNM  0.30 0.4583 9.5666  0.1622  1.0352 #> Use    1.90 0.7681 1.7825  0.0219  0.3239 #> Manure 1.75 1.4448 9.3847 -0.1444 -0.9306 #>                        Avg     SDS    VIF   Regr1   tval1 #> SLA                24.6468  6.3438 1.1888 -0.8196 -3.6933 #> Height             25.1272 15.6848 1.3033 -0.1598 -0.6877 #> LDMC              244.5084 70.9729 1.1791 -0.0562 -0.2542 #> Seedmass            0.6543  0.6688 1.0784 -0.7586 -3.5896 #> Lifespanperennial   0.9607  0.1944 1.0964  0.1006  0.4722 #>  #>                weighted variance #> total                      2.349 #> traits_explain             0.678 #> env_explain                1.323 #> constraintsTE              0.445 #> attr(,\"meaning\") #>                meaning                                                                 #> total          \"total inertia (= weighted variation)\"                                  #> traits_explain \"trait-constrained variation\"                                           #> env_explain    \"environment-constrained variation\"                                     #> constraintsTE  \"trait-constrained variation explained by the predictors in formulaEnv\" anova(mod, by = \"axis\") #> $species #> Species-level permutation test using dc-CA #> Model: dc_CA(formulaEnv = abun ~ A1 + Moist + Mag + Use + Manure, formulaTraits = ~SLA + Height + LDMC + Seedmass + Lifespan, dataEnv = dune_trait_env$envir, dataTraits = dune_trait_env$traits, verbose = FALSE)  #> Residualized predictor permutation #>  #>          df ChiSquare       R2      F Pr(>F) #> dcCA1     1   0.23680 0.179002 5.9370  0.118 #> dcCA2     1   0.10903 0.082419 2.7336  0.488 #> dcCA3     1   0.05934 0.044853 1.4877  0.778 #> dcCA4     1   0.03792 0.028663 0.9507  0.799 #> dcCA5     1   0.00233 0.001760 0.0584  0.999 #> Residual 22   0.87749                        #>  #> $sites #>          Df ChiSquare      R2       F Pr(>F)    #> dcCA1     1  0.236804 0.34946 14.2776  0.002 ** #> dcCA2     1  0.109032 0.16090  6.5739  0.101    #> dcCA3     1  0.059336 0.08757  3.5776  0.424    #> dcCA4     1  0.037919 0.05596  2.2863  0.680    #> dcCA5     1  0.002329 0.00344  0.1404  1.000    #> Residual 14  0.232199                           #> --- #> Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1 #>  #> $maxP #> Max test combining the community- and species- level tests  #> Model: dc_CA(formulaEnv = abun ~ A1 + Moist + Mag + Use + Manure, formulaTraits = ~SLA + Height + LDMC + Seedmass + Lifespan, dataEnv = dune_trait_env$envir, dataTraits = dune_trait_env$traits, verbose = FALSE)  #>  #> a mix the species- (traits) and community- (environment) levels: #>  #>       df ChiSquare traitP  envP Pr(>F) #> dcCA1  1  0.236804  0.118 0.002  0.118 #> dcCA2  1  0.109032  0.488 0.101  0.488 #> dcCA3  1  0.059336  0.778 0.424  0.778 #> dcCA4  1  0.037919  0.799 0.680  0.799 #> dcCA5  1  0.002329  0.999 1.000  1.000 #>  # For more demo on testing, see demo dune_test.r  mod_scores <- scores(mod) # correlation of axes with a variable that is not in the model scores(mod, display = \"cor\", scaling = \"sym\", which_cor = list(NULL, \"X_lot\")) #>           dcCA1      dcCA2 #> X_lot 0.1425494 0.06695038 #> attr(,\"meaning\") #> [1] \"inter set correlation, correlation between environmental variables and the sites scores (CWMs)\"  cat(\"head of unconstrained site scores, with meaning\\n\") #> head of unconstrained site scores, with meaning print(head(mod_scores$sites)) #>             dcCA1       dcCA2 #> Site_1 -1.2640026  0.19395232 #> Site_2 -0.7328822 -0.24929614 #> Site_3 -0.8250139 -0.44760064 #> Site_4 -0.4453407 -0.33741144 #> Site_5 -0.5783587  0.01524487 #> Site_6 -0.5722181  0.24340264  mod_scores_tidy <- scores(mod, tidy = TRUE) print(\"names of the tidy scores\") #> [1] \"names of the tidy scores\" print(names(mod_scores_tidy)) #> [1] \"dcCA1\"  \"dcCA2\"  \"score\"  \"label\"  \"weight\" cat(\"\\nThe levels of the tidy scores\\n\") #>  #> The levels of the tidy scores print(levels(mod_scores_tidy$score)) #>  [1] \"biplot\"                       \"biplot_traits\"                #>  [3] \"centroids\"                    \"centroids_traits\"             #>  [5] \"constraints_sites\"            \"constraints_species\"          #>  [7] \"correlation\"                  \"correlation_traits\"           #>  [9] \"factorbiplot\"                 \"factorbiplot_traits\"          #> [11] \"intra_set_correlation\"        \"intra_set_correlation_traits\" #> [13] \"regression\"                   \"regression_traits\"            #> [15] \"sites\"                        \"species\"                      #> [17] \"t_values\"                     \"t_values_traits\"               cat(\"\\nFor illustration: a dc-CA model with a trait covariate\\n\") #>  #> For illustration: a dc-CA model with a trait covariate mod2 <- dc_CA(formulaEnv = abun ~ A1 + Moist + Mag + Use + Manure,               formulaTraits = ~ SLA + Height + LDMC + Lifespan + Condition(Seedmass),               dataEnv = dune_trait_env$envir,               dataTraits = dune_trait_env$traits) #> Step 1: the CCA ordination of the transposed matrix with trait constraints, #>         useful in itself and also yielding CWMs of the orthonormalized traits for step 2. #> Call: cca0(formula = formulaTraits, response = tY, data = #> out0$data$dataTraits) #>  #> -- Model Summary -- #>  #>               Inertia Proportion Rank #> Total         2.34899    1.00000      #> Conditional   0.16671    0.07097    2 #> Constrained   0.51091    0.21750    4 #> Unconstrained 1.67137    0.71153   19 #>  #> Inertia is scaled Chi-square #>  #> -- Eigenvalues -- #>  #> Eigenvalues for constrained axes: #>    CCA1    CCA2    CCA3    CCA4  #> 0.21499 0.18622 0.07354 0.03616  #>  #> Eigenvalues for unconstrained axes: #> CA1 CA2 CA3 CA4 CA5 CA6 CA7 CA8  #>  NA  NA  NA  NA  NA  NA  NA  NA  #> (Showing 8 of 19 unconstrained eigenvalues) #>  #> mean, sd, VIF and canonical coefficients with their optimistic [!] t-values: #>                        Avg     SDS    VIF   Regr1   tval1 #> Seedmass            0.6543  0.6688 1.0784  0.0223  0.2225 #> SLA                24.6468  6.3438 1.1888  0.4456  4.2398 #> Height             25.1272 15.6848 1.3033  0.3532  3.2091 #> LDMC              244.5084 70.9729 1.1791 -0.1043 -0.9967 #> Lifespanperennial   0.9607  0.1944 1.0964 -0.0439 -0.4349 #>  #> Step 2: the RDA ordination of CWMs of the orthonormalized traits  #>         of step 1 with environmental constraints: #> Call: rda(formula = out1$CWMs_orthonormal_traits ~ A1 + Moist + Mag + Use + #> Manure, data = out1$data$dataEnv) #>  #> -- Model Summary -- #>  #>               Inertia Proportion Rank #> Total          0.5109     1.0000      #> Constrained    0.3171     0.6207    4 #> Unconstrained  0.1938     0.3793    4 #>  #> Inertia is variance #>  #> -- Eigenvalues -- #>  #> Eigenvalues for constrained axes: #>    RDA1    RDA2    RDA3    RDA4  #> 0.16632 0.08100 0.04766 0.02215  #>  #> Eigenvalues for unconstrained axes: #>     PC1     PC2     PC3     PC4  #> 0.11386 0.04942 0.01888 0.01162  #>  #> mean, sd, VIF and canonical coefficients with their optimistic [!] t-values: #>         Avg    SDS    VIF   Regr1   tval1 #> A1     4.85 2.1240 1.6967 -0.0920 -1.1424 #> Moist  2.90 1.7578 1.7658  0.1002  1.2204 #> MagBF  0.15 0.3571 4.5016  0.0125  0.0951 #> MagHF  0.25 0.4330 2.6715  0.0405  0.4006 #> MagNM  0.30 0.4583 9.5666  0.3052  1.5969 #> Use    1.90 0.7681 1.7825  0.0927  1.1234 #> Manure 1.75 1.4448 9.3847 -0.1567 -0.8277 #>                        Avg     SDS    VIF   Regr1   tval1 #> Seedmass            0.6543  0.6688 1.0784 -0.0929 -0.3874 #> SLA                24.6468  6.3438 1.1888 -1.0644 -4.2276 #> Height             25.1272 15.6848 1.3033 -0.5285 -2.0049 #> LDMC              244.5084 70.9729 1.1791  0.0433  0.1728 #> Lifespanperennial   0.9607  0.1944 1.0964  0.1744  0.7211 #>  #>                weighted variance #> total                      2.349 #> conditionT                 0.167 #> traits_explain             0.511 #> env_explain                1.323 #> constraintsTE              0.317 #> attr(,\"meaning\") #>                meaning                                                                 #> total          \"total inertia (= weighted variation)\"                                  #> conditionT     \"variation fitted by the trait condition\"                               #> traits_explain \"trait-constrained variation\"                                           #> env_explain    \"environment-constrained variation\"                                     #> constraintsTE  \"trait-constrained variation explained by the predictors in formulaEnv\"  cat(\"\\nFor illustration: a dc-CA model with both environmental and trait covariates\\n\") #>  #> For illustration: a dc-CA model with both environmental and trait covariates mod3 <- dc_CA(formulaEnv = abun ~ A1 + Moist + Use + Manure + Condition(Mag),               formulaTraits = ~ SLA + Height + LDMC + Lifespan + Condition(Seedmass),               dataEnv = dune_trait_env$envir,               dataTraits = dune_trait_env$traits,          verbose = FALSE)  cat(\"\\nFor illustration: same model but using dc_CA_object = mod2 for speed, \",      \"as the trait model and data did not change\\n\") #>  #> For illustration: same model but using dc_CA_object = mod2 for speed,  as the trait model and data did not change mod3B <- dc_CA(formulaEnv = abun ~ A1 + Moist + Use + Manure + Condition(Mag),                dataEnv = dune_trait_env$envir,                dc_CA_object = mod2,           verbose= FALSE) cat(\"\\ncheck on equality of mod3 (from data) and mod3B (from a dc_CA_object)\\n\",     \"the expected difference is in the component 'call'\\n \") #>  #> check on equality of mod3 (from data) and mod3B (from a dc_CA_object) #>  the expected difference is in the component 'call' #>    print(all.equal(mod3[-c(5,12)], mod3B[-c(5,12)])) #  only the component call differs #> [1] TRUE print(mod3$inertia[-c(3,5),]/mod3B$inertia) #        and mod3 has two more inertia items #>                weighted variance #> total                          1 #> conditionT                     1 #> traits_explain                 1 #> conditionTE                    1 #> constraintsTE                  1 #> attr(,\"meaning\") #>                meaning                                                                 #> total          \"total inertia (= weighted variation)\"                                  #> conditionT     \"variation fitted by the trait condition\"                               #> traits_explain \"trait-constrained variation\"                                           #> conditionTE    \"trait-constrained variation explained by the condition in formulaEnv\"  #> constraintsTE  \"trait-constrained variation explained by the predictors in formulaEnv\""},{"path":"/reference/print.wrda.html","id":null,"dir":"Reference","previous_headings":"","what":"Print a summary of a wrda or cca0 object — print.wrda","title":"Print a summary of a wrda or cca0 object — print.wrda","text":"Print summary wrda cca0 object","code":""},{"path":"/reference/print.wrda.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Print a summary of a wrda or cca0 object — print.wrda","text":"","code":"# S3 method for class 'wrda' print(x, ...)"},{"path":"/reference/print.wrda.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Print a summary of a wrda or cca0 object — print.wrda","text":"x object wrda cca0 ... arguments passed function (currently ignored).","code":""},{"path":"/reference/print.wrda.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Print a summary of a wrda or cca0 object — print.wrda","text":"return value, results printed console.","code":""},{"path":"/reference/print.wrda.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Print a summary of a wrda or cca0 object — print.wrda","text":"","code":"data(\"dune_trait_env\")  # rownames are carried forward in results rownames(dune_trait_env$comm) <- dune_trait_env$comm$Sites response <- dune_trait_env$comm[, -1]  # must delete \"Sites\"  w <- rep(1, 20)  w[1:10] <- 8  w[17:20] <- 0.5  object <- wrda(formula = response ~ A1 + Moist + Mag + Use + Condition(Manure),                data = dune_trait_env$envir,                 weights = w) object # Proportions equal to those Canoco 5.15 #> Call: wrda(formula = response ~ A1 + Moist + Mag + Use + Condition(Manure), #> data = dune_trait_env$envir, weights = w) #>  #> -- Model Summary -- #>  #>               Inertia Proportion Rank #> Total         65.7007     1.0000      #> Conditional    7.3839     0.1124    2 #> Constrained   36.4952     0.5555    6 #> Unconstrained 21.8217     0.3321   19 #>  #> Inertia is weighted variance #>  #> -- Eigenvalues -- #>  #> Eigenvalues for constrained axes: #>  wRDA1  wRDA2  wRDA3  wRDA4  wRDA5  wRDA6  #> 18.133  8.233  4.047  3.155  2.238  0.689  #>  #> Eigenvalues for unconstrained axes: #> wPCA1 wPCA2 wPCA3 wPCA4 wPCA5 wPCA6 wPCA7 wPCA8  #>    NA    NA    NA    NA    NA    NA    NA    NA  #> (Showing 8 of 19 unconstrained eigenvalues) #>  #> mean, sd, VIF and canonical coefficients with their optimistic [!] t-values: #>           Avg    SDS     VIF   Regr1   tval1 #> Manure 2.4659 1.2056 10.5656 -0.2010 -0.1344 #> A1     4.1466 1.3786  1.4841  0.1013  0.1807 #> Moist  2.1761 1.4762  1.4883 -4.1077 -7.3195 #> MagBF  0.1932 0.3948  6.8216  0.7873  0.6553 #> MagHF  0.4545 0.4979  5.8054  1.8392  1.6594 #> MagNM  0.0455 0.2083  4.8878  0.1327  0.1304 #> Use    1.9205 0.7107  2.6787  0.2101  0.2791 #>   mod_scores <- scores(object, display = \"all\") scores(object, which_cor = c(\"A1\", \"X_lot\"), display = \"cor\") #>            wRDA1      wRDA2 #> A1    -0.2365172 -0.3510007 #> X_lot -0.4987793  0.4250562 #> attr(,\"meaning\") #> [1] \"inter set correlation, correlation between environmental variables and the sites scores (CWMs)\" anova(object) #> $table #> Permutation test for weighted reduncancy analysis #> Model: wrda(formula = response ~ A1 + Moist + Mag + Use + Condition(Manure), data = dune_trait_env$envir, weights = w)  #> Residualized predictor permutation #> Permutation: free #> Number of permutations: 999 #>  #>          df Variance      R2      F Pr(>F)    #> wRDA      6   36.495 0.62581 3.3449  0.008 ** #> Residual 12   21.822                          #> --- #> Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1 #>  #> $eigenvalues #>      wRDA1      wRDA2      wRDA3      wRDA4      wRDA5      wRDA6  #> 18.1328543  8.2332883  4.0467247  3.1546579  2.2383295  0.6893052  #>"},{"path":"/reference/reexports.html","id":null,"dir":"Reference","previous_headings":"","what":"Objects exported from other packages — reexports","title":"Objects exported from other packages — reexports","text":"objects imported packages. Follow links see documentation. vegan scores","code":""},{"path":"/reference/scores.dcca.html","id":null,"dir":"Reference","previous_headings":"","what":"Extract results of a double constrained correspondence analysis (dc-CA) — scores.dcca","title":"Extract results of a double constrained correspondence analysis (dc-CA) — scores.dcca","text":"function works much like vegan scores function, particular scores.cca, additional results regression coefficients linear combinations traits ('reg_traits', 'lc_traits'). scores CA obey called transition formulas scores CCA dc-CA. differences , CCA, linear combinations environmental variables (constrained site scores) replace usual (unconstrained) site scores, dc-CA, linear combinations traits (constrained species scores) also replace usual (unconstrained) species scores transition formulas.","code":""},{"path":"/reference/scores.dcca.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Extract results of a double constrained correspondence analysis (dc-CA) — scores.dcca","text":"","code":"# S3 method for class 'dcca' scores(   x,   ...,   choices = 1:2,   display = \"all\",   scaling = \"sym\",   which_cor = \"in model\",   normed = TRUE,   tidy = FALSE )"},{"path":"/reference/scores.dcca.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Extract results of a double constrained correspondence analysis (dc-CA) — scores.dcca","text":"x object class \"dcca\", .e. result dc_CA. ... arguments passed function (currently ignored). choices integer vector axes obtain. Default: dc-CA axes. display character vector, one c(\"\", \"species\", \"sites\", \"sp\", \"wa\", \"lc\", \"bp\", \"cor\", \"ic\", \"reg\", \"tval\", \"cn\", \"lc_traits\", \"reg_traits\", \"tval_traits\", \"cor_traits\", \"ic_traits\", \"bp_traits\", \"cn_traits\"). items scores.cca, except \"cor\" \"ic\", inter-set intra-set correlations, respectively, \"tval\" (-optimistic) t-values regression coefficients. remaining scores analogous scores species traits. scaling numeric (1,2 3) character \"sites\", \"species\" \"symmetric\". Default: \"symmetric\". Either site- (1) species- (2) related scores scaled eigenvalues, set scores unit weighted mean square 3 scaled symmetrically weighted mean squares equal square root eigenvalues. Negative values treated corresponding positive ones abs(scaling). which_cor character list trait environmental variables names (order) data frames inter-set correlations must calculated. Default: character (\"in_model\") traits variables model, including collinear variables levels. normed logical (default TRUE) giving standardized regression coefficients biplot scores. FALSE, (regular) regression coefficients (unstandardized) biplot scores. tidy Return scores compatible ggplot2: scores single data.frame, score type identified factor variable score, names variable label, species weights (dc_CA variable weight. See scores.cca.","code":""},{"path":"/reference/scores.dcca.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Extract results of a double constrained correspondence analysis (dc-CA) — scores.dcca","text":"data frame tidy = TRUE. Otherwise, matrix single item asked named list matrices one item asked . following names can included: c(\"sites\", \"constraints_sites\", \"centroids\", \"regression\", \"t_values\", \"correlation\", \"intra_set_correlation\", \"biplot\", \"species\", \"constraints_species\", \"regression_traits\", \"t_values_traits\", \"correlation_traits\", \"intra_set_correlation_traits\", \"biplot_traits\", \"centroids_traits\"). matrix attribute \"meaning\" explaining meaning.  tidy = TRUE, resulting data frame attributes \"scaling\" \"meaning\"; latter two columns: (1) name score type (2) meaning, usage interpretation. example meaning scores scaling \"symmetric\" display =\"\": sites CMWs trait axes (constraints species) scaling  'symmetric' optimal biplots , almost , inter-site distances. constraints_sites linear combination environmental predictors  covariates (making ordination axes orthogonal  covariates) scaling 'symmetric' optimal biplots , almost ,  inter-site distances. regression mean, sd, VIF, standardized regression coefficients  optimistic t-ratio scaling 'symmetric'. t_values t-values coefficients regression CWMs  trait composite environmental variables correlation inter set correlation, correlation environmental  variables sites scores (CWMs) intra_set_correlation intra set correlation, correlation  environmental variables dc-ca axis (constrained sites scores) biplot biplot scores environmental variables display  biplot-traits fourth-corner correlations scaling 'symmetric'. centroids environmental category means site scores scaling  'symmetric'  optimal biplots , almost , inter-environmental  category distances. species SNC environmental axes (constraints sites) scaling  'symmetric' optimal biplots , almost , inter-species  distances. constraints_species linear combination traits trait  covariates (making ordination axes orthogonal covariates)  scaling 'symmetric' optimal biplots , almost , inter-species  distances. regression_traits mean, sd, VIF, standardized regression  coefficients optimistic t-ratio scaling 'symmetric'. t_values_traits t-values coefficients regression  SNCs along dc-CA axis traits correlation_traits inter set correlation, correlation  traits species scores (SNCs) intra_set_correlation_traits intra set correlation, correlation  traits dc-ca axis (constrained species scores) biplot_traits biplot scores traits display biplot scores  fourth-corner correlation scaling 'symmetric'. centroids_traits trait category means species scores  scaling 'symmetric' optimal biplots , almost , inter-trait  category distances. statements optimality distance interpretations based scaling relative magnitude dc-CA eigenvalues chosen axes.","code":""},{"path":"/reference/scores.dcca.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Extract results of a double constrained correspondence analysis (dc-CA) — scores.dcca","text":"function modeled scores.cca. t-ratios taken multiple regression unconstrained species (site) scores traits (environmental variables). example which_cor : which_cor = list(traits = \"SLA\", env = c(\"acidity\", \"humidity\")).","code":""},{"path":"/reference/scores.dcca.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Extract results of a double constrained correspondence analysis (dc-CA) — scores.dcca","text":"","code":"data(\"dune_trait_env\")  # rownames are carried forward in results rownames(dune_trait_env$comm) <- dune_trait_env$comm$Sites abun <- dune_trait_env$comm[, -1]  # must delete \"Sites\" mod <- dc_CA(formulaEnv = abun ~ A1 + Moist + Mag + Use + Manure,              formulaTraits = ~ SLA + Height + LDMC + Seedmass + Lifespan,              dataEnv = dune_trait_env$envir,              dataTraits = dune_trait_env$traits,        verbose = FALSE)  print(mod) # same output as with verbose = TRUE (the default of verbose).                                      #> Step 1: the CCA ordination of the transposed matrix with trait constraints, #>         useful in itself and also yielding CWMs of the orthonormalized traits for step 2. #> Call: cca0(formula = formulaTraits, response = tY, data = #> out0$data$dataTraits) #>  #> -- Model Summary -- #>  #>               Inertia Proportion Rank #> Total          2.3490     1.0000      #> Constrained    0.6776     0.2885    5 #> Unconstrained  1.6714     0.7115   19 #>  #> Inertia is scaled Chi-square #>  #> -- Eigenvalues -- #>  #> Eigenvalues for constrained axes: #>    CCA1    CCA2    CCA3    CCA4    CCA5  #> 0.26839 0.19597 0.12356 0.07003 0.01967  #>  #> Eigenvalues for unconstrained axes: #> CA1 CA2 CA3 CA4 CA5 CA6 CA7 CA8  #>  NA  NA  NA  NA  NA  NA  NA  NA  #> (Showing 8 of 19 unconstrained eigenvalues) #>  #> mean, sd, VIF and canonical coefficients with their optimistic [!] t-values: #>                        Avg     SDS    VIF   Regr1   tval1 #> SLA                24.6468  6.3438 1.1888  0.4401  4.1794 #> Height             25.1272 15.6848 1.3033  0.1283  1.1640 #> LDMC              244.5084 70.9729 1.1791  0.0278  0.2647 #> Seedmass            0.6543  0.6688 1.0784  0.3708  3.6980 #> Lifespanperennial   0.9607  0.1944 1.0964 -0.0578 -0.5718 #>  #> Step 2: the RDA ordination of CWMs of the orthonormalized traits  #>         of step 1 with environmental constraints: #> Call: rda(formula = out1$CWMs_orthonormal_traits ~ A1 + Moist + Mag + Use + #> Manure, data = out1$data$dataEnv) #>  #> -- Model Summary -- #>  #>               Inertia Proportion Rank #> Total          0.6776     1.0000      #> Constrained    0.4454     0.6573    5 #> Unconstrained  0.2322     0.3427    5 #>  #> Inertia is variance #>  #> -- Eigenvalues -- #>  #> Eigenvalues for constrained axes: #>    RDA1    RDA2    RDA3    RDA4    RDA5  #> 0.23680 0.10903 0.05934 0.03792 0.00233  #>  #> Eigenvalues for unconstrained axes: #>     PC1     PC2     PC3     PC4     PC5  #> 0.12017 0.05836 0.03455 0.01337 0.00575  #>  #> mean, sd, VIF and canonical coefficients with their optimistic [!] t-values: #>         Avg    SDS    VIF   Regr1   tval1 #> A1     4.85 2.1240 1.6967 -0.0605 -0.9172 #> Moist  2.90 1.7578 1.7658  0.3250  4.8293 #> MagBF  0.15 0.3571 4.5016 -0.0475 -0.4421 #> MagHF  0.25 0.4330 2.6715 -0.0156 -0.1890 #> MagNM  0.30 0.4583 9.5666  0.1622  1.0352 #> Use    1.90 0.7681 1.7825  0.0219  0.3239 #> Manure 1.75 1.4448 9.3847 -0.1444 -0.9306 #>                        Avg     SDS    VIF   Regr1   tval1 #> SLA                24.6468  6.3438 1.1888 -0.8196 -3.6933 #> Height             25.1272 15.6848 1.3033 -0.1598 -0.6877 #> LDMC              244.5084 70.9729 1.1791 -0.0562 -0.2542 #> Seedmass            0.6543  0.6688 1.0784 -0.7586 -3.5896 #> Lifespanperennial   0.9607  0.1944 1.0964  0.1006  0.4722 #>  #>                weighted variance #> total                      2.349 #> traits_explain             0.678 #> env_explain                1.323 #> constraintsTE              0.445 #> attr(,\"meaning\") #>                meaning                                                                 #> total          \"total inertia (= weighted variation)\"                                  #> traits_explain \"trait-constrained variation\"                                           #> env_explain    \"environment-constrained variation\"                                     #> constraintsTE  \"trait-constrained variation explained by the predictors in formulaEnv\" anova(mod, by = \"axis\") #> $species #> Species-level permutation test using dc-CA #> Model: dc_CA(formulaEnv = abun ~ A1 + Moist + Mag + Use + Manure, formulaTraits = ~SLA + Height + LDMC + Seedmass + Lifespan, dataEnv = dune_trait_env$envir, dataTraits = dune_trait_env$traits, verbose = FALSE)  #> Residualized predictor permutation #>  #>          df ChiSquare       R2      F Pr(>F) #> dcCA1     1   0.23680 0.179002 5.9370  0.104 #> dcCA2     1   0.10903 0.082419 2.7336  0.474 #> dcCA3     1   0.05934 0.044853 1.4877  0.762 #> dcCA4     1   0.03792 0.028663 0.9507  0.791 #> dcCA5     1   0.00233 0.001760 0.0584  1.000 #> Residual 22   0.87749                        #>  #> $sites #>          Df ChiSquare      R2       F Pr(>F)     #> dcCA1     1  0.236804 0.34946 14.2776  0.001 *** #> dcCA2     1  0.109032 0.16090  6.5739  0.093 .   #> dcCA3     1  0.059336 0.08757  3.5776  0.407     #> dcCA4     1  0.037919 0.05596  2.2863  0.685     #> dcCA5     1  0.002329 0.00344  0.1404  1.000     #> Residual 14  0.232199                            #> --- #> Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1 #>  #> $maxP #> Max test combining the community- and species- level tests  #> Model: dc_CA(formulaEnv = abun ~ A1 + Moist + Mag + Use + Manure, formulaTraits = ~SLA + Height + LDMC + Seedmass + Lifespan, dataEnv = dune_trait_env$envir, dataTraits = dune_trait_env$traits, verbose = FALSE)  #>  #> Taken from the species-level test: #> Residualized predictor permutation #> Permutation: free #> Number of permutations: 999 #>  #>          df ChiSquare       R2      F Pr(>F) #> dcCA1     1   0.23680 0.179002 5.9370  0.104 #> dcCA2     1   0.10903 0.082419 2.7336  0.474 #> dcCA3     1   0.05934 0.044853 1.4877  0.762 #> dcCA4     1   0.03792 0.028663 0.9507  0.791 #> dcCA5     1   0.00233 0.001760 0.0584  1.000 #> Residual 22   0.87749                        #>  # For more demo on testing, see demo dune_test.r  mod_scores <- scores(mod) # correlation of axes with a variable that is not in the model scores(mod, display = \"cor\", scaling = \"sym\", which_cor = list(NULL, \"X_lot\")) #>           dcCA1      dcCA2 #> X_lot 0.1425494 0.06695038 #> attr(,\"meaning\") #> [1] \"inter set correlation, correlation between environmental variables and the sites scores (CWMs)\"  cat(\"head of unconstrained site scores, with meaning\\n\") #> head of unconstrained site scores, with meaning print(head(mod_scores$sites)) #>             dcCA1       dcCA2 #> Site_1 -1.2640026  0.19395232 #> Site_2 -0.7328822 -0.24929614 #> Site_3 -0.8250139 -0.44760064 #> Site_4 -0.4453407 -0.33741144 #> Site_5 -0.5783587  0.01524487 #> Site_6 -0.5722181  0.24340264  mod_scores_tidy <- scores(mod, tidy = TRUE) print(\"names of the tidy scores\") #> [1] \"names of the tidy scores\" print(names(mod_scores_tidy)) #> [1] \"dcCA1\"  \"dcCA2\"  \"score\"  \"label\"  \"weight\" cat(\"\\nThe levels of the tidy scores\\n\") #>  #> The levels of the tidy scores print(levels(mod_scores_tidy$score)) #>  [1] \"biplot\"                       \"biplot_traits\"                #>  [3] \"centroids\"                    \"centroids_traits\"             #>  [5] \"constraints_sites\"            \"constraints_species\"          #>  [7] \"correlation\"                  \"correlation_traits\"           #>  [9] \"factorbiplot\"                 \"factorbiplot_traits\"          #> [11] \"intra_set_correlation\"        \"intra_set_correlation_traits\" #> [13] \"regression\"                   \"regression_traits\"            #> [15] \"sites\"                        \"species\"                      #> [17] \"t_values\"                     \"t_values_traits\"               cat(\"\\nFor illustration: a dc-CA model with a trait covariate\\n\") #>  #> For illustration: a dc-CA model with a trait covariate mod2 <- dc_CA(formulaEnv = abun ~ A1 + Moist + Mag + Use + Manure,               formulaTraits = ~ SLA + Height + LDMC + Lifespan + Condition(Seedmass),               dataEnv = dune_trait_env$envir,               dataTraits = dune_trait_env$traits) #> Step 1: the CCA ordination of the transposed matrix with trait constraints, #>         useful in itself and also yielding CWMs of the orthonormalized traits for step 2. #> Call: cca0(formula = formulaTraits, response = tY, data = #> out0$data$dataTraits) #>  #> -- Model Summary -- #>  #>               Inertia Proportion Rank #> Total         2.34899    1.00000      #> Conditional   0.16671    0.07097    2 #> Constrained   0.51091    0.21750    4 #> Unconstrained 1.67137    0.71153   19 #>  #> Inertia is scaled Chi-square #>  #> -- Eigenvalues -- #>  #> Eigenvalues for constrained axes: #>    CCA1    CCA2    CCA3    CCA4  #> 0.21499 0.18622 0.07354 0.03616  #>  #> Eigenvalues for unconstrained axes: #> CA1 CA2 CA3 CA4 CA5 CA6 CA7 CA8  #>  NA  NA  NA  NA  NA  NA  NA  NA  #> (Showing 8 of 19 unconstrained eigenvalues) #>  #> mean, sd, VIF and canonical coefficients with their optimistic [!] t-values: #>                        Avg     SDS    VIF   Regr1   tval1 #> Seedmass            0.6543  0.6688 1.0784  0.0223  0.2225 #> SLA                24.6468  6.3438 1.1888  0.4456  4.2398 #> Height             25.1272 15.6848 1.3033  0.3532  3.2091 #> LDMC              244.5084 70.9729 1.1791 -0.1043 -0.9967 #> Lifespanperennial   0.9607  0.1944 1.0964 -0.0439 -0.4349 #>  #> Step 2: the RDA ordination of CWMs of the orthonormalized traits  #>         of step 1 with environmental constraints: #> Call: rda(formula = out1$CWMs_orthonormal_traits ~ A1 + Moist + Mag + Use + #> Manure, data = out1$data$dataEnv) #>  #> -- Model Summary -- #>  #>               Inertia Proportion Rank #> Total          0.5109     1.0000      #> Constrained    0.3171     0.6207    4 #> Unconstrained  0.1938     0.3793    4 #>  #> Inertia is variance #>  #> -- Eigenvalues -- #>  #> Eigenvalues for constrained axes: #>    RDA1    RDA2    RDA3    RDA4  #> 0.16632 0.08100 0.04766 0.02215  #>  #> Eigenvalues for unconstrained axes: #>     PC1     PC2     PC3     PC4  #> 0.11386 0.04942 0.01888 0.01162  #>  #> mean, sd, VIF and canonical coefficients with their optimistic [!] t-values: #>         Avg    SDS    VIF   Regr1   tval1 #> A1     4.85 2.1240 1.6967 -0.0920 -1.1424 #> Moist  2.90 1.7578 1.7658  0.1002  1.2204 #> MagBF  0.15 0.3571 4.5016  0.0125  0.0951 #> MagHF  0.25 0.4330 2.6715  0.0405  0.4006 #> MagNM  0.30 0.4583 9.5666  0.3052  1.5969 #> Use    1.90 0.7681 1.7825  0.0927  1.1234 #> Manure 1.75 1.4448 9.3847 -0.1567 -0.8277 #>                        Avg     SDS    VIF   Regr1   tval1 #> Seedmass            0.6543  0.6688 1.0784 -0.0929 -0.3874 #> SLA                24.6468  6.3438 1.1888 -1.0644 -4.2276 #> Height             25.1272 15.6848 1.3033 -0.5285 -2.0049 #> LDMC              244.5084 70.9729 1.1791  0.0433  0.1728 #> Lifespanperennial   0.9607  0.1944 1.0964  0.1744  0.7211 #>  #>                weighted variance #> total                      2.349 #> conditionT                 0.167 #> traits_explain             0.511 #> env_explain                1.323 #> constraintsTE              0.317 #> attr(,\"meaning\") #>                meaning                                                                 #> total          \"total inertia (= weighted variation)\"                                  #> conditionT     \"variation fitted by the trait condition\"                               #> traits_explain \"trait-constrained variation\"                                           #> env_explain    \"environment-constrained variation\"                                     #> constraintsTE  \"trait-constrained variation explained by the predictors in formulaEnv\"  cat(\"\\nFor illustration: a dc-CA model with both environmental and trait covariates\\n\") #>  #> For illustration: a dc-CA model with both environmental and trait covariates mod3 <- dc_CA(formulaEnv = abun ~ A1 + Moist + Use + Manure + Condition(Mag),               formulaTraits = ~ SLA + Height + LDMC + Lifespan + Condition(Seedmass),               dataEnv = dune_trait_env$envir,               dataTraits = dune_trait_env$traits,          verbose = FALSE)  cat(\"\\nFor illustration: same model but using dc_CA_object = mod2 for speed, \",      \"as the trait model and data did not change\\n\") #>  #> For illustration: same model but using dc_CA_object = mod2 for speed,  as the trait model and data did not change mod3B <- dc_CA(formulaEnv = abun ~ A1 + Moist + Use + Manure + Condition(Mag),                dataEnv = dune_trait_env$envir,                dc_CA_object = mod2,           verbose= FALSE) cat(\"\\ncheck on equality of mod3 (from data) and mod3B (from a dc_CA_object)\\n\",     \"the expected difference is in the component 'call'\\n \") #>  #> check on equality of mod3 (from data) and mod3B (from a dc_CA_object) #>  the expected difference is in the component 'call' #>    print(all.equal(mod3[-c(5,12)], mod3B[-c(5,12)])) #  only the component call differs #> [1] TRUE print(mod3$inertia[-c(3,5),]/mod3B$inertia) #        and mod3 has two more inertia items #>                weighted variance #> total                          1 #> conditionT                     1 #> traits_explain                 1 #> conditionTE                    1 #> constraintsTE                  1 #> attr(,\"meaning\") #>                meaning                                                                 #> total          \"total inertia (= weighted variation)\"                                  #> conditionT     \"variation fitted by the trait condition\"                               #> traits_explain \"trait-constrained variation\"                                           #> conditionTE    \"trait-constrained variation explained by the condition in formulaEnv\"  #> constraintsTE  \"trait-constrained variation explained by the predictors in formulaEnv\""},{"path":"/reference/scores.wrda.html","id":null,"dir":"Reference","previous_headings":"","what":"Extract results of a weighted redundancy analysis (wrda) or a cca0 object. — scores.wrda","title":"Extract results of a weighted redundancy analysis (wrda) or a cca0 object. — scores.wrda","text":"function works much like vegan scores function, particular scores.cca, regression coefficients predictors.","code":""},{"path":"/reference/scores.wrda.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Extract results of a weighted redundancy analysis (wrda) or a cca0 object. — scores.wrda","text":"","code":"# S3 method for class 'wrda' scores(   x,   ...,   choices = 1:2,   display = \"all\",   scaling = \"sym\",   which_cor = \"in model\",   normed = TRUE,   tidy = FALSE )"},{"path":"/reference/scores.wrda.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Extract results of a weighted redundancy analysis (wrda) or a cca0 object. — scores.wrda","text":"x object class \"wrda\", .e. result wrda cca0. ... arguments passed function (currently ignored). choices integer vector axes obtain. Default: wrda axes. display character vector, one c(\"\", \"species\", \"sites\", \"sp\", \"wa\", \"lc\", \"bp\", \"cor\", \"ic\", \"reg\", \"tval\", \"cn\"). items scores.cca, except \"cor\" \"ic\", inter-set intra-set correlations, respectively, \"tval\" (-optimistic) t-values regression coefficients. scaling numeric (1,2 3) character \"sites\", \"species\" \"symmetric\". Default: \"symmetric\". Either site- (1) species- (2) related scores scaled eigenvalues, set scores unit weighted mean square 3 scaled symmetrically weighted mean squares equal square root eigenvalues. Negative values treated corresponding positive ones abs(scaling). which_cor character vector environmental variables names data frames inter-set correlations must calculated. Default: character (\"in_model\") predictors model, including collinear variables levels. normed logical (default TRUE) giving standardized regression coefficients biplot scores. FALSE, (regular) regression coefficients (unstandardized) biplot scores. tidy Return scores compatible ggplot2: variable score, names variable label. See weights (dc_CA variable weight. See scores.cca.","code":""},{"path":"/reference/scores.wrda.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Extract results of a weighted redundancy analysis (wrda) or a cca0 object. — scores.wrda","text":"data frame tidy = TRUE. Otherwise, matrix single item asked named list matrices one item asked . following names can included: c(\"sites\", \"constraints_sites\", \"centroids\", \"regression\", \"t_values\", \"correlation\", \"intra_set_correlation\", \"biplot\", \"species\"). matrix attribute \"meaning\" explaining meaning. tidy = TRUE, resulting data frame  attributes \"scaling\" \"meaning\"; latter two columns: (1) name score type (2) meaning, usage interpretation. example meaning scores scaling \"symmetric\" display = \"\": sites CMWs trait axes (constraints species) scaling  'symmetric' optimal biplots , almost , inter-site distances. constraints_sites linear combination environmental predictors  covariates (making ordination axes orthogonal covariates)  scaling 'symmetric' optimal biplots , almost , inter-site  distances. regression mean, sd, VIF, standardized regression coefficients  optimistic t-ratio scaling 'symmetric'. t_values t-values coefficients regression  CWMs trait composite environmental variables correlation inter set correlation, correlation environmental  variables sites scores (CWMs) intra_set_correlation intra set correlation, correlation  environmental variables dc-ca axis (constrained sites scores) biplot biplot scores environmental variables display  biplot-traits fourth-corner correlations scaling 'symmetric'. centroids environmental category means site scores  scaling 'symmetric' optimal biplots , almost ,  inter-environmental category distances. species SNC environmental axes (constraints sites) scaling  'symmetric' optimal biplots , almost , inter-species  distances. statements optimality distance interpretations based scaling relative magnitude dc-CA eigenvalues chosen axes.","code":""},{"path":"/reference/scores.wrda.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Extract results of a weighted redundancy analysis (wrda) or a cca0 object. — scores.wrda","text":"function modeled scores.cca. example which_cor : which_cor = c(\"acidity\", \"humidity\")","code":""},{"path":"/reference/scores.wrda.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Extract results of a weighted redundancy analysis (wrda) or a cca0 object. — scores.wrda","text":"","code":"data(\"dune_trait_env\")  # rownames are carried forward in results rownames(dune_trait_env$comm) <- dune_trait_env$comm$Sites response <- dune_trait_env$comm[, -1]  # must delete \"Sites\"  w <- rep(1, 20)  w[1:10] <- 8  w[17:20] <- 0.5  object <- wrda(formula = response ~ A1 + Moist + Mag + Use + Condition(Manure),                data = dune_trait_env$envir,                 weights = w) object # Proportions equal to those Canoco 5.15 #> Call: wrda(formula = response ~ A1 + Moist + Mag + Use + Condition(Manure), #> data = dune_trait_env$envir, weights = w) #>  #> -- Model Summary -- #>  #>               Inertia Proportion Rank #> Total         65.7007     1.0000      #> Conditional    7.3839     0.1124    2 #> Constrained   36.4952     0.5555    6 #> Unconstrained 21.8217     0.3321   19 #>  #> Inertia is weighted variance #>  #> -- Eigenvalues -- #>  #> Eigenvalues for constrained axes: #>  wRDA1  wRDA2  wRDA3  wRDA4  wRDA5  wRDA6  #> 18.133  8.233  4.047  3.155  2.238  0.689  #>  #> Eigenvalues for unconstrained axes: #> wPCA1 wPCA2 wPCA3 wPCA4 wPCA5 wPCA6 wPCA7 wPCA8  #>    NA    NA    NA    NA    NA    NA    NA    NA  #> (Showing 8 of 19 unconstrained eigenvalues) #>  #> mean, sd, VIF and canonical coefficients with their optimistic [!] t-values: #>           Avg    SDS     VIF   Regr1   tval1 #> Manure 2.4659 1.2056 10.5656 -0.2010 -0.1344 #> A1     4.1466 1.3786  1.4841  0.1013  0.1807 #> Moist  2.1761 1.4762  1.4883 -4.1077 -7.3195 #> MagBF  0.1932 0.3948  6.8216  0.7873  0.6553 #> MagHF  0.4545 0.4979  5.8054  1.8392  1.6594 #> MagNM  0.0455 0.2083  4.8878  0.1327  0.1304 #> Use    1.9205 0.7107  2.6787  0.2101  0.2791 #>   mod_scores <- scores(object, display = \"all\") scores(object, which_cor = c(\"A1\", \"X_lot\"), display = \"cor\") #>            wRDA1      wRDA2 #> A1    -0.2365172 -0.3510007 #> X_lot -0.4987793  0.4250562 #> attr(,\"meaning\") #> [1] \"inter set correlation, correlation between environmental variables and the sites scores (CWMs)\" anova(object) #> $table #> Permutation test for weighted reduncancy analysis #> Model: wrda(formula = response ~ A1 + Moist + Mag + Use + Condition(Manure), data = dune_trait_env$envir, weights = w)  #> Residualized predictor permutation #> Permutation: free #> Number of permutations: 999 #>  #>          df Variance      R2      F Pr(>F)   #> wRDA      6   36.495 0.62581 3.3449  0.012 * #> Residual 12   21.822                         #> --- #> Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1 #>  #> $eigenvalues #>      wRDA1      wRDA2      wRDA3      wRDA4      wRDA5      wRDA6  #> 18.1328543  8.2332883  4.0467247  3.1546579  2.2383295  0.6893052  #>"},{"path":"/reference/wrda.html","id":null,"dir":"Reference","previous_headings":"","what":"Performs a weighted redundancy analysis — wrda","title":"Performs a weighted redundancy analysis — wrda","text":"wrda formula-based implementation weighted redundancy analysis.","code":""},{"path":"/reference/wrda.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Performs a weighted redundancy analysis — wrda","text":"","code":"wrda(   formula,   response = NULL,   data,   weights = rep(1/nrow(data), nrow(data)),   traceonly = FALSE,   cca_object = NULL,   object4QR = NULL )"},{"path":"/reference/wrda.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Performs a weighted redundancy analysis — wrda","text":"formula one two-sided formula rows (samples) row predictors data. left hand side formula ignored specified next argument (response). Specify row covariates () adding + Condition(covariate-formula) formula rda. covariate-formula contain ~ (tilde). response matrix data frame abundance data (dimension n x m). Rownames response, , carried . Can NULL cca_object supplied response formula two-sided. data matrix data frame row predictors, rows corresponding response (dimension n x p). weights row weights (vector). specified unit weights used. traceonly logical, default FALSE. TRUE, explained variance predictors Condition() returned, .e without performing singular value decompostion. cca_object vegan-type cca-object transposed response, centred abundance values  row column weights can obtained. object4QR vegan-type cca-object weighted QR's formula, .e. qr(Z) qr(XZ) obtainable via get_QR(object4QR, model = \"pCCA\") get_QR(object4QR, model = \"CCA\"), respectively.","code":""},{"path":"/reference/wrda.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Performs a weighted redundancy analysis — wrda","text":"scores wrda object scaling \"sites\" (1): scaling Focus Case distances.","code":""},{"path":"/reference/wrda.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Performs a weighted redundancy analysis — wrda","text":"algorithm modified version published R-code weighted redundancy analysis (ter Braak, 2022). Compared  rda, wrda residual axes, .e. SVD PCA residuals performed.","code":""},{"path":"/reference/wrda.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Performs a weighted redundancy analysis — wrda","text":"ter Braak C.J.F.  P. Šmilauer  (2018). Canoco reference manual user's guide: software ordination (version 5.1x). Microcomputer Power, Ithaca, USA, 536 pp. Oksanen, J., et al. (2022) vegan: Community Ecology Package. R package version 2.6-4. https://CRAN.R-project.org/package=vegan.","code":""},{"path":[]},{"path":"/reference/wrda.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Performs a weighted redundancy analysis — wrda","text":"","code":"data(\"dune_trait_env\")  # rownames are carried forward in results rownames(dune_trait_env$comm) <- dune_trait_env$comm$Sites response <- dune_trait_env$comm[, -1]  # must delete \"Sites\"  w <- rep(1, 20)  w[1:10] <- 8  w[17:20] <- 0.5  object <- wrda(formula = response ~ A1 + Moist + Mag + Use + Condition(Manure),                data = dune_trait_env$envir,                 weights = w) object # Proportions equal to those Canoco 5.15 #> Call: wrda(formula = response ~ A1 + Moist + Mag + Use + Condition(Manure), #> data = dune_trait_env$envir, weights = w) #>  #> -- Model Summary -- #>  #>               Inertia Proportion Rank #> Total         65.7007     1.0000      #> Conditional    7.3839     0.1124    2 #> Constrained   36.4952     0.5555    6 #> Unconstrained 21.8217     0.3321   19 #>  #> Inertia is weighted variance #>  #> -- Eigenvalues -- #>  #> Eigenvalues for constrained axes: #>  wRDA1  wRDA2  wRDA3  wRDA4  wRDA5  wRDA6  #> 18.133  8.233  4.047  3.155  2.238  0.689  #>  #> Eigenvalues for unconstrained axes: #> wPCA1 wPCA2 wPCA3 wPCA4 wPCA5 wPCA6 wPCA7 wPCA8  #>    NA    NA    NA    NA    NA    NA    NA    NA  #> (Showing 8 of 19 unconstrained eigenvalues) #>  #> mean, sd, VIF and canonical coefficients with their optimistic [!] t-values: #>           Avg    SDS     VIF   Regr1   tval1 #> Manure 2.4659 1.2056 10.5656 -0.2010 -0.1344 #> A1     4.1466 1.3786  1.4841  0.1013  0.1807 #> Moist  2.1761 1.4762  1.4883 -4.1077 -7.3195 #> MagBF  0.1932 0.3948  6.8216  0.7873  0.6553 #> MagHF  0.4545 0.4979  5.8054  1.8392  1.6594 #> MagNM  0.0455 0.2083  4.8878  0.1327  0.1304 #> Use    1.9205 0.7107  2.6787  0.2101  0.2791 #>   mod_scores <- scores(object, display = \"all\") scores(object, which_cor = c(\"A1\", \"X_lot\"), display = \"cor\") #>            wRDA1      wRDA2 #> A1    -0.2365172 -0.3510007 #> X_lot -0.4987793  0.4250562 #> attr(,\"meaning\") #> [1] \"inter set correlation, correlation between environmental variables and the sites scores (CWMs)\" anova(object) #> $table #> Permutation test for weighted reduncancy analysis #> Model: wrda(formula = response ~ A1 + Moist + Mag + Use + Condition(Manure), data = dune_trait_env$envir, weights = w)  #> Residualized predictor permutation #> Permutation: free #> Number of permutations: 999 #>  #>          df Variance      R2      F Pr(>F)   #> wRDA      6   36.495 0.62581 3.3449  0.014 * #> Residual 12   21.822                         #> --- #> Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1 #>  #> $eigenvalues #>      wRDA1      wRDA2      wRDA3      wRDA4      wRDA5      wRDA6  #> 18.1328543  8.2332883  4.0467247  3.1546579  2.2383295  0.6893052  #>"},{"path":"/news/index.html","id":"douconca-123","dir":"Changelog","previous_headings":"","what":"douconca 1.2.3","title":"douconca 1.2.3","text":"Forward selection traits environmental variables added (function FS()). Function ipf2N2 informative pre-processing abundance data. row column marginals set equal Hill N2 , column marginals 2N(N-N2)/2, effective number informative species. informative species efficiency large data sets addition new cca function (cca0). anova method cca0 enable residual predictor permutation. Improved stability ‘exceptional’ data sets. response can now supplied left-hand side environmental formula, instead response argument.","code":""},{"path":"/news/index.html","id":"douconca-122","dir":"Changelog","previous_headings":"","what":"douconca 1.2.2","title":"douconca 1.2.2","text":"CRAN release: 2024-12-02 New coef.dcca() fitted.dcca() functions predict.dcca() adapted. function coef() can give fourth-corner correlations regression coefficients. Patch release extended test files associated small corrections, example, SDS (standard deviation predictors) v1.2.1 constant factor large default argument divideBySiteTotals (regression weights t-values correct).","code":""},{"path":"/news/index.html","id":"douconca-121","dir":"Changelog","previous_headings":"","what":"douconca 1.2.1","title":"douconca 1.2.1","text":"CRAN release: 2024-09-25 Patch release addressing check errors several CRAN build machines.","code":""},{"path":"/news/index.html","id":"douconca-120","dir":"Changelog","previous_headings":"","what":"douconca 1.2.0","title":"douconca 1.2.0","text":"CRAN release: 2024-09-13 Intial CRAN release","code":""},{"path":"/news/index.html","id":"douconca-116","dir":"Changelog","previous_headings":"","what":"douconca 1.1.6","title":"douconca 1.1.6","text":"issue collinear predictors v1.1.5 resolved.","code":""},{"path":"/news/index.html","id":"douconca-115","dir":"Changelog","previous_headings":"","what":"douconca 1.1.5","title":"douconca 1.1.5","text":"package can now general dc-CA, instead vegan-based version equal site weights . users previous version, function dc_CA_vegan replaced general function dc_CA. default gives analysis. specifying argument divideBySiteTotals = FALSE, obtain original dc-CA analysis unequal site weights. plot_dcCA function now method: plot. General dc-CA required weighted redundancy analysis. , new function wrda added, methods print, scores anova. predict function added. dc-CA can computed community-weighted means (CWMs) trait environment data species site weights. See new function fCWM_SNC. interest, example, make dc-CA analysis reproducible abundance data made public, may also allow perform dcCA intra-species trait variation. user needs able compute meaningful CWMs case supply trait data reflect (species-weighted) inter-trait covariance. Several functions updated. particular, corrections anova function.","code":""},{"path":"/news/index.html","id":"douconca-112","dir":"Changelog","previous_headings":"","what":"douconca 1.1.2","title":"douconca 1.1.2","text":"scores.dccav function corrected concerning intra-set correlations traits environmental variables. plotting functions updated avoid ggplot2 warnings color size. fitted straight lines plots use implicit weights (already, help said ).","code":""}]
