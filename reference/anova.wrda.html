<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Permutation Test for weighted redundancy analysis — anova.wrda • douconca</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Permutation Test for weighted redundancy analysis — anova.wrda"><meta name="description" content="anova.wrda performs residual predictor permutation for weighted
redundancy analysis (wRDA), which is robust against differences in the
weights (ter Braak, 2022). The arguments of the function are similar to
those of anova.cca, but more restricted."><meta property="og:description" content="anova.wrda performs residual predictor permutation for weighted
redundancy analysis (wRDA), which is robust against differences in the
weights (ter Braak, 2022). The arguments of the function are similar to
those of anova.cca, but more restricted."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">douconca</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.2.2</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/douconca.html">Get started</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/Biometris/douconca/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Permutation Test for weighted redundancy analysis</h1>
      <small class="dont-index">Source: <a href="https://github.com/Biometris/douconca/blob/main/R/anova.wrda.R" class="external-link"><code>R/anova.wrda.R</code></a></small>
      <div class="d-none name"><code>anova.wrda.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p><code>anova.wrda</code> performs residual predictor permutation for weighted
redundancy analysis (wRDA), which is robust against differences in the
weights (ter Braak, 2022). The arguments of the function are similar to
those of <code><a href="https://rdrr.io/pkg/vegan/man/anova.cca.html" class="external-link">anova.cca</a></code>, but more restricted.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="co"># S3 method for class 'wrda'</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/anova.html" class="external-link">anova</a></span><span class="op">(</span><span class="va">object</span>, <span class="va">...</span>, permutations <span class="op">=</span> <span class="fl">999</span>, by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"omnibus"</span>, <span class="st">"axis"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-object">object<a class="anchor" aria-label="anchor" href="#arg-object"></a></dt>
<dd><p>an object from <code><a href="dc_CA.html">dc_CA</a></code>.</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>unused.</p></dd>


<dt id="arg-permutations">permutations<a class="anchor" aria-label="anchor" href="#arg-permutations"></a></dt>
<dd><p>a list of control values for the permutations as
returned by the function <code><a href="https://rdrr.io/pkg/permute/man/how.html" class="external-link">how</a></code>, or the number of
permutations required (default 999), or a permutation matrix where each row
gives the permuted indices.</p></dd>


<dt id="arg-by">by<a class="anchor" aria-label="anchor" href="#arg-by"></a></dt>
<dd><p>character <code>"axis"</code> which sets the test statistic to the
first eigenvalue of the RDA model. Default: <code>NULL</code> which sets the test
statistic to the weighted variance fitted by the predictors
(=sum of all constrained eigenvalues). The default is quicker
computationally as it avoids computation of an svd of permuted data sets.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A list with two elements with names <code>table</code> and <code>eigenvalues</code>.
The <code>table</code> is as from <code><a href="https://rdrr.io/pkg/vegan/man/anova.cca.html" class="external-link">anova.cca</a></code> and
<code>eigenvalues</code> gives the wrda eigenvalues.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>The algorithm is based on published R-code for residual predictor
permutation in weighted redundancy analysis (ter Braak, 2022), but
using QR-decomposition instead of ad-hoc least-squares functions.</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>ter Braak, C.J.F. (2022) Predictor versus response permutation
for significance testing in weighted regression and redundancy analysis.
Journal of statistical computation and simulation, 92, 2041-2059.
<a href="https://doi.org/10.1080/00949655.2021.2019256" class="external-link">doi:10.1080/00949655.2021.2019256</a></p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"dune_trait_env"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># rownames are carried forward in results</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">dune_trait_env</span><span class="op">$</span><span class="va">comm</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">dune_trait_env</span><span class="op">$</span><span class="va">comm</span><span class="op">$</span><span class="va">Sites</span></span></span>
<span class="r-in"><span><span class="va">response</span> <span class="op">&lt;-</span> <span class="va">dune_trait_env</span><span class="op">$</span><span class="va">comm</span><span class="op">[</span>, <span class="op">-</span><span class="fl">1</span><span class="op">]</span>  <span class="co"># must delete "Sites"</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">w</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">20</span><span class="op">)</span> </span></span>
<span class="r-in"><span><span class="va">w</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">8</span> </span></span>
<span class="r-in"><span><span class="va">w</span><span class="op">[</span><span class="fl">17</span><span class="op">:</span><span class="fl">20</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">0.5</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">object</span> <span class="op">&lt;-</span> <span class="fu"><a href="wrda.html">wrda</a></span><span class="op">(</span>formula <span class="op">=</span> <span class="op">~</span> <span class="va">A1</span> <span class="op">+</span> <span class="va">Moist</span> <span class="op">+</span> <span class="va">Mag</span> <span class="op">+</span> <span class="va">Use</span> <span class="op">+</span> <span class="fu">Condition</span><span class="op">(</span><span class="va">Manure</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>               response <span class="op">=</span> <span class="va">response</span>, </span></span>
<span class="r-in"><span>               data <span class="op">=</span> <span class="va">dune_trait_env</span><span class="op">$</span><span class="va">envir</span>, </span></span>
<span class="r-in"><span>               weights <span class="op">=</span> <span class="va">w</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">object</span> <span class="co"># Proportions equal to those Canoco 5.15</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Call: wrda(formula = ~A1 + Moist + Mag + Use + Condition(Manure), response</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> = response, data = dune_trait_env$envir, weights = w)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -- Model Summary --</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>               Inertia Proportion Rank</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Total         65.7007     1.0000     </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Conditional    7.3839     0.1124    2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Constrained   36.4952     0.5555    6</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Unconstrained 21.8217     0.3321    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Inertia is</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -- Note --</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> The model is overfitted with no unconstrained (residual) component.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -- Eigenvalues --</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Eigenvalues for constrained axes:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  wRDA1  wRDA2  wRDA3  wRDA4  wRDA5  wRDA6 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 18.133  8.233  4.047  3.155  2.238  0.689 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> mean, sd, VIF and canonical coefficients with their optimistic [!] t-values:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           Avg    SDS     VIF   Regr1   tval1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Manure 2.4659 1.2056 10.5656 -0.2010 -0.1344</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> A1     4.1466 1.3786  1.4841  0.1013  0.1807</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Moist  2.1761 1.4762  1.4883 -4.1077 -7.3195</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> MagBF  0.1932 0.3948  6.8216  0.7873  0.6553</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> MagHF  0.4545 0.4979  5.8054  1.8392  1.6594</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> MagNM  0.0455 0.2083  4.8878  0.1327  0.1304</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Use    1.9205 0.7107  2.6787  0.2101  0.2791</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">mod_scores</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/vegan/man/scores.html" class="external-link">scores</a></span><span class="op">(</span><span class="va">object</span>, display <span class="op">=</span> <span class="st">"all"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/pkg/vegan/man/scores.html" class="external-link">scores</a></span><span class="op">(</span><span class="va">object</span>, which_cor <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"A1"</span>, <span class="st">"X_lot"</span><span class="op">)</span>, display <span class="op">=</span> <span class="st">"cor"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            wRDA1      wRDA2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> A1    -0.2365172 -0.3510007</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> X_lot -0.4987793  0.4250562</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"meaning")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "inter set correlation, correlation between environmental variables and the sites scores (CWMs)"</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/stats/anova.html" class="external-link">anova</a></span><span class="op">(</span><span class="va">object</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $table</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Permutation test for weighted reduncancy analysis</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Model: wrda(formula = ~A1 + Moist + Mag + Use + Condition(Manure), response = response, data = dune_trait_env$envir, weights = w) </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Residualized predictor permutation</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Residualized predictor permutation</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Permutation: free</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Number of permutations: 999</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          df Variance      R2      F Pr(&gt;F)  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> wRDA      6   36.495 0.62581 3.3449  0.012 *</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Residual 12   21.822                        </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ---</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $eigenvalues</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      wRDA1      wRDA2      wRDA3      wRDA4      wRDA5      wRDA6 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 18.1328543  8.2332883  4.0467247  3.1546579  2.2383295  0.6893052 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Cajo J.F ter Braak, Bart-Jan van Rossum.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer></div>





  </body></html>

