<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Performs (weighted) double constrained correspondence analysis (dc-CA) — dc_CA • douconca</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Performs (weighted) double constrained correspondence analysis (dc-CA) — dc_CA"><meta name="description" content="Double constrained correspondence analysis (dc-CA) for analyzing
(multi-)trait (multi-)environment ecological data using library vegan
and native R code. It has a formula interface which allows to assess,
for example, the importance of trait interactions in shaping ecological
communities. The function dc_CA has an option to divide the abundance
data of a site by the site total, giving equal site weights. This division
has the advantage that the multivariate analysis corresponds with an
unweighted (multi-trait) community-level analysis, instead of being weighted
(Kleyer et al. 2012)."><meta property="og:description" content="Double constrained correspondence analysis (dc-CA) for analyzing
(multi-)trait (multi-)environment ecological data using library vegan
and native R code. It has a formula interface which allows to assess,
for example, the importance of trait interactions in shaping ecological
communities. The function dc_CA has an option to divide the abundance
data of a site by the site total, giving equal site weights. This division
has the advantage that the multivariate analysis corresponds with an
unweighted (multi-trait) community-level analysis, instead of being weighted
(Kleyer et al. 2012)."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">douconca</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.2.1</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/douconca.html">Get started</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/Biometris/douconca/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Performs (weighted) double constrained correspondence analysis (dc-CA)</h1>
      <small class="dont-index">Source: <a href="https://github.com/Biometris/douconca/blob/main/R/dc_CA.R" class="external-link"><code>R/dc_CA.R</code></a></small>
      <div class="d-none name"><code>dc_CA.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Double constrained correspondence analysis (dc-CA) for analyzing
(multi-)trait (multi-)environment ecological data using library <code>vegan</code>
and native R code. It has a <code>formula</code> interface which allows to assess,
for example, the importance of trait interactions in shaping ecological
communities. The function <code>dc_CA</code> has an option to divide the abundance
data of a site by the site total, giving equal site weights. This division
has the advantage that the multivariate analysis corresponds with an
unweighted (multi-trait) community-level analysis, instead of being weighted
(Kleyer et al. 2012).</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">dc_CA</span><span class="op">(</span></span>
<span>  formulaEnv <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  formulaTraits <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  response <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  dataEnv <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  dataTraits <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  divideBySiteTotals <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  dc_CA_object <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-formulaenv">formulaEnv<a class="anchor" aria-label="anchor" href="#arg-formulaenv"></a></dt>
<dd><p>formula or one-sided formula for the rows (samples) with
row predictors in <code>dataEnv</code>. When two-sided, the left hand side of
the formula is not used. Specify row covariates (if any ) by
adding <code>+ Condition(covariate-formula)</code> to <code>formulaEnv</code> as
in <code><a href="https://rdrr.io/pkg/vegan/man/cca.html" class="external-link">rda</a></code>. The <code>covariate-formula</code> should not contain
a <code>~</code> (tilde). Default: <code>NULL</code> for <code>~.</code>, i.e. all variables
in <code>dataEnv</code> are predictor variables.</p></dd>


<dt id="arg-formulatraits">formulaTraits<a class="anchor" aria-label="anchor" href="#arg-formulatraits"></a></dt>
<dd><p>formula or one-sided formula for the columns (species)
with column predictors in <code>dataTraits</code>. When two-sided, the left hand
side of the formula is not used. Specify column covariates (if any ) by
adding <code>+ Condition(covariate-formula)</code> to <code>formulaTraits</code> as
in <code><a href="https://rdrr.io/pkg/vegan/man/cca.html" class="external-link">cca</a></code>. The <code>covariate-formula</code> should not contain
a <code>~</code> (tilde). Default: <code>NULL</code> for <code>~.</code>, i.e. all variables
in <code>dataTraits</code> are predictor traits.</p></dd>


<dt id="arg-response">response<a class="anchor" aria-label="anchor" href="#arg-response"></a></dt>
<dd><p>matrix, data frame of the abundance data
(dimension <em>n</em> x <em>m</em>) or list with community weighted means (CWMs)
from <code><a href="fCWM_SNC.html">fCWM_SNC</a></code>. See Details for analyses starting from community
weighted means. Rownames of <code>response</code>, if any, are carried through.</p></dd>


<dt id="arg-dataenv">dataEnv<a class="anchor" aria-label="anchor" href="#arg-dataenv"></a></dt>
<dd><p>matrix or data frame of the row predictors, with rows
corresponding to those in <code>response</code>. (dimension <em>n</em> x <em>p</em>).</p></dd>


<dt id="arg-datatraits">dataTraits<a class="anchor" aria-label="anchor" href="#arg-datatraits"></a></dt>
<dd><p>matrix or data frame of the column predictors, with rows
corresponding to the columns in <code>response</code>.
(dimension <em>m</em> x <em>q</em>).</p></dd>


<dt id="arg-dividebysitetotals">divideBySiteTotals<a class="anchor" aria-label="anchor" href="#arg-dividebysitetotals"></a></dt>
<dd><p>logical; default <code>TRUE</code> for closing the
data by dividing the rows in the <code>response</code> by their total.</p></dd>


<dt id="arg-dc-ca-object">dc_CA_object<a class="anchor" aria-label="anchor" href="#arg-dc-ca-object"></a></dt>
<dd><p>optional object from an earlier run of this function.
Useful if the same formula for the columns (<code>formulaTraits</code>),
<code>dataTraits</code> and <code>response</code> are used with a new formula for the
rows. If set, the data of the previous run is used and the result of its
first step is taken for the new analysis.</p></dd>


<dt id="arg-verbose">verbose<a class="anchor" aria-label="anchor" href="#arg-verbose"></a></dt>
<dd><p>logical for printing a simple summary (default: TRUE)</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A list of <code>class</code> <code>dcca</code>; that is a list with elements</p><dl><dt>CCAonTraits</dt>
<dd><p>a <code><a href="https://rdrr.io/pkg/vegan/man/cca.object.html" class="external-link">cca.object</a></code> from the
<code><a href="https://rdrr.io/pkg/vegan/man/cca.html" class="external-link">cca</a></code> analysis of the transpose of the closed
<code>response</code> using formula <code>formulaTraits</code>.</p></dd>

<dt>formulaTraits</dt>
<dd><p>the argument <code>formulaTraits</code>. If the formula was
<code>~.</code>, it was changed to explicit trait names.</p></dd>

<dt>data</dt>
<dd><p>a list of <code>Y</code>, <code>dataEnv</code> and <code>dataTraits</code>,
after removing empty rows and columns in <code>response</code> and after closure if
<code>divideBySiteTotals = TRUE</code> and with the corresponding rows in
<code>dataEnv</code> and <code>dataTraits</code> removed.</p></dd>

<dt>weights</dt>
<dd><p>a list of unit-sum weights of row and columns. The names of
the list are <code>c("row", "columns")</code>, in that order.</p></dd>

<dt>Nobs</dt>
<dd><p>number of sites (rows).</p></dd>

<dt>CWMs_orthonormal_traits</dt>
<dd><p>Community weighted means w.r.t.
orthonormalized traits.</p></dd>

<dt>RDAonEnv</dt>
<dd><p>a <code><a href="wrda.html">wrda</a></code> object or
<code><a href="https://rdrr.io/pkg/vegan/man/cca.object.html" class="external-link">cca.object</a></code> from the
<code><a href="wrda.html">wrda</a></code> or, if with equal row weights,
<code><a href="https://rdrr.io/pkg/vegan/man/cca.html" class="external-link">rda</a></code> analysis, respectively of the column scores of the
<code>cca</code>, which are the CWMs of orthonormalized traits, using formula
<code>formulaEnv</code>.</p></dd>

<dt>formulaEnv</dt>
<dd><p>the argument <code>formulaEnv</code>. If the formula was
<code>~.</code>, it was changed to explicit environmental variable names.</p></dd>

<dt>eigenvalues</dt>
<dd><p>the dc-CA eigenvalues (same as those of the
<code><a href="https://rdrr.io/pkg/vegan/man/cca.html" class="external-link">rda</a></code> analysis).</p></dd>

<dt>c_traits_normed0</dt>
<dd><p>mean, sd, VIF and (regression) coefficients of
the traits that define the dc-CA axes in terms of the
traits with t-ratios missing indicated by <code>NA</code>s for 'tval1'.</p></dd>

<dt>inertia</dt>
<dd><p>a one-column matrix with four inertias (weighted variances):</p><ul><li><p>total: the total inertia.</p></li>
<li><p>conditionT: the inertia explained by the condition in
<code>formulaTraits</code> if present (neglecting row constraints).</p></li>
<li><p>traits_explain: the inertia explained by the traits (neglecting the
row predictors and any condition in <code>formulaTraits</code>). This is the
maximum that the row predictors could explain in dc-CA (the sum of the
following two items is thus less than this value).</p></li>
<li><p>conditionE: the trait-constrained inertia explained by the condition
in <code>formulaEnv</code>.</p></li>
<li><p>constraintsTE: the trait-constrained inertia explained by the
predictors (without the row covariates).</p></li>
</ul></dd>


</dl><p>If <code>verbose</code> is <code>TRUE</code> (or after <code>out &lt;- print(out)</code> is
invoked) there are three more items.</p><ul><li><p><code>c_traits_normed</code>: mean, sd, VIF and (regression) coefficients of
the traits that define the dc-CA trait axes (composite traits), and their
optimistic t-ratio.</p></li>
<li><p><code>c_env_normed</code>: mean, sd, VIF and (regression) coefficients of
the environmental variables that define the dc-CA axes in terms of the
environmental variables (composite gradients), and their optimistic t-ratio.</p></li>
<li><p><code>species_axes</code>: a list with four items</p><ul><li><p><code>species_scores</code>: a list with names
  <code>c("species_scores_unconstrained", "lc_traits_scores")</code> with the
  matrix with species niche centroids along the dc-CA axes (composite
  gradients) and the matrix with linear combinations of traits.</p></li>
<li><p><code>correlation</code>: a matrix with inter-set correlations of the
  traits with their SNCs.</p></li>
<li><p><code>b_se</code>: a matrix with (unstandardized) regression coefficients
  for traits and their optimistic standard errors.</p></li>
<li><p><code>R2_traits</code>: a vector with coefficient of determination (R2)
  of the SNCs on to the traits. The square-root thereof could be called
  the species-trait correlation in analogy with the species-environment
  correlation in CCA.</p></li>
</ul></li>
<li><p><code>sites_axes</code>: a list with four items</p><ul><li><p><code>site_scores</code>: a list with names
   <code>c("site_scores_unconstrained", "lc_env_scores")</code> with the matrix
   with community weighted means (CWMs) along the dc-CA axes (composite
   gradients) and the matrix with linear combinations of environmental
   variables.</p></li>
<li><p><code>correlation</code>: a matrix with inter-set correlations of the
   environmental variables with their CWMs.</p></li>
<li><p><code>b_se</code>: a matrix with (unstandardized) regression coefficients
   for environmental variables and their optimistic standard errors.</p></li>
<li><p><code>R2_env</code>: a vector with coefficient of determination (R2) of
   the CWMs on to the environmental variables. The square-root thereof
   has been called the species-environmental correlation in CCA.</p></li>
</ul></li>
</ul><p>All scores in the <code>dcca</code> object are in scaling <code>"sites"</code> (1):
the scaling with <em>Focus on Case distances</em> .</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>Empty (all zero) rows and columns in <code>response</code> are removed from the
<code>response</code> and the corresponding rows from <code>dataEnv</code> and
<code>dataTraits</code>. Subsequently, any columns with missing values are
removed from  <code>dataEnv</code> and <code>dataTraits</code>. It gives an error
('name_of_variable' not found), if variables with missing entries are
specified in <code>formulaEnv</code> and <code>formulaTraits</code>.</p>
<p>Computationally, dc-CA can be carried out by a single singular value
decomposition (ter Braak et al. 2018), but it is here computed in two steps.
In the first step, the transpose of the <code>response</code> is regressed on to
the traits (the column predictors) using <code><a href="https://rdrr.io/pkg/vegan/man/cca.html" class="external-link">cca</a></code> with
<code>formulaTraits</code>. The column scores of this analysis (in scaling 1) are
community weighted means (CWM) of the orthonormalized traits. These are then
regressed on the environmental (row) predictors using <code><a href="wrda.html">wrda</a></code>
with <code>formulaEnv</code> or using <code><a href="https://rdrr.io/pkg/vegan/man/cca.html" class="external-link">rda</a></code>, if site weights
are equal.</p>
<p>A dc-CA can be carried out on, what statisticians call, the sufficient
statistics of the method. This is useful, when the abundance data are not
available or could not be made public in a paper attempting reproducible
research. In this case, <code>response</code> should be a list
with as first element community weighted means (CWMs) with respect to the
traits, and the trait data, and, optionally, further elements, for functions
related to <code>dc_CA</code>. The minimum is a
<code>list(CWM, weight = list(columns = species_weights))</code> with CWM a matrix
or data.frame, but then <code>formulaEnv</code>, <code>formulaTraits</code>,
<code>dataEnv</code>, <code>dataTraits</code> must be specified in the call to
<code>dc_CA</code>. The function <code><a href="fCWM_SNC.html">fCWM_SNC</a></code> and its example
show how to set the
<code>response</code> for this and helps to create the <code>response</code> from
abundance data in these non-standard applications of dc-CA. Species and site
weights, if not set in <code>response$weights</code> can be set by a variable
<code>weight</code> in the data frames <code>dataTraits</code> and <code>dataEnv</code>,
respectively, but formulas should then not be <code>~.</code>.</p>
<p>The statistics and scores in the example <code>dune_dcCA.r</code>, have been
checked against the results in Canoco 5.15 (ter Braak &amp; Šmilauer, 2018).</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Kleyer, M., Dray, S., Bello, F., Lepš, J., Pakeman, R.J., Strauss, B., Thuiller,
W. &amp; Lavorel, S. (2012) Assessing species and community functional responses to
environmental gradients: which multivariate methods?
Journal of Vegetation Science, 23, 805-821.
<a href="https://doi.org/10.1111/j.1654-1103.2012.01402.x" class="external-link">doi:10.1111/j.1654-1103.2012.01402.x</a></p>
<p>ter Braak, CJF, Šmilauer P, and Dray S. 2018. Algorithms and biplots for
double constrained correspondence analysis.
Environmental and Ecological Statistics, 25(2), 171-197.
<a href="https://doi.org/10.1007/s10651-017-0395-x" class="external-link">doi:10.1007/s10651-017-0395-x</a></p>
<p>ter Braak C.J.F. and  P. Šmilauer  (2018). Canoco reference manual
and user's guide: software for ordination (version 5.1x).
Microcomputer Power, Ithaca, USA, 536 pp.</p>
<p>Oksanen, J., et al. (2024)
vegan: Community Ecology Package. R package version 2.6-6.1.
<a href="https://CRAN.R-project.org/package=vegan" class="external-link">https://CRAN.R-project.org/package=vegan</a>.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="plot.dcca.html">plot.dcca</a></code>, <code><a href="scores.dcca.html">scores.dcca</a></code>,
<code><a href="print.dcca.html">print.dcca</a></code> and <code><a href="anova.dcca.html">anova.dcca</a></code></p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"dune_trait_env"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># rownames are carried forward in results</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">dune_trait_env</span><span class="op">$</span><span class="va">comm</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">dune_trait_env</span><span class="op">$</span><span class="va">comm</span><span class="op">$</span><span class="va">Sites</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">mod</span> <span class="op">&lt;-</span> <span class="fu">dc_CA</span><span class="op">(</span>formulaEnv <span class="op">=</span> <span class="op">~</span><span class="va">A1</span> <span class="op">+</span> <span class="va">Moist</span> <span class="op">+</span> <span class="va">Mag</span> <span class="op">+</span> <span class="va">Use</span> <span class="op">+</span> <span class="va">Manure</span>,</span></span>
<span class="r-in"><span>             formulaTraits <span class="op">=</span> <span class="op">~</span> <span class="va">SLA</span> <span class="op">+</span> <span class="va">Height</span> <span class="op">+</span> <span class="va">LDMC</span> <span class="op">+</span> <span class="va">Seedmass</span> <span class="op">+</span> <span class="va">Lifespan</span>,</span></span>
<span class="r-in"><span>             response <span class="op">=</span> <span class="va">dune_trait_env</span><span class="op">$</span><span class="va">comm</span><span class="op">[</span>, <span class="op">-</span><span class="fl">1</span><span class="op">]</span>,  <span class="co"># must delete "Sites"</span></span></span>
<span class="r-in"><span>             dataEnv <span class="op">=</span> <span class="va">dune_trait_env</span><span class="op">$</span><span class="va">envir</span>,</span></span>
<span class="r-in"><span>             dataTraits <span class="op">=</span> <span class="va">dune_trait_env</span><span class="op">$</span><span class="va">traits</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Step 1: the CCA ordination of the transposed matrix with trait constraints,</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         useful in itself and also yielding CWMs of the orthonormalized traits for step 2.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Call: cca(formula = tY ~ SLA + Height + LDMC + Seedmass + Lifespan, data =</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> dataTraits)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -- Model Summary --</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>               Inertia Proportion Rank</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Total          2.3490     1.0000     </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Constrained    0.6776     0.2885    5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Unconstrained  1.6714     0.7115   19</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Inertia is scaled Chi-square</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -- Eigenvalues --</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Eigenvalues for constrained axes:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    CCA1    CCA2    CCA3    CCA4    CCA5 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.26839 0.19597 0.12356 0.07003 0.01967 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Eigenvalues for unconstrained axes:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    CA1    CA2    CA3    CA4    CA5    CA6    CA7    CA8 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.4386 0.2396 0.1938 0.1750 0.1429 0.1112 0.0854 0.0601 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> (Showing 8 of 19 unconstrained eigenvalues)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Step 2: the RDA ordination of CWMs of the orthonormalized traits </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         of step 1 with environmental constraints:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Call: rda(formula = out1$CWMs_orthonormal_traits ~ A1 + Moist + Mag + Use +</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Manure, data = out1$data$dataEnv)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -- Model Summary --</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>               Inertia Proportion Rank</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Total          0.6776     1.0000     </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Constrained    0.4454     0.6573    5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Unconstrained  0.2322     0.3427    5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Inertia is variance</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -- Eigenvalues --</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Eigenvalues for constrained axes:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    RDA1    RDA2    RDA3    RDA4    RDA5 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.23680 0.10903 0.05934 0.03792 0.00233 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Eigenvalues for unconstrained axes:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     PC1     PC2     PC3     PC4     PC5 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.12017 0.05836 0.03455 0.01337 0.00575 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> mean, sd, VIF and canonical coefficients with their optimistic [!] t-values:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         Avg    SDS    VIF   Regr1   tval1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> A1     4.85 9.4989 1.6967 -0.0605 -0.9172</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Moist  2.90 7.8613 1.7658  0.3250  4.8293</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> MagBF  0.15 1.5969 4.5016 -0.0475 -0.4421</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> MagHF  0.25 1.9365 2.6715 -0.0156 -0.1890</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> MagNM  0.30 2.0494 9.5666  0.1622  1.0352</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Use    1.90 3.4351 1.7825  0.0219  0.3239</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Manure 1.75 6.4614 9.3847 -0.1444 -0.9306</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                        Avg     SDS    VIF   Regr1   tval1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> SLA                24.6468  6.3438 1.1888 -0.8196 -3.6933</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Height             25.1272 15.6848 1.3033 -0.1598 -0.6877</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> LDMC              244.5084 70.9729 1.1791 -0.0562 -0.2542</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Seedmass            0.6543  0.6688 1.0784 -0.7586 -3.5896</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Lifespanperennial   0.9607  0.1944 1.0964  0.1006  0.4722</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                weighted variance</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> total                      2.349</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> traits_explain             0.678</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> constraintsTE              0.445</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"meaning")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                meaning                                                              </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> total          "total inertia"                                                      </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> traits_explain "trait-constrained inertia"                                          </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> constraintsTE  "trait-constrained inertia explained by the predictors in formulaEnv"</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/stats/anova.html" class="external-link">anova</a></span><span class="op">(</span><span class="va">mod</span>, by <span class="op">=</span> <span class="st">"axis"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $species</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Species-level permutation test using dc-CA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Model: dc_CA(formulaEnv = ~A1 + Moist + Mag + Use + Manure, formulaTraits = ~SLA + Height + LDMC + Seedmass + Lifespan, response = dune_trait_env$comm[, -1], dataEnv = dune_trait_env$envir, dataTraits = dune_trait_env$traits) </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Residualized predictor permutation</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          df ChiSquare       R2      F Pr(&gt;F)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> dcCA1     1   0.23680 0.179002 5.9370  0.106</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> dcCA2     1   0.10903 0.082419 2.7336  0.501</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> dcCA3     1   0.05934 0.044853 1.4877  0.742</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> dcCA4     1   0.03792 0.028663 0.9507  0.806</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> dcCA5     1   0.00233 0.001760 0.0584  1.000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Residual 22   0.87749                       </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $sites</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          Df ChiSquare      R2       F Pr(&gt;F)    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> dcCA1     1  0.236804 0.34946 14.2776  0.001 ***</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> dcCA2     1  0.109032 0.16090  6.5739  0.096 .  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> dcCA3     1  0.059336 0.08757  3.5776  0.410    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> dcCA4     1  0.037919 0.05596  2.2863  0.654    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> dcCA5     1  0.002329 0.00344  0.1404  1.000    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Residual 14  0.232199                           </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ---</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $max</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Max test combining the community- and species- level tests </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Model: dc_CA(formulaEnv = ~A1 + Moist + Mag + Use + Manure, formulaTraits = ~SLA + Height + LDMC + Seedmass + Lifespan, response = dune_trait_env$comm[, -1], dataEnv = dune_trait_env$envir, dataTraits = dune_trait_env$traits) </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Taken from the species-level test:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Residualized predictor permutation</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Permutation: free</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Number of permutations: 999</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          df ChiSquare       R2      F Pr(&gt;F)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> dcCA1     1   0.23680 0.179002 5.9370  0.106</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> dcCA2     1   0.10903 0.082419 2.7336  0.501</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> dcCA3     1   0.05934 0.044853 1.4877  0.742</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> dcCA4     1   0.03792 0.028663 0.9507  0.806</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> dcCA5     1   0.00233 0.001760 0.0584  1.000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Residual 22   0.87749                       </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span><span class="co"># For more demo on testing, see demo dune_test.r</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">mod_scores</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/vegan/man/scores.html" class="external-link">scores</a></span><span class="op">(</span><span class="va">mod</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># correlation of axes with a variable that is not in the model</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/pkg/vegan/man/scores.html" class="external-link">scores</a></span><span class="op">(</span><span class="va">mod</span>, display <span class="op">=</span> <span class="st">"cor"</span>, scaling <span class="op">=</span> <span class="st">"sym"</span>, which_cor <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="cn">NULL</span>, <span class="st">"X_lot"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         CWM-ax1    CWM-ax2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> X_lot 0.1425494 0.06695038</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"meaning")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "inter set correlation, correlation between environmental variables and the sites scores (CWMs)"</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"head of unconstrained site scores, with meaning\n"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> head of unconstrained site scores, with meaning</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">mod_scores</span><span class="op">$</span><span class="va">sites</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        dcCA1       dcCA2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 -1.2640026  0.19395232</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2 -0.7328822 -0.24929614</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3 -0.8250139 -0.44760064</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4 -0.4453407 -0.33741144</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5 -0.5783587  0.01524487</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6 -0.5722181  0.24340264</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">mod_scores_tidy</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/vegan/man/scores.html" class="external-link">scores</a></span><span class="op">(</span><span class="va">mod</span>, tidy <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="st">"names of the tidy scores"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "names of the tidy scores"</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">mod_scores_tidy</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "dcCA1"  "dcCA2"  "score"  "label"  "weight"</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"\nThe levels of the tidy scores\n"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> The levels of the tidy scores</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/levels.html" class="external-link">levels</a></span><span class="op">(</span><span class="va">mod_scores_tidy</span><span class="op">$</span><span class="va">score</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [1] "biplot"                       "biplot_traits"               </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [3] "centroids"                    "centroids_traits"            </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [5] "constraints_sites"            "constraints_species"         </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [7] "correlation"                  "correlation_traits"          </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [9] "factorbiplot"                 "factorbiplot_traits"         </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [11] "intra_set_correlation"        "intra_set_correlation_traits"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [13] "regression"                   "regression_traits"           </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [15] "sites"                        "species"                     </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [17] "t_values"                     "t_values_traits"             </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"\nFor illustration: a dc-CA model with a trait covariate\n"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> For illustration: a dc-CA model with a trait covariate</span>
<span class="r-in"><span><span class="va">mod2</span> <span class="op">&lt;-</span> <span class="fu">dc_CA</span><span class="op">(</span>formulaEnv <span class="op">=</span> <span class="op">~</span> <span class="va">A1</span> <span class="op">+</span> <span class="va">Moist</span> <span class="op">+</span> <span class="va">Mag</span> <span class="op">+</span> <span class="va">Use</span> <span class="op">+</span> <span class="va">Manure</span>,</span></span>
<span class="r-in"><span>              formulaTraits <span class="op">=</span> <span class="op">~</span> <span class="va">SLA</span> <span class="op">+</span> <span class="va">Height</span> <span class="op">+</span> <span class="va">LDMC</span> <span class="op">+</span> <span class="va">Lifespan</span> <span class="op">+</span> <span class="fu">Condition</span><span class="op">(</span><span class="va">Seedmass</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>              response <span class="op">=</span> <span class="va">dune_trait_env</span><span class="op">$</span><span class="va">comm</span><span class="op">[</span>, <span class="op">-</span><span class="fl">1</span><span class="op">]</span>,  <span class="co"># must delete "Sites"</span></span></span>
<span class="r-in"><span>              dataEnv <span class="op">=</span> <span class="va">dune_trait_env</span><span class="op">$</span><span class="va">envir</span>,</span></span>
<span class="r-in"><span>              dataTraits <span class="op">=</span> <span class="va">dune_trait_env</span><span class="op">$</span><span class="va">traits</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Step 1: the CCA ordination of the transposed matrix with trait constraints,</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         useful in itself and also yielding CWMs of the orthonormalized traits for step 2.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Call: cca(formula = tY ~ SLA + Height + LDMC + Lifespan +</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Condition(Seedmass), data = dataTraits)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -- Model Summary --</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>               Inertia Proportion Rank</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Total         2.34899    1.00000     </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Conditional   0.16671    0.07097    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Constrained   0.51091    0.21750    4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Unconstrained 1.67137    0.71153   19</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Inertia is scaled Chi-square</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -- Eigenvalues --</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Eigenvalues for constrained axes:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    CCA1    CCA2    CCA3    CCA4 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.21499 0.18622 0.07354 0.03616 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Eigenvalues for unconstrained axes:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    CA1    CA2    CA3    CA4    CA5    CA6    CA7    CA8 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.4386 0.2396 0.1938 0.1750 0.1429 0.1112 0.0854 0.0601 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> (Showing 8 of 19 unconstrained eigenvalues)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Step 2: the RDA ordination of CWMs of the orthonormalized traits </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         of step 1 with environmental constraints:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Call: rda(formula = out1$CWMs_orthonormal_traits ~ A1 + Moist + Mag + Use +</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Manure, data = out1$data$dataEnv)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -- Model Summary --</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>               Inertia Proportion Rank</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Total          0.5109     1.0000     </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Constrained    0.3171     0.6207    4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Unconstrained  0.1938     0.3793    4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Inertia is variance</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -- Eigenvalues --</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Eigenvalues for constrained axes:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    RDA1    RDA2    RDA3    RDA4 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.16632 0.08100 0.04766 0.02215 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Eigenvalues for unconstrained axes:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     PC1     PC2     PC3     PC4 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.11386 0.04942 0.01888 0.01162 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> mean, sd, VIF and canonical coefficients with their optimistic [!] t-values:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         Avg    SDS    VIF   Regr1   tval1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> A1     4.85 9.4989 1.6967 -0.0920 -1.1424</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Moist  2.90 7.8613 1.7658  0.1002  1.2204</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> MagBF  0.15 1.5969 4.5016  0.0125  0.0951</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> MagHF  0.25 1.9365 2.6715  0.0405  0.4006</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> MagNM  0.30 2.0494 9.5666  0.3052  1.5969</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Use    1.90 3.4351 1.7825  0.0927  1.1234</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Manure 1.75 6.4614 9.3847 -0.1567 -0.8277</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                        Avg     SDS    VIF   Regr1   tval1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Seedmass            0.6543  0.6688 1.0784 -0.0929 -0.3874</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> SLA                24.6468  6.3438 1.1888 -1.0644 -4.2276</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Height             25.1272 15.6848 1.3033 -0.5285 -2.0049</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> LDMC              244.5084 70.9729 1.1791  0.0433  0.1728</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Lifespanperennial   0.9607  0.1944 1.0964  0.1744  0.7211</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                weighted variance</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> total                      2.349</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> conditionT                 0.167</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> traits_explain             0.511</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> constraintsTE              0.317</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"meaning")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                meaning                                                              </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> total          "total inertia"                                                      </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> conditionT     "inertia of the trait condition"                                     </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> traits_explain "trait-constrained inertia"                                          </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> constraintsTE  "trait-constrained inertia explained by the predictors in formulaEnv"</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"\nFor illustration: a dc-CA model with both environmental and trait covariates\n"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> For illustration: a dc-CA model with both environmental and trait covariates</span>
<span class="r-in"><span><span class="va">mod3</span> <span class="op">&lt;-</span> <span class="fu">dc_CA</span><span class="op">(</span>formulaEnv <span class="op">=</span> <span class="op">~</span><span class="va">A1</span> <span class="op">+</span> <span class="va">Moist</span> <span class="op">+</span> <span class="va">Use</span> <span class="op">+</span> <span class="va">Manure</span> <span class="op">+</span> <span class="fu">Condition</span><span class="op">(</span><span class="va">Mag</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>              formulaTraits <span class="op">=</span> <span class="op">~</span> <span class="va">SLA</span> <span class="op">+</span> <span class="va">Height</span> <span class="op">+</span> <span class="va">LDMC</span> <span class="op">+</span> <span class="va">Lifespan</span> <span class="op">+</span> <span class="fu">Condition</span><span class="op">(</span><span class="va">Seedmass</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>              response <span class="op">=</span> <span class="va">dune_trait_env</span><span class="op">$</span><span class="va">comm</span><span class="op">[</span>, <span class="op">-</span><span class="fl">1</span><span class="op">]</span>,  <span class="co"># must delete "Sites"</span></span></span>
<span class="r-in"><span>              dataEnv <span class="op">=</span> <span class="va">dune_trait_env</span><span class="op">$</span><span class="va">envir</span>,</span></span>
<span class="r-in"><span>              dataTraits <span class="op">=</span> <span class="va">dune_trait_env</span><span class="op">$</span><span class="va">traits</span>, verbose <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"\nFor illustration: same model but using dc_CA_object = mod2 for speed, "</span>, </span></span>
<span class="r-in"><span>    <span class="st">"as the trait model and data did not change\n"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> For illustration: same model but using dc_CA_object = mod2 for speed,  as the trait model and data did not change</span>
<span class="r-in"><span><span class="va">mod3B</span> <span class="op">&lt;-</span> <span class="fu">dc_CA</span><span class="op">(</span>formulaEnv <span class="op">=</span> <span class="op">~</span><span class="va">A1</span> <span class="op">+</span> <span class="va">Moist</span> <span class="op">+</span> <span class="va">Use</span> <span class="op">+</span> <span class="va">Manure</span> <span class="op">+</span> <span class="fu">Condition</span><span class="op">(</span><span class="va">Mag</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>               dataEnv <span class="op">=</span> <span class="va">dune_trait_env</span><span class="op">$</span><span class="va">envir</span>,</span></span>
<span class="r-in"><span>               dc_CA_object <span class="op">=</span> <span class="va">mod2</span>, verbose<span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"\ncheck on equality of mod3 (from data) and mod3B (from a dc_CA_object)\n"</span>,</span></span>
<span class="r-in"><span>    <span class="st">"the expected difference is in the component 'call'\n "</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> check on equality of mod3 (from data) and mod3B (from a dc_CA_object)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  the expected difference is in the component 'call'</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  </span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/all.equal.html" class="external-link">all.equal</a></span><span class="op">(</span><span class="va">mod3</span>, <span class="va">mod3B</span><span class="op">)</span><span class="op">)</span> <span class="co">#  only the component call differs</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "Component “call”: target, current do not match when deparsed"</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Cajo J.F ter Braak, Bart-Jan van Rossum.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer></div>





  </body></html>

